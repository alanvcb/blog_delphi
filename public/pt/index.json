[{"content":"L√° por 2018, no Delphi 10.3 Rio, os engenheiros da Embarcadero resolveram ‚Äúmodernizar‚Äù o neg√≥cio e inventaram as vari√°veis inline.\nA ideia parece genial: declarar a vari√°vel ali, no exato ponto onde vai usar.\nNo papel √© bonito. Na pr√°tica, √© tipo botar farol de LED num fusca ‚Äî chama aten√ß√£o, mas n√£o resolve o problema.\nNeste post, eu te explico o que s√£o essas benditas vari√°veis inline, quando elas at√© fazem sentido, e por que, na minha opini√£o, qualquer coisa fora de um for √© receita de bagun√ßa.\nO que √© vari√°vel inline Desde os prim√≥rdios do Pascal, l√° da √©poca que a gente ainda usava disquete e o compilador cabia num disquete e meio, toda vari√°vel local era declarada no topo do m√©todo, antes do begin.\nEsse era o padr√£o: bonito, previs√≠vel e l√≥gico.\nA√≠ veio o Delphi 10.3 Rio e resolveu permitir isso aqui:\nprocedure Test; begin var i: Integer := 10; ShowMessage(i.ToString); end; Parece pr√°tico, n√©? E √© mesmo‚Ä¶ at√© o momento em que o c√≥digo come√ßa a crescer.\nA√≠ voc√™ vai ca√ßar onde est√° a vari√°vel, e descobre que algu√©m teve a brilhante ideia de declarar um var no meio de um if, outro dentro de um try, e outro l√° no fim do begin.\nPronto, virou merda.\nOs pr√≥s (pra n√£o dizer que eu s√≥ reclamo) O escopo fica mais curto: terminou o bloco, a vari√°vel morre. D√° pra declarar no ponto de uso, beleza. O compilador infere o tipo, ent√£o o c√≥digo fica menor. Evita vari√°veis zumbis que seguem vivas sem necessidade. Ok, tem sua utilidade. Mas a turma come√ßou a achar que isso √© desculpa pra jogar var em qualquer canto do c√≥digo. Os contras (e aqui come√ßa a bronca) Coice do Bruto: Fora do for, vira bagun√ßa generalizada.\nVoc√™ abre um m√©todo e tem var em cada esquina.\nO padr√£o do Delphi sempre foi simples: quer saber as vari√°veis? sobe l√° pro topo, antes do begin.\nAgora tem que sair ca√ßando var no meio do inferno. √Äs vezes nem tipo tem: var x := AlgumaFuncao(); ‚Äî a√≠ voc√™ precisa abrir a fun√ß√£o pra saber o que √© x. Manuten√ß√£o? Virou ca√ßa ao tesouro. C√≥digo grande com inline √© tipo novela ruim: parece que vai melhorar, mas s√≥ piora. Resumo: quem quer economizar tr√™s teclas acaba gastando meia hora pra entender o que o pr√≥prio c√≥digo faz.\nOpini√£o do Bruto Vari√°vel inline s√≥ faz sentido em dois lugares:\nDentro de um for, tipo for var i := 0 to 10 do. Em blocos pequenos, de prefer√™ncia com menos de meia tela. Fora disso, √© firula.\nQuer declarar no meio do m√©todo? Faz um favor pra humanidade e vai vender pamonha.\nQuem for dar manuten√ß√£o vai te xingar em tr√™s l√≠nguas diferentes, e com raz√£o.\nCoice do Bruto: No meu c√≥digo, vari√°vel √© tudo antes do begin.\nSe voc√™ precisar achar uma, vai l√° e t√° tudo ali, arrumadinho.\nIsso √© padr√£o, √© clareza, √© paz de esp√≠rito. Exemplo bom (aceit√°vel) for var Item in Lista do begin var Dobrado := Item * 2; ShowMessage(Dobrado.ToString); end; Curto, direto, limpo. Morreu dentro do loop, n√£o incomoda ningu√©m.\nExemplo ruim (zona total) procedure Calcula; begin var Total := 0; if Condicao then begin var Aux := SomaFuncao(); Total := Total + Aux; end; var Outro := OutraFuncao(); ShowMessage(Total.ToString + Outro.ToString); end; Onde foi declarada ‚ÄúOutro‚Äù? Qual o tipo dela? O que ela come?\nPra descobrir, s√≥ debugando.\nE o coitado que abrir isso daqui seis meses vai querer pular da janela.\nExemplo da desgra√ßa suprema (mesmo nome, tipos diferentes) procedure Teste; begin var Valor: Integer := 10; ShowMessage(\u0026#39;Valor inteiro: \u0026#39; + Valor.ToString); begin var Valor: String := \u0026#39;dez\u0026#39;; ShowMessage(\u0026#39;Valor string: \u0026#39; + Valor); end; ShowMessage(\u0026#39;Valor ainda √© inteiro: \u0026#39; + Valor.ToString); end; Olha que maravilha: duas vari√°veis com o mesmo nome, tipos diferentes, vivas em blocos diferentes.\nCompila feliz, mas quem ler isso vai pensar que o compilador enlouqueceu.\nVoc√™ acha que √© um Integer, mas dentro de um bloco virou String.\nDepois volta a ser Integer.\nIsso n√£o √© clareza ‚Äî isso √© transtorno de identidade de vari√°vel.\nConclus√£o Coice do Bruto: Vari√°veis inline √© igual makita na m√£o de crian√ßa: pode at√© funcionar, mas voc√™ sabe que vai dar merda e alguem vai sair chorando (e quem sabe com um dedo a menos).\nUse no for, use em bloco pequeno, mas n√£o espalha var pelo c√≥digo que nem confete no carnaval.\nO padr√£o do Delphi √© simples, bonito e testado h√° d√©cadas:\nvar tudo antes do begin.\nFoge disso e o c√≥digo vira um bingo de escopo.\nE se eu abrir seu c√≥digo e encontrar vari√°vel inline espalhada, j√° aviso:\neu vou arrancar tudo e botar o var l√° em cima, onde sempre deveria estar.\nNa marra, se for preciso.\n","permalink":"http://localhost:1313/pt/posts/variaveis-inline-no-delphi/","summary":"\u003cp\u003eL√° por 2018, no \u003cstrong\u003eDelphi 10.3 Rio\u003c/strong\u003e, os engenheiros da Embarcadero resolveram ‚Äúmodernizar‚Äù o neg√≥cio e inventaram as \u003cstrong\u003evari√°veis inline\u003c/strong\u003e.\u003cbr\u003e\nA ideia parece genial: declarar a vari√°vel ali, no exato ponto onde vai usar.\u003cbr\u003e\nNo papel √© bonito. Na pr√°tica, √© tipo botar farol de LED num fusca ‚Äî chama aten√ß√£o, mas n√£o resolve o problema.\u003c/p\u003e\n\u003cp\u003eNeste post, eu te explico o que s√£o essas benditas vari√°veis inline, quando elas at√© fazem sentido, e por que, na minha opini√£o, \u003cstrong\u003equalquer coisa fora de um \u003ccode\u003efor\u003c/code\u003e √© receita de bagun√ßa.\u003c/strong\u003e\u003c/p\u003e","title":"Vari√°veis inline ‚Äì para√≠so ou zona?"},{"content":" WITH √© coisa de programador pregui√ßoso Coice do Bruto: ‚ö†Ô∏è Aviso de utilidade p√∫blica:\nEste texto √© opinativo, mal humorado e cheio de verdade.\nSe voc√™ ama o with e acha que ele √© lindo, j√° pode apertar Ctrl+W e fechar essa aba.\nEu n√£o vou dormir menos, n√£o vou comer menos e n√£o vou te mandar flores.\nAgora, se voc√™ quer entender de verdade por que esse treco √© uma desgra√ßa no Delphi ‚Äî senta a√≠ e presta aten√ß√£o.\nOu ent√£o, veja esse artigo em v√≠deo O que √© esse tal de with e por que o povo usa O with √© aquele ‚Äúatalho m√°gico‚Äù que promete te poupar meia d√∫zia de teclas.\nO sujeito olha praquilo e pensa:\n‚ÄúNossa, que lindo! N√£o preciso digitar Memo1.Lines toda hora!‚Äù\nPois √©‚Ä¶ e depois n√£o entende por que o c√≥digo dele parece uma merda.\nO with serve pra:\n‚ÄúEncurtar‚Äù chamadas (tipo Memo1.Lines.Add). Preencher cole√ß√µes (tipo ACBrNFe1.NotasFiscais.Add). E serve tamb√©m pra bagun√ßar seu c√≥digo, confundir o depurador e te fazer parecer um pregui√ßoso.\nBonito, n√©?\nProblema #1 ‚Äî O with fode a leitura do seu c√≥digo Sabe aquele c√≥digo bonito que voc√™ l√™ e entende de primeira?\nPois √©, o with pega esse c√≥digo, limpa a bunda com ele e joga no lixo.\nExemplo cl√°ssico de pregui√ßa: with Memo1.Lines do begin Clear; Add(\u0026#39;Cap√≠tulo 1: ...\u0026#39;); Add(\u0026#39;Par√°grafo 2: ...\u0026#39;); Add(\u0026#39;Par√°grafo 3: ...\u0026#39;); end; O sujeito que escreveu isso acha que economizou tempo.\nEconomizou nada, s√≥ fodeu quem vai dar manuten√ß√£o.\nCoice do Bruto: Aqui cada linha grita quem √© o dono da a√ß√£o.\nN√£o tem charada, n√£o tem adivinha√ß√£o.\nO c√≥digo √© honesto ‚Äî coisa rara hoje em dia. Memo1.Lines.Clear; Memo1.Lines.Add(\u0026#39;Cap√≠tulo 1: ...\u0026#39;); Memo1.Lines.Add(\u0026#39;Par√°grafo 2: ...\u0026#39;); Memo1.Lines.Add(\u0026#39;Par√°grafo 3: ...\u0026#39;); Problema #2 ‚Äî Debug com with √© a mesma coisa que tentar achar agulha num palheiro\u0026hellip; s√≥ que o palheiro t√° pegando fogo Quer depurar um trecho que usa with?\nBoa sorte, babaca. O depurador olha pro seu c√≥digo e pensa:\n‚ÄúAmigo, eu n√£o fa√ßo ideia de quem √© esse objeto a√≠.‚Äù\nOlha essa desgra√ßa: with ACBrNFe1.NotasFiscais.Add.NFe do begin ide.cNF := \u0026#39;12345678\u0026#39;; end; Na hora de inspecionar ide.cNF, o compilador olha pra voc√™ e diz:\n‚ÄúN√£o sei quem √© ide, e sinceramente, tamb√©m n√£o quero saber.‚Äù\nA√≠ o cara tem que reconstruir toda a cadeia s√≥ pra ver um valorzinho.\nTudo isso porque quis ‚Äúdigitar menos‚Äù.\nParab√©ns, guerreiro do Ctrl+C Ctrl+V.\nProblema #3 ‚Äî Voc√™ nem sabe mais o que est√° alterando No with, voc√™ acha que est√° mexendo em um objeto, mas na verdade est√° atacando outro completamente diferente.\n√â o inferno em forma de sintaxe.\nO caos em pessoa: with Nota do begin with Det.Add do begin with Imposto do begin with ICMS do begin // Aqui ningu√©m sabe mais quem √© quem nesse caralho end; end; end; end; Quem l√™ um c√≥digo desses merece um aumento‚Ä¶ ou uma interna√ß√£o.\nCoice do Bruto: Aqui cada linha sabe quem √© o dono da bronca.\nE se der pau, o depurador sabe tamb√©m. var Nota: TNFe; Det: TDetCollectionItem; begin Nota := ACBrNFe1.NotasFiscais.Add.NFe; Det := Nota.Det.Add; Det.Imposto.ICMS.CST := cst00; Det.Imposto.ICMS.orig := oeNacional; end; Como largar o v√≠cio do with (passo a passo de desintoxica√ß√£o) Descubra o tipo de retorno (Ctrl+Clique, pregui√ßoso).\nExemplo: NotasFiscais.Add.NFe : TNFe. Crie uma vari√°vel decente: var Nota: TNFe; Nota := ACBrNFe1.NotasFiscais.Add.NFe; Fez um .Add? Guarda o item: var Det: TDetCollectionItem; Det := Nota.Det.Add; D√™ nomes de gente pras vari√°veis.\nNada de a, b, obj, aux. Nomeie direito. Quebre o c√≥digo. C√≥digo bom √© aquele que at√© o estagi√°rio de marketing entende. Exemplo completo (sem pregui√ßa) uses ACBrNFe, ACBrNFeNotasFiscais; procedure TForm1.GerarNFeClara; var Nota: TNFe; Det: TDetCollectionItem; begin Nota := ACBrNFe1.NotasFiscais.Add.NFe; Nota.Ide.cNF := \u0026#39;12345678\u0026#39;; Nota.Ide.nNF := 2; Nota.Ide.tpAmb := taHomologacao; Nota.Ide.finNFe := fnNormal; Det := Nota.Det.Add; Det.nItem := 1; Det.Prod.cProd := \u0026#39;ABC123\u0026#39;; Det.Prod.xProd := \u0026#39;Produto Exemplo\u0026#39;; Det.Prod.qCom := 1.0000; Det.Prod.vUnCom := 100.00; Det.Imposto.ICMS.CST := cst00; Det.Imposto.ICMS.orig := oeNacional; end; Coice do Bruto: D√° mais trabalho? D√°.\nMas pelo menos voc√™ entende o que escreveu ‚Äî e n√£o parece que um estagi√°rio b√™bado codou isso. Checklist do Bruto para banir o with Declare vari√°veis decentes. Quebre cadeias longas. Nomeie as coisas direito. Fa√ßa o debug funcionar sem reza brava. E se algu√©m usar with no seu projeto\u0026hellip; refatora sem d√≥ e demita o respons√°vel. ‚ÄúMas Bruto, eu digito menos com with\u0026hellip;‚Äù E eu digito menos ainda se eu deletar seu c√≥digo inteiro.\nDigitar menos n√£o √© meta de programador.\nEntender o que escreveu √©.\nConclus√£o O with √© a muleta dos pregui√ßosos.\n√â o ‚Äújeitinho brasileiro‚Äù aplicado √† programa√ß√£o.\nQuer ser bom? Escreve direito. Quer ser r√°pido? Usa snippet.\nCoice do Bruto: Mas se continuar defendendo with, n√£o me chama pra dar manuten√ß√£o no seu c√≥digo, porque eu vou arrancar esse neg√≥cio de l√° nem que seja na marra.\nSe voc√™ √© do time with, √≥timo ‚Äî s√≥ n√£o me chame pra manuten√ß√£o. Se me chamar, eu vou l√° e arranco esse v√≠cio do seu c√≥digo sem d√≥. E se achou tudo isso uma besteira\u0026hellip;\nT√° bom tamb√©m.\nEu continuo dormindo bem e o with continua sendo uma bosta. üòé\n","permalink":"http://localhost:1313/pt/posts/pare-de-usar-with-no-delphi/","summary":"Um manifesto do Bruto do Delphi: por que o \u003ccode\u003ewith\u003c/code\u003e √© o capeta disfar√ßado de atalho.","title":"Pare de Usar With no Delphi"},{"content":"L√° por 2018, no Delphi 10.3 Rio, os engenheiros da Embarcadero resolveram ‚Äúmodernizar‚Äù o neg√≥cio e inventaram as vari√°veis inline.\nA ideia parece genial: declarar a vari√°vel ali, no exato ponto onde vai usar.\nNo papel √© bonito. Na pr√°tica, √© tipo botar farol de LED num fusca ‚Äî chama aten√ß√£o, mas n√£o resolve o problema.\nNeste post, eu te explico o que s√£o essas benditas vari√°veis inline, quando elas at√© fazem sentido, e por que, na minha opini√£o, qualquer coisa fora de um for √© receita de bagun√ßa.\nO que √© vari√°vel inline Desde os prim√≥rdios do Pascal, l√° da √©poca que a gente ainda usava disquete e o compilador cabia num disquete e meio, toda vari√°vel local era declarada no topo do m√©todo, antes do begin.\nEsse era o padr√£o: bonito, previs√≠vel e l√≥gico.\nA√≠ veio o Delphi 10.3 Rio e resolveu permitir isso aqui:\nprocedure Test; begin var i: Integer := 10; ShowMessage(i.ToString); end; Parece pr√°tico, n√©? E √© mesmo‚Ä¶ at√© o momento em que o c√≥digo come√ßa a crescer.\nA√≠ voc√™ vai ca√ßar onde est√° a vari√°vel, e descobre que algu√©m teve a brilhante ideia de declarar um var no meio de um if, outro dentro de um try, e outro l√° no fim do begin.\nPronto, virou merda.\nOs pr√≥s (pra n√£o dizer que eu s√≥ reclamo) O escopo fica mais curto: terminou o bloco, a vari√°vel morre. D√° pra declarar no ponto de uso, beleza. O compilador infere o tipo, ent√£o o c√≥digo fica menor. Evita vari√°veis zumbis que seguem vivas sem necessidade. Ok, tem sua utilidade. Mas a turma come√ßou a achar que isso √© desculpa pra jogar var em qualquer canto do c√≥digo. Os contras (e aqui come√ßa a bronca) Coice do Bruto: Fora do for, vira bagun√ßa generalizada.\nVoc√™ abre um m√©todo e tem var em cada esquina.\nO padr√£o do Delphi sempre foi simples: quer saber as vari√°veis? sobe l√° pro topo, antes do begin.\nAgora tem que sair ca√ßando var no meio do inferno. √Äs vezes nem tipo tem: var x := AlgumaFuncao(); ‚Äî a√≠ voc√™ precisa abrir a fun√ß√£o pra saber o que √© x. Manuten√ß√£o? Virou ca√ßa ao tesouro. C√≥digo grande com inline √© tipo novela ruim: parece que vai melhorar, mas s√≥ piora. Resumo: quem quer economizar tr√™s teclas acaba gastando meia hora pra entender o que o pr√≥prio c√≥digo faz.\nOpini√£o do Bruto Vari√°vel inline s√≥ faz sentido em dois lugares:\nDentro de um for, tipo for var i := 0 to 10 do. Em blocos pequenos, de prefer√™ncia com menos de meia tela. Fora disso, √© firula.\nQuer declarar no meio do m√©todo? Faz um favor pra humanidade e vai vender pamonha.\nQuem for dar manuten√ß√£o vai te xingar em tr√™s l√≠nguas diferentes, e com raz√£o.\nCoice do Bruto: No meu c√≥digo, vari√°vel √© tudo antes do begin.\nSe voc√™ precisar achar uma, vai l√° e t√° tudo ali, arrumadinho.\nIsso √© padr√£o, √© clareza, √© paz de esp√≠rito. Exemplo bom (aceit√°vel) for var Item in Lista do begin var Dobrado := Item * 2; ShowMessage(Dobrado.ToString); end; Curto, direto, limpo. Morreu dentro do loop, n√£o incomoda ningu√©m.\nExemplo ruim (zona total) procedure Calcula; begin var Total := 0; if Condicao then begin var Aux := SomaFuncao(); Total := Total + Aux; end; var Outro := OutraFuncao(); ShowMessage(Total.ToString + Outro.ToString); end; Onde foi declarada ‚ÄúOutro‚Äù? Qual o tipo dela? O que ela come?\nPra descobrir, s√≥ debugando.\nE o coitado que abrir isso daqui seis meses vai querer pular da janela.\nExemplo da desgra√ßa suprema (mesmo nome, tipos diferentes) procedure Teste; begin var Valor: Integer := 10; ShowMessage(\u0026#39;Valor inteiro: \u0026#39; + Valor.ToString); begin var Valor: String := \u0026#39;dez\u0026#39;; ShowMessage(\u0026#39;Valor string: \u0026#39; + Valor); end; ShowMessage(\u0026#39;Valor ainda √© inteiro: \u0026#39; + Valor.ToString); end; Olha que maravilha: duas vari√°veis com o mesmo nome, tipos diferentes, vivas em blocos diferentes.\nCompila feliz, mas quem ler isso vai pensar que o compilador enlouqueceu.\nVoc√™ acha que √© um Integer, mas dentro de um bloco virou String.\nDepois volta a ser Integer.\nIsso n√£o √© clareza ‚Äî isso √© transtorno de identidade de vari√°vel.\nConclus√£o Coice do Bruto: Vari√°veis inline √© igual makita na m√£o de crian√ßa: pode at√© funcionar, mas voc√™ sabe que vai dar merda e alguem vai sair chorando (e quem sabe com um dedo a menos).\nUse no for, use em bloco pequeno, mas n√£o espalha var pelo c√≥digo que nem confete no carnaval.\nO padr√£o do Delphi √© simples, bonito e testado h√° d√©cadas:\nvar tudo antes do begin.\nFoge disso e o c√≥digo vira um bingo de escopo.\nE se eu abrir seu c√≥digo e encontrar vari√°vel inline espalhada, j√° aviso:\neu vou arrancar tudo e botar o var l√° em cima, onde sempre deveria estar.\nNa marra, se for preciso.\n","permalink":"http://localhost:1313/pt/posts/variaveis-inline-no-delphi/","summary":"\u003cp\u003eL√° por 2018, no \u003cstrong\u003eDelphi 10.3 Rio\u003c/strong\u003e, os engenheiros da Embarcadero resolveram ‚Äúmodernizar‚Äù o neg√≥cio e inventaram as \u003cstrong\u003evari√°veis inline\u003c/strong\u003e.\u003cbr\u003e\nA ideia parece genial: declarar a vari√°vel ali, no exato ponto onde vai usar.\u003cbr\u003e\nNo papel √© bonito. Na pr√°tica, √© tipo botar farol de LED num fusca ‚Äî chama aten√ß√£o, mas n√£o resolve o problema.\u003c/p\u003e\n\u003cp\u003eNeste post, eu te explico o que s√£o essas benditas vari√°veis inline, quando elas at√© fazem sentido, e por que, na minha opini√£o, \u003cstrong\u003equalquer coisa fora de um \u003ccode\u003efor\u003c/code\u003e √© receita de bagun√ßa.\u003c/strong\u003e\u003c/p\u003e","title":"Vari√°veis inline ‚Äì para√≠so ou zona?"},{"content":" WITH √© coisa de programador pregui√ßoso Coice do Bruto: ‚ö†Ô∏è Aviso de utilidade p√∫blica:\nEste texto √© opinativo, mal humorado e cheio de verdade.\nSe voc√™ ama o with e acha que ele √© lindo, j√° pode apertar Ctrl+W e fechar essa aba.\nEu n√£o vou dormir menos, n√£o vou comer menos e n√£o vou te mandar flores.\nAgora, se voc√™ quer entender de verdade por que esse treco √© uma desgra√ßa no Delphi ‚Äî senta a√≠ e presta aten√ß√£o.\nOu ent√£o, veja esse artigo em v√≠deo O que √© esse tal de with e por que o povo usa O with √© aquele ‚Äúatalho m√°gico‚Äù que promete te poupar meia d√∫zia de teclas.\nO sujeito olha praquilo e pensa:\n‚ÄúNossa, que lindo! N√£o preciso digitar Memo1.Lines toda hora!‚Äù\nPois √©‚Ä¶ e depois n√£o entende por que o c√≥digo dele parece uma merda.\nO with serve pra:\n‚ÄúEncurtar‚Äù chamadas (tipo Memo1.Lines.Add). Preencher cole√ß√µes (tipo ACBrNFe1.NotasFiscais.Add). E serve tamb√©m pra bagun√ßar seu c√≥digo, confundir o depurador e te fazer parecer um pregui√ßoso.\nBonito, n√©?\nProblema #1 ‚Äî O with fode a leitura do seu c√≥digo Sabe aquele c√≥digo bonito que voc√™ l√™ e entende de primeira?\nPois √©, o with pega esse c√≥digo, limpa a bunda com ele e joga no lixo.\nExemplo cl√°ssico de pregui√ßa: with Memo1.Lines do begin Clear; Add(\u0026#39;Cap√≠tulo 1: ...\u0026#39;); Add(\u0026#39;Par√°grafo 2: ...\u0026#39;); Add(\u0026#39;Par√°grafo 3: ...\u0026#39;); end; O sujeito que escreveu isso acha que economizou tempo.\nEconomizou nada, s√≥ fodeu quem vai dar manuten√ß√£o.\nCoice do Bruto: Aqui cada linha grita quem √© o dono da a√ß√£o.\nN√£o tem charada, n√£o tem adivinha√ß√£o.\nO c√≥digo √© honesto ‚Äî coisa rara hoje em dia. Memo1.Lines.Clear; Memo1.Lines.Add(\u0026#39;Cap√≠tulo 1: ...\u0026#39;); Memo1.Lines.Add(\u0026#39;Par√°grafo 2: ...\u0026#39;); Memo1.Lines.Add(\u0026#39;Par√°grafo 3: ...\u0026#39;); Problema #2 ‚Äî Debug com with √© a mesma coisa que tentar achar agulha num palheiro\u0026hellip; s√≥ que o palheiro t√° pegando fogo Quer depurar um trecho que usa with?\nBoa sorte, babaca. O depurador olha pro seu c√≥digo e pensa:\n‚ÄúAmigo, eu n√£o fa√ßo ideia de quem √© esse objeto a√≠.‚Äù\nOlha essa desgra√ßa: with ACBrNFe1.NotasFiscais.Add.NFe do begin ide.cNF := \u0026#39;12345678\u0026#39;; end; Na hora de inspecionar ide.cNF, o compilador olha pra voc√™ e diz:\n‚ÄúN√£o sei quem √© ide, e sinceramente, tamb√©m n√£o quero saber.‚Äù\nA√≠ o cara tem que reconstruir toda a cadeia s√≥ pra ver um valorzinho.\nTudo isso porque quis ‚Äúdigitar menos‚Äù.\nParab√©ns, guerreiro do Ctrl+C Ctrl+V.\nProblema #3 ‚Äî Voc√™ nem sabe mais o que est√° alterando No with, voc√™ acha que est√° mexendo em um objeto, mas na verdade est√° atacando outro completamente diferente.\n√â o inferno em forma de sintaxe.\nO caos em pessoa: with Nota do begin with Det.Add do begin with Imposto do begin with ICMS do begin // Aqui ningu√©m sabe mais quem √© quem nesse caralho end; end; end; end; Quem l√™ um c√≥digo desses merece um aumento‚Ä¶ ou uma interna√ß√£o.\nCoice do Bruto: Aqui cada linha sabe quem √© o dono da bronca.\nE se der pau, o depurador sabe tamb√©m. var Nota: TNFe; Det: TDetCollectionItem; begin Nota := ACBrNFe1.NotasFiscais.Add.NFe; Det := Nota.Det.Add; Det.Imposto.ICMS.CST := cst00; Det.Imposto.ICMS.orig := oeNacional; end; Como largar o v√≠cio do with (passo a passo de desintoxica√ß√£o) Descubra o tipo de retorno (Ctrl+Clique, pregui√ßoso).\nExemplo: NotasFiscais.Add.NFe : TNFe. Crie uma vari√°vel decente: var Nota: TNFe; Nota := ACBrNFe1.NotasFiscais.Add.NFe; Fez um .Add? Guarda o item: var Det: TDetCollectionItem; Det := Nota.Det.Add; D√™ nomes de gente pras vari√°veis.\nNada de a, b, obj, aux. Nomeie direito. Quebre o c√≥digo. C√≥digo bom √© aquele que at√© o estagi√°rio de marketing entende. Exemplo completo (sem pregui√ßa) uses ACBrNFe, ACBrNFeNotasFiscais; procedure TForm1.GerarNFeClara; var Nota: TNFe; Det: TDetCollectionItem; begin Nota := ACBrNFe1.NotasFiscais.Add.NFe; Nota.Ide.cNF := \u0026#39;12345678\u0026#39;; Nota.Ide.nNF := 2; Nota.Ide.tpAmb := taHomologacao; Nota.Ide.finNFe := fnNormal; Det := Nota.Det.Add; Det.nItem := 1; Det.Prod.cProd := \u0026#39;ABC123\u0026#39;; Det.Prod.xProd := \u0026#39;Produto Exemplo\u0026#39;; Det.Prod.qCom := 1.0000; Det.Prod.vUnCom := 100.00; Det.Imposto.ICMS.CST := cst00; Det.Imposto.ICMS.orig := oeNacional; end; Coice do Bruto: D√° mais trabalho? D√°.\nMas pelo menos voc√™ entende o que escreveu ‚Äî e n√£o parece que um estagi√°rio b√™bado codou isso. Checklist do Bruto para banir o with Declare vari√°veis decentes. Quebre cadeias longas. Nomeie as coisas direito. Fa√ßa o debug funcionar sem reza brava. E se algu√©m usar with no seu projeto\u0026hellip; refatora sem d√≥ e demita o respons√°vel. ‚ÄúMas Bruto, eu digito menos com with\u0026hellip;‚Äù E eu digito menos ainda se eu deletar seu c√≥digo inteiro.\nDigitar menos n√£o √© meta de programador.\nEntender o que escreveu √©.\nConclus√£o O with √© a muleta dos pregui√ßosos.\n√â o ‚Äújeitinho brasileiro‚Äù aplicado √† programa√ß√£o.\nQuer ser bom? Escreve direito. Quer ser r√°pido? Usa snippet.\nCoice do Bruto: Mas se continuar defendendo with, n√£o me chama pra dar manuten√ß√£o no seu c√≥digo, porque eu vou arrancar esse neg√≥cio de l√° nem que seja na marra.\nSe voc√™ √© do time with, √≥timo ‚Äî s√≥ n√£o me chame pra manuten√ß√£o. Se me chamar, eu vou l√° e arranco esse v√≠cio do seu c√≥digo sem d√≥. E se achou tudo isso uma besteira\u0026hellip;\nT√° bom tamb√©m.\nEu continuo dormindo bem e o with continua sendo uma bosta. üòé\n","permalink":"http://localhost:1313/pt/posts/pare-de-usar-with-no-delphi/","summary":"Um manifesto do Bruto do Delphi: por que o \u003ccode\u003ewith\u003c/code\u003e √© o capeta disfar√ßado de atalho.","title":"Pare de Usar With no Delphi"},{"content":"L√° por 2018, no Delphi 10.3 Rio, os engenheiros da Embarcadero resolveram ‚Äúmodernizar‚Äù o neg√≥cio e inventaram as vari√°veis inline.\nA ideia parece genial: declarar a vari√°vel ali, no exato ponto onde vai usar.\nNo papel √© bonito. Na pr√°tica, √© tipo botar farol de LED num fusca ‚Äî chama aten√ß√£o, mas n√£o resolve o problema.\nNeste post, eu te explico o que s√£o essas benditas vari√°veis inline, quando elas at√© fazem sentido, e por que, na minha opini√£o, qualquer coisa fora de um for √© receita de bagun√ßa.\nO que √© vari√°vel inline Desde os prim√≥rdios do Pascal, l√° da √©poca que a gente ainda usava disquete e o compilador cabia num disquete e meio, toda vari√°vel local era declarada no topo do m√©todo, antes do begin.\nEsse era o padr√£o: bonito, previs√≠vel e l√≥gico.\nA√≠ veio o Delphi 10.3 Rio e resolveu permitir isso aqui:\nprocedure Test; begin var i: Integer := 10; ShowMessage(i.ToString); end; Parece pr√°tico, n√©? E √© mesmo‚Ä¶ at√© o momento em que o c√≥digo come√ßa a crescer.\nA√≠ voc√™ vai ca√ßar onde est√° a vari√°vel, e descobre que algu√©m teve a brilhante ideia de declarar um var no meio de um if, outro dentro de um try, e outro l√° no fim do begin.\nPronto, virou merda.\nOs pr√≥s (pra n√£o dizer que eu s√≥ reclamo) O escopo fica mais curto: terminou o bloco, a vari√°vel morre. D√° pra declarar no ponto de uso, beleza. O compilador infere o tipo, ent√£o o c√≥digo fica menor. Evita vari√°veis zumbis que seguem vivas sem necessidade. Ok, tem sua utilidade. Mas a turma come√ßou a achar que isso √© desculpa pra jogar var em qualquer canto do c√≥digo. Os contras (e aqui come√ßa a bronca) Coice do Bruto: Fora do for, vira bagun√ßa generalizada.\nVoc√™ abre um m√©todo e tem var em cada esquina.\nO padr√£o do Delphi sempre foi simples: quer saber as vari√°veis? sobe l√° pro topo, antes do begin.\nAgora tem que sair ca√ßando var no meio do inferno. √Äs vezes nem tipo tem: var x := AlgumaFuncao(); ‚Äî a√≠ voc√™ precisa abrir a fun√ß√£o pra saber o que √© x. Manuten√ß√£o? Virou ca√ßa ao tesouro. C√≥digo grande com inline √© tipo novela ruim: parece que vai melhorar, mas s√≥ piora. Resumo: quem quer economizar tr√™s teclas acaba gastando meia hora pra entender o que o pr√≥prio c√≥digo faz.\nOpini√£o do Bruto Vari√°vel inline s√≥ faz sentido em dois lugares:\nDentro de um for, tipo for var i := 0 to 10 do. Em blocos pequenos, de prefer√™ncia com menos de meia tela. Fora disso, √© firula.\nQuer declarar no meio do m√©todo? Faz um favor pra humanidade e vai vender pamonha.\nQuem for dar manuten√ß√£o vai te xingar em tr√™s l√≠nguas diferentes, e com raz√£o.\nCoice do Bruto: No meu c√≥digo, vari√°vel √© tudo antes do begin.\nSe voc√™ precisar achar uma, vai l√° e t√° tudo ali, arrumadinho.\nIsso √© padr√£o, √© clareza, √© paz de esp√≠rito. Exemplo bom (aceit√°vel) for var Item in Lista do begin var Dobrado := Item * 2; ShowMessage(Dobrado.ToString); end; Curto, direto, limpo. Morreu dentro do loop, n√£o incomoda ningu√©m.\nExemplo ruim (zona total) procedure Calcula; begin var Total := 0; if Condicao then begin var Aux := SomaFuncao(); Total := Total + Aux; end; var Outro := OutraFuncao(); ShowMessage(Total.ToString + Outro.ToString); end; Onde foi declarada ‚ÄúOutro‚Äù? Qual o tipo dela? O que ela come?\nPra descobrir, s√≥ debugando.\nE o coitado que abrir isso daqui seis meses vai querer pular da janela.\nExemplo da desgra√ßa suprema (mesmo nome, tipos diferentes) procedure Teste; begin var Valor: Integer := 10; ShowMessage(\u0026#39;Valor inteiro: \u0026#39; + Valor.ToString); begin var Valor: String := \u0026#39;dez\u0026#39;; ShowMessage(\u0026#39;Valor string: \u0026#39; + Valor); end; ShowMessage(\u0026#39;Valor ainda √© inteiro: \u0026#39; + Valor.ToString); end; Olha que maravilha: duas vari√°veis com o mesmo nome, tipos diferentes, vivas em blocos diferentes.\nCompila feliz, mas quem ler isso vai pensar que o compilador enlouqueceu.\nVoc√™ acha que √© um Integer, mas dentro de um bloco virou String.\nDepois volta a ser Integer.\nIsso n√£o √© clareza ‚Äî isso √© transtorno de identidade de vari√°vel.\nConclus√£o Coice do Bruto: Vari√°veis inline √© igual makita na m√£o de crian√ßa: pode at√© funcionar, mas voc√™ sabe que vai dar merda e alguem vai sair chorando (e quem sabe com um dedo a menos).\nUse no for, use em bloco pequeno, mas n√£o espalha var pelo c√≥digo que nem confete no carnaval.\nO padr√£o do Delphi √© simples, bonito e testado h√° d√©cadas:\nvar tudo antes do begin.\nFoge disso e o c√≥digo vira um bingo de escopo.\nE se eu abrir seu c√≥digo e encontrar vari√°vel inline espalhada, j√° aviso:\neu vou arrancar tudo e botar o var l√° em cima, onde sempre deveria estar.\nNa marra, se for preciso.\n","permalink":"http://localhost:1313/pt/posts/variaveis-inline-no-delphi/","summary":"\u003cp\u003eL√° por 2018, no \u003cstrong\u003eDelphi 10.3 Rio\u003c/strong\u003e, os engenheiros da Embarcadero resolveram ‚Äúmodernizar‚Äù o neg√≥cio e inventaram as \u003cstrong\u003evari√°veis inline\u003c/strong\u003e.\u003cbr\u003e\nA ideia parece genial: declarar a vari√°vel ali, no exato ponto onde vai usar.\u003cbr\u003e\nNo papel √© bonito. Na pr√°tica, √© tipo botar farol de LED num fusca ‚Äî chama aten√ß√£o, mas n√£o resolve o problema.\u003c/p\u003e\n\u003cp\u003eNeste post, eu te explico o que s√£o essas benditas vari√°veis inline, quando elas at√© fazem sentido, e por que, na minha opini√£o, \u003cstrong\u003equalquer coisa fora de um \u003ccode\u003efor\u003c/code\u003e √© receita de bagun√ßa.\u003c/strong\u003e\u003c/p\u003e","title":"Vari√°veis inline ‚Äì para√≠so ou zona?"},{"content":" WITH √© coisa de programador pregui√ßoso Coice do Bruto: ‚ö†Ô∏è Aviso de utilidade p√∫blica:\nEste texto √© opinativo, mal humorado e cheio de verdade.\nSe voc√™ ama o with e acha que ele √© lindo, j√° pode apertar Ctrl+W e fechar essa aba.\nEu n√£o vou dormir menos, n√£o vou comer menos e n√£o vou te mandar flores.\nAgora, se voc√™ quer entender de verdade por que esse treco √© uma desgra√ßa no Delphi ‚Äî senta a√≠ e presta aten√ß√£o.\nOu ent√£o, veja esse artigo em v√≠deo O que √© esse tal de with e por que o povo usa O with √© aquele ‚Äúatalho m√°gico‚Äù que promete te poupar meia d√∫zia de teclas.\nO sujeito olha praquilo e pensa:\n‚ÄúNossa, que lindo! N√£o preciso digitar Memo1.Lines toda hora!‚Äù\nPois √©‚Ä¶ e depois n√£o entende por que o c√≥digo dele parece uma merda.\nO with serve pra:\n‚ÄúEncurtar‚Äù chamadas (tipo Memo1.Lines.Add). Preencher cole√ß√µes (tipo ACBrNFe1.NotasFiscais.Add). E serve tamb√©m pra bagun√ßar seu c√≥digo, confundir o depurador e te fazer parecer um pregui√ßoso.\nBonito, n√©?\nProblema #1 ‚Äî O with fode a leitura do seu c√≥digo Sabe aquele c√≥digo bonito que voc√™ l√™ e entende de primeira?\nPois √©, o with pega esse c√≥digo, limpa a bunda com ele e joga no lixo.\nExemplo cl√°ssico de pregui√ßa: with Memo1.Lines do begin Clear; Add(\u0026#39;Cap√≠tulo 1: ...\u0026#39;); Add(\u0026#39;Par√°grafo 2: ...\u0026#39;); Add(\u0026#39;Par√°grafo 3: ...\u0026#39;); end; O sujeito que escreveu isso acha que economizou tempo.\nEconomizou nada, s√≥ fodeu quem vai dar manuten√ß√£o.\nCoice do Bruto: Aqui cada linha grita quem √© o dono da a√ß√£o.\nN√£o tem charada, n√£o tem adivinha√ß√£o.\nO c√≥digo √© honesto ‚Äî coisa rara hoje em dia. Memo1.Lines.Clear; Memo1.Lines.Add(\u0026#39;Cap√≠tulo 1: ...\u0026#39;); Memo1.Lines.Add(\u0026#39;Par√°grafo 2: ...\u0026#39;); Memo1.Lines.Add(\u0026#39;Par√°grafo 3: ...\u0026#39;); Problema #2 ‚Äî Debug com with √© a mesma coisa que tentar achar agulha num palheiro\u0026hellip; s√≥ que o palheiro t√° pegando fogo Quer depurar um trecho que usa with?\nBoa sorte, babaca. O depurador olha pro seu c√≥digo e pensa:\n‚ÄúAmigo, eu n√£o fa√ßo ideia de quem √© esse objeto a√≠.‚Äù\nOlha essa desgra√ßa: with ACBrNFe1.NotasFiscais.Add.NFe do begin ide.cNF := \u0026#39;12345678\u0026#39;; end; Na hora de inspecionar ide.cNF, o compilador olha pra voc√™ e diz:\n‚ÄúN√£o sei quem √© ide, e sinceramente, tamb√©m n√£o quero saber.‚Äù\nA√≠ o cara tem que reconstruir toda a cadeia s√≥ pra ver um valorzinho.\nTudo isso porque quis ‚Äúdigitar menos‚Äù.\nParab√©ns, guerreiro do Ctrl+C Ctrl+V.\nProblema #3 ‚Äî Voc√™ nem sabe mais o que est√° alterando No with, voc√™ acha que est√° mexendo em um objeto, mas na verdade est√° atacando outro completamente diferente.\n√â o inferno em forma de sintaxe.\nO caos em pessoa: with Nota do begin with Det.Add do begin with Imposto do begin with ICMS do begin // Aqui ningu√©m sabe mais quem √© quem nesse caralho end; end; end; end; Quem l√™ um c√≥digo desses merece um aumento‚Ä¶ ou uma interna√ß√£o.\nCoice do Bruto: Aqui cada linha sabe quem √© o dono da bronca.\nE se der pau, o depurador sabe tamb√©m. var Nota: TNFe; Det: TDetCollectionItem; begin Nota := ACBrNFe1.NotasFiscais.Add.NFe; Det := Nota.Det.Add; Det.Imposto.ICMS.CST := cst00; Det.Imposto.ICMS.orig := oeNacional; end; Como largar o v√≠cio do with (passo a passo de desintoxica√ß√£o) Descubra o tipo de retorno (Ctrl+Clique, pregui√ßoso).\nExemplo: NotasFiscais.Add.NFe : TNFe. Crie uma vari√°vel decente: var Nota: TNFe; Nota := ACBrNFe1.NotasFiscais.Add.NFe; Fez um .Add? Guarda o item: var Det: TDetCollectionItem; Det := Nota.Det.Add; D√™ nomes de gente pras vari√°veis.\nNada de a, b, obj, aux. Nomeie direito. Quebre o c√≥digo. C√≥digo bom √© aquele que at√© o estagi√°rio de marketing entende. Exemplo completo (sem pregui√ßa) uses ACBrNFe, ACBrNFeNotasFiscais; procedure TForm1.GerarNFeClara; var Nota: TNFe; Det: TDetCollectionItem; begin Nota := ACBrNFe1.NotasFiscais.Add.NFe; Nota.Ide.cNF := \u0026#39;12345678\u0026#39;; Nota.Ide.nNF := 2; Nota.Ide.tpAmb := taHomologacao; Nota.Ide.finNFe := fnNormal; Det := Nota.Det.Add; Det.nItem := 1; Det.Prod.cProd := \u0026#39;ABC123\u0026#39;; Det.Prod.xProd := \u0026#39;Produto Exemplo\u0026#39;; Det.Prod.qCom := 1.0000; Det.Prod.vUnCom := 100.00; Det.Imposto.ICMS.CST := cst00; Det.Imposto.ICMS.orig := oeNacional; end; Coice do Bruto: D√° mais trabalho? D√°.\nMas pelo menos voc√™ entende o que escreveu ‚Äî e n√£o parece que um estagi√°rio b√™bado codou isso. Checklist do Bruto para banir o with Declare vari√°veis decentes. Quebre cadeias longas. Nomeie as coisas direito. Fa√ßa o debug funcionar sem reza brava. E se algu√©m usar with no seu projeto\u0026hellip; refatora sem d√≥ e demita o respons√°vel. ‚ÄúMas Bruto, eu digito menos com with\u0026hellip;‚Äù E eu digito menos ainda se eu deletar seu c√≥digo inteiro.\nDigitar menos n√£o √© meta de programador.\nEntender o que escreveu √©.\nConclus√£o O with √© a muleta dos pregui√ßosos.\n√â o ‚Äújeitinho brasileiro‚Äù aplicado √† programa√ß√£o.\nQuer ser bom? Escreve direito. Quer ser r√°pido? Usa snippet.\nCoice do Bruto: Mas se continuar defendendo with, n√£o me chama pra dar manuten√ß√£o no seu c√≥digo, porque eu vou arrancar esse neg√≥cio de l√° nem que seja na marra.\nSe voc√™ √© do time with, √≥timo ‚Äî s√≥ n√£o me chame pra manuten√ß√£o. Se me chamar, eu vou l√° e arranco esse v√≠cio do seu c√≥digo sem d√≥. E se achou tudo isso uma besteira\u0026hellip;\nT√° bom tamb√©m.\nEu continuo dormindo bem e o with continua sendo uma bosta. üòé\n","permalink":"http://localhost:1313/pt/posts/pare-de-usar-with-no-delphi/","summary":"Um manifesto do Bruto do Delphi: por que o \u003ccode\u003ewith\u003c/code\u003e √© o capeta disfar√ßado de atalho.","title":"Pare de Usar With no Delphi"},{"content":"Rodando Delphi no WSL2 ‚Äî quando o Linux entra na sua m√°quina e o Windows s√≥ assiste L√° por 2025 eu resolvi encarar a ideia maluca de rodar Delphi no Linux sem sair do Windows.\n√â isso mesmo: um tal de WSL2 ‚Äî o ‚Äúsubsystem for linux‚Äù ‚Äî que deixa o pinguim morar dentro do Windows e ainda comer na mesma mesa. E pra minha surpresa, funciona. Ent√£o se prepara, porque eu vou te mostrar como eu fiz isso funcionar com o Ubuntu 22.04 (era o est√°vel quando escrevi este post). Se quando voc√™ estiver lendo isso o n√∫mero for outro (24.04, 26.04‚Ä¶), troca o nome na instala√ß√£o e segue o baile. 1. O que √© o tal do WSL O WSL √© basicamente um Linux domesticado, rodando dentro do Windows. N√£o √© VM, n√£o √© Docker ‚Äî √© r√°pido e pr√°tico. Voc√™ roda um comando e pronto: tem um Ubuntu te olhando feio.\n2. Instalando o Ubuntu (ou o que tiver no lugar dele) Abra o Prompt de Comando como administrador e rode:\n1 wsl --list --online Vai aparecer uma lista de distribui√ß√µes. Na √©poca eu usei Ubuntu 22.04, mas se j√° saiu 24.04, use ele. O nome muda, o processo √© o mesmo.\nPara instalar:\n1 wsl --install Ubuntu-22.04 O Windows baixa, instala e pede usu√°rio e senha. Escolha algo que voc√™ lembre, porque o Linux vai cobrar.\n3. Atualizando o sistema e instalando o que presta No Ubuntu, rode o b√°sico para atualizar os pacotes:\n1 sudo apt update \u0026amp;\u0026amp; sudo apt upgrade \u0026amp;\u0026amp; sudo apt dist-upgrade Depois instale as ferramentas de desenvolvimento que o Delphi precisa:\n1 sudo apt install joe wget p7zip-full curl openssh-server build-essential zlib1g-dev libcurl4-gnutls-dev libncurses5 zlib1g-dev libgtk-3-dev 4. Instalando o PAServer no WSL Copie o PAServer do Windows para dentro do WSL. No Delphi 12, o arquivo fica em algo como:\n1 C:\\\\Program Files (x86)\\\\Embarcadero\\\\Studio\\\\23.0\\\\PAServer\\\\LinuxPAServer23.0.tar.gz No Ubuntu, execute:\n1 2 cp /mnt/c/Program\\ Files\\ \\(x86\\)/Embarcadero/Studio/23.0/PAServer/LinuxPAServer23.0.tar.gz ~/ tar -xvf ./LinuxPAServer23.0.tar.gz Inicie o servidor:\n1 ./PAServer-23.0/paserver Ele pedir√° uma senha ‚Äî defina uma senha de verdade. Aqui n√£o tem ‚Äòdeixar tudo aberto‚Äô (laele). Seguran√ßa √© coisa s√©ria.\nDigite i e pressione Enter para ver o IP do PAServer. Anote.\n5. Configurando o Delphi para conversar com o WSL No Delphi do Windows, instale o FMXLinux via GetIt (se necess√°rio). Depois v√° em:\nTools \u0026gt; Options \u0026gt; Deployment \u0026gt; Connection Profile Manager Clique em Add e crie um perfil para Linux 64-bit. Informe o IP do PAServer, usu√°rio e senha definidos no Ubuntu, e Test Connection. 6. Adicionando o SDK Ainda no Delphi:\nTools \u0026gt; Options \u0026gt; Deployment \u0026gt; SDK Manager Clique em Add, escolha Linux 64-bit e selecione o perfil criado. O Delphi vai copiar um monte de arquivo para o WSL. Demora ‚Äî quando o bot√£o Cancel virar Close, terminou. 7. Compilando direto para Linux Crie um projeto Multi-Device Application e, no Project Manager, selecione Linux 64-bit. Se n√£o aparecer, adicione em Target Platforms.\nPressione F9. Se tudo estiver certo, o app sobe dentro do WSL.\n8. Conclus√£o Coice do Bruto: Pronto. Delphi no Windows, compilando para Linux no WSL.\n√â bonito? N√£o. √â pr√°tico? Depende. √â curioso? Bastante.\nSe der erro: confira IP, PAServer, SDK e firewall. Persistindo, reinicie ‚Äî √†s vezes o Windows s√≥ quer aten√ß√£o.\n‚ÄúSe t√° rodando, n√£o mexe. Se parou, o Windows estragou.‚Äù ‚Äî Bruto do Delphi\nCr√©dito: Este artigo foi escrito durante o Vivid Day da GDK,\rum dia em que os desenvolvedores recebem tempo dedicado para estudar, pesquisar\re produzir conte√∫do t√©cnico. Agrade√ßo √† empresa por apoiar iniciativas que fortalecem\ra comunidade t√©cnica.\r","permalink":"http://localhost:1313/posts/wsl-delphi/","summary":"Rodando Delphi no WSL2 ‚Äî quando o Linux entra na sua m√°quina e o Windows s√≥ assiste.","title":"Rodando Delphi no Linux"},{"content":"L√° por 2018, no Delphi 10.3 Rio, os engenheiros da Embarcadero resolveram ‚Äúmodernizar‚Äù o neg√≥cio e inventaram as vari√°veis inline.\nA ideia parece genial: declarar a vari√°vel ali, no exato ponto onde vai usar.\nNo papel √© bonito. Na pr√°tica, √© tipo botar farol de LED num fusca ‚Äî chama aten√ß√£o, mas n√£o resolve o problema.\nNeste post, eu te explico o que s√£o essas benditas vari√°veis inline, quando elas at√© fazem sentido, e por que, na minha opini√£o, qualquer coisa fora de um for √© receita de bagun√ßa.\nO que √© vari√°vel inline Desde os prim√≥rdios do Pascal, l√° da √©poca que a gente ainda usava disquete e o compilador cabia num disquete e meio, toda vari√°vel local era declarada no topo do m√©todo, antes do begin.\nEsse era o padr√£o: bonito, previs√≠vel e l√≥gico.\nA√≠ veio o Delphi 10.3 Rio e resolveu permitir isso aqui:\nprocedure Test; begin var i: Integer := 10; ShowMessage(i.ToString); end; Parece pr√°tico, n√©? E √© mesmo‚Ä¶ at√© o momento em que o c√≥digo come√ßa a crescer.\nA√≠ voc√™ vai ca√ßar onde est√° a vari√°vel, e descobre que algu√©m teve a brilhante ideia de declarar um var no meio de um if, outro dentro de um try, e outro l√° no fim do begin.\nPronto, virou merda.\nOs pr√≥s (pra n√£o dizer que eu s√≥ reclamo) O escopo fica mais curto: terminou o bloco, a vari√°vel morre. D√° pra declarar no ponto de uso, beleza. O compilador infere o tipo, ent√£o o c√≥digo fica menor. Evita vari√°veis zumbis que seguem vivas sem necessidade. Ok, tem sua utilidade. Mas a turma come√ßou a achar que isso √© desculpa pra jogar var em qualquer canto do c√≥digo. Os contras (e aqui come√ßa a bronca) Coice do Bruto: Fora do for, vira bagun√ßa generalizada.\nVoc√™ abre um m√©todo e tem var em cada esquina.\nO padr√£o do Delphi sempre foi simples: quer saber as vari√°veis? sobe l√° pro topo, antes do begin.\nAgora tem que sair ca√ßando var no meio do inferno. √Äs vezes nem tipo tem: var x := AlgumaFuncao(); ‚Äî a√≠ voc√™ precisa abrir a fun√ß√£o pra saber o que √© x. Manuten√ß√£o? Virou ca√ßa ao tesouro. C√≥digo grande com inline √© tipo novela ruim: parece que vai melhorar, mas s√≥ piora. Resumo: quem quer economizar tr√™s teclas acaba gastando meia hora pra entender o que o pr√≥prio c√≥digo faz.\nOpini√£o do Bruto Vari√°vel inline s√≥ faz sentido em dois lugares:\nDentro de um for, tipo for var i := 0 to 10 do. Em blocos pequenos, de prefer√™ncia com menos de meia tela. Fora disso, √© firula.\nQuer declarar no meio do m√©todo? Faz um favor pra humanidade e vai vender pamonha.\nQuem for dar manuten√ß√£o vai te xingar em tr√™s l√≠nguas diferentes, e com raz√£o.\nCoice do Bruto: No meu c√≥digo, vari√°vel √© tudo antes do begin.\nSe voc√™ precisar achar uma, vai l√° e t√° tudo ali, arrumadinho.\nIsso √© padr√£o, √© clareza, √© paz de esp√≠rito. Exemplo bom (aceit√°vel) for var Item in Lista do begin var Dobrado := Item * 2; ShowMessage(Dobrado.ToString); end; Curto, direto, limpo. Morreu dentro do loop, n√£o incomoda ningu√©m.\nExemplo ruim (zona total) procedure Calcula; begin var Total := 0; if Condicao then begin var Aux := SomaFuncao(); Total := Total + Aux; end; var Outro := OutraFuncao(); ShowMessage(Total.ToString + Outro.ToString); end; Onde foi declarada ‚ÄúOutro‚Äù? Qual o tipo dela? O que ela come?\nPra descobrir, s√≥ debugando.\nE o coitado que abrir isso daqui seis meses vai querer pular da janela.\nExemplo da desgra√ßa suprema (mesmo nome, tipos diferentes) procedure Teste; begin var Valor: Integer := 10; ShowMessage(\u0026#39;Valor inteiro: \u0026#39; + Valor.ToString); begin var Valor: String := \u0026#39;dez\u0026#39;; ShowMessage(\u0026#39;Valor string: \u0026#39; + Valor); end; ShowMessage(\u0026#39;Valor ainda √© inteiro: \u0026#39; + Valor.ToString); end; Olha que maravilha: duas vari√°veis com o mesmo nome, tipos diferentes, vivas em blocos diferentes.\nCompila feliz, mas quem ler isso vai pensar que o compilador enlouqueceu.\nVoc√™ acha que √© um Integer, mas dentro de um bloco virou String.\nDepois volta a ser Integer.\nIsso n√£o √© clareza ‚Äî isso √© transtorno de identidade de vari√°vel.\nConclus√£o Coice do Bruto: Vari√°veis inline √© igual makita na m√£o de crian√ßa: pode at√© funcionar, mas voc√™ sabe que vai dar merda e alguem vai sair chorando (e quem sabe com um dedo a menos).\nUse no for, use em bloco pequeno, mas n√£o espalha var pelo c√≥digo que nem confete no carnaval.\nO padr√£o do Delphi √© simples, bonito e testado h√° d√©cadas:\nvar tudo antes do begin.\nFoge disso e o c√≥digo vira um bingo de escopo.\nE se eu abrir seu c√≥digo e encontrar vari√°vel inline espalhada, j√° aviso:\neu vou arrancar tudo e botar o var l√° em cima, onde sempre deveria estar.\nNa marra, se for preciso.\n","permalink":"http://localhost:1313/pt/posts/variaveis-inline-no-delphi/","summary":"\u003cp\u003eL√° por 2018, no \u003cstrong\u003eDelphi 10.3 Rio\u003c/strong\u003e, os engenheiros da Embarcadero resolveram ‚Äúmodernizar‚Äù o neg√≥cio e inventaram as \u003cstrong\u003evari√°veis inline\u003c/strong\u003e.\u003cbr\u003e\nA ideia parece genial: declarar a vari√°vel ali, no exato ponto onde vai usar.\u003cbr\u003e\nNo papel √© bonito. Na pr√°tica, √© tipo botar farol de LED num fusca ‚Äî chama aten√ß√£o, mas n√£o resolve o problema.\u003c/p\u003e\n\u003cp\u003eNeste post, eu te explico o que s√£o essas benditas vari√°veis inline, quando elas at√© fazem sentido, e por que, na minha opini√£o, \u003cstrong\u003equalquer coisa fora de um \u003ccode\u003efor\u003c/code\u003e √© receita de bagun√ßa.\u003c/strong\u003e\u003c/p\u003e","title":"Vari√°veis inline ‚Äì para√≠so ou zona?"},{"content":" WITH √© coisa de programador pregui√ßoso Coice do Bruto: ‚ö†Ô∏è Aviso de utilidade p√∫blica:\nEste texto √© opinativo, mal humorado e cheio de verdade.\nSe voc√™ ama o with e acha que ele √© lindo, j√° pode apertar Ctrl+W e fechar essa aba.\nEu n√£o vou dormir menos, n√£o vou comer menos e n√£o vou te mandar flores.\nAgora, se voc√™ quer entender de verdade por que esse treco √© uma desgra√ßa no Delphi ‚Äî senta a√≠ e presta aten√ß√£o.\nOu ent√£o, veja esse artigo em v√≠deo O que √© esse tal de with e por que o povo usa O with √© aquele ‚Äúatalho m√°gico‚Äù que promete te poupar meia d√∫zia de teclas.\nO sujeito olha praquilo e pensa:\n‚ÄúNossa, que lindo! N√£o preciso digitar Memo1.Lines toda hora!‚Äù\nPois √©‚Ä¶ e depois n√£o entende por que o c√≥digo dele parece uma merda.\nO with serve pra:\n‚ÄúEncurtar‚Äù chamadas (tipo Memo1.Lines.Add). Preencher cole√ß√µes (tipo ACBrNFe1.NotasFiscais.Add). E serve tamb√©m pra bagun√ßar seu c√≥digo, confundir o depurador e te fazer parecer um pregui√ßoso.\nBonito, n√©?\nProblema #1 ‚Äî O with fode a leitura do seu c√≥digo Sabe aquele c√≥digo bonito que voc√™ l√™ e entende de primeira?\nPois √©, o with pega esse c√≥digo, limpa a bunda com ele e joga no lixo.\nExemplo cl√°ssico de pregui√ßa: with Memo1.Lines do begin Clear; Add(\u0026#39;Cap√≠tulo 1: ...\u0026#39;); Add(\u0026#39;Par√°grafo 2: ...\u0026#39;); Add(\u0026#39;Par√°grafo 3: ...\u0026#39;); end; O sujeito que escreveu isso acha que economizou tempo.\nEconomizou nada, s√≥ fodeu quem vai dar manuten√ß√£o.\nCoice do Bruto: Aqui cada linha grita quem √© o dono da a√ß√£o.\nN√£o tem charada, n√£o tem adivinha√ß√£o.\nO c√≥digo √© honesto ‚Äî coisa rara hoje em dia. Memo1.Lines.Clear; Memo1.Lines.Add(\u0026#39;Cap√≠tulo 1: ...\u0026#39;); Memo1.Lines.Add(\u0026#39;Par√°grafo 2: ...\u0026#39;); Memo1.Lines.Add(\u0026#39;Par√°grafo 3: ...\u0026#39;); Problema #2 ‚Äî Debug com with √© a mesma coisa que tentar achar agulha num palheiro\u0026hellip; s√≥ que o palheiro t√° pegando fogo Quer depurar um trecho que usa with?\nBoa sorte, babaca. O depurador olha pro seu c√≥digo e pensa:\n‚ÄúAmigo, eu n√£o fa√ßo ideia de quem √© esse objeto a√≠.‚Äù\nOlha essa desgra√ßa: with ACBrNFe1.NotasFiscais.Add.NFe do begin ide.cNF := \u0026#39;12345678\u0026#39;; end; Na hora de inspecionar ide.cNF, o compilador olha pra voc√™ e diz:\n‚ÄúN√£o sei quem √© ide, e sinceramente, tamb√©m n√£o quero saber.‚Äù\nA√≠ o cara tem que reconstruir toda a cadeia s√≥ pra ver um valorzinho.\nTudo isso porque quis ‚Äúdigitar menos‚Äù.\nParab√©ns, guerreiro do Ctrl+C Ctrl+V.\nProblema #3 ‚Äî Voc√™ nem sabe mais o que est√° alterando No with, voc√™ acha que est√° mexendo em um objeto, mas na verdade est√° atacando outro completamente diferente.\n√â o inferno em forma de sintaxe.\nO caos em pessoa: with Nota do begin with Det.Add do begin with Imposto do begin with ICMS do begin // Aqui ningu√©m sabe mais quem √© quem nesse caralho end; end; end; end; Quem l√™ um c√≥digo desses merece um aumento‚Ä¶ ou uma interna√ß√£o.\nCoice do Bruto: Aqui cada linha sabe quem √© o dono da bronca.\nE se der pau, o depurador sabe tamb√©m. var Nota: TNFe; Det: TDetCollectionItem; begin Nota := ACBrNFe1.NotasFiscais.Add.NFe; Det := Nota.Det.Add; Det.Imposto.ICMS.CST := cst00; Det.Imposto.ICMS.orig := oeNacional; end; Como largar o v√≠cio do with (passo a passo de desintoxica√ß√£o) Descubra o tipo de retorno (Ctrl+Clique, pregui√ßoso).\nExemplo: NotasFiscais.Add.NFe : TNFe. Crie uma vari√°vel decente: var Nota: TNFe; Nota := ACBrNFe1.NotasFiscais.Add.NFe; Fez um .Add? Guarda o item: var Det: TDetCollectionItem; Det := Nota.Det.Add; D√™ nomes de gente pras vari√°veis.\nNada de a, b, obj, aux. Nomeie direito. Quebre o c√≥digo. C√≥digo bom √© aquele que at√© o estagi√°rio de marketing entende. Exemplo completo (sem pregui√ßa) uses ACBrNFe, ACBrNFeNotasFiscais; procedure TForm1.GerarNFeClara; var Nota: TNFe; Det: TDetCollectionItem; begin Nota := ACBrNFe1.NotasFiscais.Add.NFe; Nota.Ide.cNF := \u0026#39;12345678\u0026#39;; Nota.Ide.nNF := 2; Nota.Ide.tpAmb := taHomologacao; Nota.Ide.finNFe := fnNormal; Det := Nota.Det.Add; Det.nItem := 1; Det.Prod.cProd := \u0026#39;ABC123\u0026#39;; Det.Prod.xProd := \u0026#39;Produto Exemplo\u0026#39;; Det.Prod.qCom := 1.0000; Det.Prod.vUnCom := 100.00; Det.Imposto.ICMS.CST := cst00; Det.Imposto.ICMS.orig := oeNacional; end; Coice do Bruto: D√° mais trabalho? D√°.\nMas pelo menos voc√™ entende o que escreveu ‚Äî e n√£o parece que um estagi√°rio b√™bado codou isso. Checklist do Bruto para banir o with Declare vari√°veis decentes. Quebre cadeias longas. Nomeie as coisas direito. Fa√ßa o debug funcionar sem reza brava. E se algu√©m usar with no seu projeto\u0026hellip; refatora sem d√≥ e demita o respons√°vel. ‚ÄúMas Bruto, eu digito menos com with\u0026hellip;‚Äù E eu digito menos ainda se eu deletar seu c√≥digo inteiro.\nDigitar menos n√£o √© meta de programador.\nEntender o que escreveu √©.\nConclus√£o O with √© a muleta dos pregui√ßosos.\n√â o ‚Äújeitinho brasileiro‚Äù aplicado √† programa√ß√£o.\nQuer ser bom? Escreve direito. Quer ser r√°pido? Usa snippet.\nCoice do Bruto: Mas se continuar defendendo with, n√£o me chama pra dar manuten√ß√£o no seu c√≥digo, porque eu vou arrancar esse neg√≥cio de l√° nem que seja na marra.\nSe voc√™ √© do time with, √≥timo ‚Äî s√≥ n√£o me chame pra manuten√ß√£o. Se me chamar, eu vou l√° e arranco esse v√≠cio do seu c√≥digo sem d√≥. E se achou tudo isso uma besteira\u0026hellip;\nT√° bom tamb√©m.\nEu continuo dormindo bem e o with continua sendo uma bosta. üòé\n","permalink":"http://localhost:1313/pt/posts/pare-de-usar-with-no-delphi/","summary":"Um manifesto do Bruto do Delphi: por que o \u003ccode\u003ewith\u003c/code\u003e √© o capeta disfar√ßado de atalho.","title":"Pare de Usar With no Delphi"},{"content":"Rodando Delphi no WSL2 ‚Äî quando o Linux entra na sua m√°quina e o Windows s√≥ assiste L√° por 2025 eu resolvi encarar a ideia maluca de rodar Delphi no Linux sem sair do Windows.\n√â isso mesmo: um tal de WSL2 ‚Äî o ‚Äúsubsystem for linux‚Äù ‚Äî que deixa o pinguim morar dentro do Windows e ainda comer na mesma mesa. E pra minha surpresa, funciona. Ent√£o se prepara, porque eu vou te mostrar como eu fiz isso funcionar com o Ubuntu 22.04 (era o est√°vel quando escrevi este post). Se quando voc√™ estiver lendo isso o n√∫mero for outro (24.04, 26.04‚Ä¶), troca o nome na instala√ß√£o e segue o baile. 1. O que √© o tal do WSL O WSL √© basicamente um Linux domesticado, rodando dentro do Windows. N√£o √© VM, n√£o √© Docker ‚Äî √© r√°pido e pr√°tico. Voc√™ roda um comando e pronto: tem um Ubuntu te olhando feio.\n2. Instalando o Ubuntu (ou o que tiver no lugar dele) Abra o Prompt de Comando como administrador e rode:\n1 wsl --list --online Vai aparecer uma lista de distribui√ß√µes. Na √©poca eu usei Ubuntu 22.04, mas se j√° saiu 24.04, use ele. O nome muda, o processo √© o mesmo.\nPara instalar:\n1 wsl --install Ubuntu-22.04 O Windows baixa, instala e pede usu√°rio e senha. Escolha algo que voc√™ lembre, porque o Linux vai cobrar.\n3. Atualizando o sistema e instalando o que presta No Ubuntu, rode o b√°sico para atualizar os pacotes:\n1 sudo apt update \u0026amp;\u0026amp; sudo apt upgrade \u0026amp;\u0026amp; sudo apt dist-upgrade Depois instale as ferramentas de desenvolvimento que o Delphi precisa:\n1 sudo apt install joe wget p7zip-full curl openssh-server build-essential zlib1g-dev libcurl4-gnutls-dev libncurses5 zlib1g-dev libgtk-3-dev 4. Instalando o PAServer no WSL Copie o PAServer do Windows para dentro do WSL. No Delphi 12, o arquivo fica em algo como:\n1 C:\\\\Program Files (x86)\\\\Embarcadero\\\\Studio\\\\23.0\\\\PAServer\\\\LinuxPAServer23.0.tar.gz No Ubuntu, execute:\n1 2 cp /mnt/c/Program\\ Files\\ \\(x86\\)/Embarcadero/Studio/23.0/PAServer/LinuxPAServer23.0.tar.gz ~/ tar -xvf ./LinuxPAServer23.0.tar.gz Inicie o servidor:\n1 ./PAServer-23.0/paserver Ele pedir√° uma senha ‚Äî defina uma senha de verdade. Aqui n√£o tem ‚Äòdeixar tudo aberto‚Äô (laele). Seguran√ßa √© coisa s√©ria.\nDigite i e pressione Enter para ver o IP do PAServer. Anote.\n5. Configurando o Delphi para conversar com o WSL No Delphi do Windows, instale o FMXLinux via GetIt (se necess√°rio). Depois v√° em:\nTools \u0026gt; Options \u0026gt; Deployment \u0026gt; Connection Profile Manager Clique em Add e crie um perfil para Linux 64-bit. Informe o IP do PAServer, usu√°rio e senha definidos no Ubuntu, e Test Connection. 6. Adicionando o SDK Ainda no Delphi:\nTools \u0026gt; Options \u0026gt; Deployment \u0026gt; SDK Manager Clique em Add, escolha Linux 64-bit e selecione o perfil criado. O Delphi vai copiar um monte de arquivo para o WSL. Demora ‚Äî quando o bot√£o Cancel virar Close, terminou. 7. Compilando direto para Linux Crie um projeto Multi-Device Application e, no Project Manager, selecione Linux 64-bit. Se n√£o aparecer, adicione em Target Platforms.\nPressione F9. Se tudo estiver certo, o app sobe dentro do WSL.\n8. Conclus√£o Coice do Bruto: Pronto. Delphi no Windows, compilando para Linux no WSL.\n√â bonito? N√£o. √â pr√°tico? Depende. √â curioso? Bastante.\nSe der erro: confira IP, PAServer, SDK e firewall. Persistindo, reinicie ‚Äî √†s vezes o Windows s√≥ quer aten√ß√£o.\n‚ÄúSe t√° rodando, n√£o mexe. Se parou, o Windows estragou.‚Äù ‚Äî Bruto do Delphi\nCr√©dito: Este artigo foi escrito durante o Vivid Day da GDK,\rum dia em que os desenvolvedores recebem tempo dedicado para estudar, pesquisar\re produzir conte√∫do t√©cnico. Agrade√ßo √† empresa por apoiar iniciativas que fortalecem\ra comunidade t√©cnica.\r","permalink":"http://localhost:1313/posts/wsl-delphi/","summary":"Rodando Delphi no WSL2 ‚Äî quando o Linux entra na sua m√°quina e o Windows s√≥ assiste.","title":"Rodando Delphi no Linux"},{"content":"L√° por 2018, no Delphi 10.3 Rio, os engenheiros da Embarcadero resolveram ‚Äúmodernizar‚Äù o neg√≥cio e inventaram as vari√°veis inline.\nA ideia parece genial: declarar a vari√°vel ali, no exato ponto onde vai usar.\nNo papel √© bonito. Na pr√°tica, √© tipo botar farol de LED num fusca ‚Äî chama aten√ß√£o, mas n√£o resolve o problema.\nNeste post, eu te explico o que s√£o essas benditas vari√°veis inline, quando elas at√© fazem sentido, e por que, na minha opini√£o, qualquer coisa fora de um for √© receita de bagun√ßa.\nO que √© vari√°vel inline Desde os prim√≥rdios do Pascal, l√° da √©poca que a gente ainda usava disquete e o compilador cabia num disquete e meio, toda vari√°vel local era declarada no topo do m√©todo, antes do begin.\nEsse era o padr√£o: bonito, previs√≠vel e l√≥gico.\nA√≠ veio o Delphi 10.3 Rio e resolveu permitir isso aqui:\nprocedure Test; begin var i: Integer := 10; ShowMessage(i.ToString); end; Parece pr√°tico, n√©? E √© mesmo‚Ä¶ at√© o momento em que o c√≥digo come√ßa a crescer.\nA√≠ voc√™ vai ca√ßar onde est√° a vari√°vel, e descobre que algu√©m teve a brilhante ideia de declarar um var no meio de um if, outro dentro de um try, e outro l√° no fim do begin.\nPronto, virou merda.\nOs pr√≥s (pra n√£o dizer que eu s√≥ reclamo) O escopo fica mais curto: terminou o bloco, a vari√°vel morre. D√° pra declarar no ponto de uso, beleza. O compilador infere o tipo, ent√£o o c√≥digo fica menor. Evita vari√°veis zumbis que seguem vivas sem necessidade. Ok, tem sua utilidade. Mas a turma come√ßou a achar que isso √© desculpa pra jogar var em qualquer canto do c√≥digo. Os contras (e aqui come√ßa a bronca) Coice do Bruto: Fora do for, vira bagun√ßa generalizada.\nVoc√™ abre um m√©todo e tem var em cada esquina.\nO padr√£o do Delphi sempre foi simples: quer saber as vari√°veis? sobe l√° pro topo, antes do begin.\nAgora tem que sair ca√ßando var no meio do inferno. √Äs vezes nem tipo tem: var x := AlgumaFuncao(); ‚Äî a√≠ voc√™ precisa abrir a fun√ß√£o pra saber o que √© x. Manuten√ß√£o? Virou ca√ßa ao tesouro. C√≥digo grande com inline √© tipo novela ruim: parece que vai melhorar, mas s√≥ piora. Resumo: quem quer economizar tr√™s teclas acaba gastando meia hora pra entender o que o pr√≥prio c√≥digo faz.\nOpini√£o do Bruto Vari√°vel inline s√≥ faz sentido em dois lugares:\nDentro de um for, tipo for var i := 0 to 10 do. Em blocos pequenos, de prefer√™ncia com menos de meia tela. Fora disso, √© firula.\nQuer declarar no meio do m√©todo? Faz um favor pra humanidade e vai vender pamonha.\nQuem for dar manuten√ß√£o vai te xingar em tr√™s l√≠nguas diferentes, e com raz√£o.\nCoice do Bruto: No meu c√≥digo, vari√°vel √© tudo antes do begin.\nSe voc√™ precisar achar uma, vai l√° e t√° tudo ali, arrumadinho.\nIsso √© padr√£o, √© clareza, √© paz de esp√≠rito. Exemplo bom (aceit√°vel) for var Item in Lista do begin var Dobrado := Item * 2; ShowMessage(Dobrado.ToString); end; Curto, direto, limpo. Morreu dentro do loop, n√£o incomoda ningu√©m.\nExemplo ruim (zona total) procedure Calcula; begin var Total := 0; if Condicao then begin var Aux := SomaFuncao(); Total := Total + Aux; end; var Outro := OutraFuncao(); ShowMessage(Total.ToString + Outro.ToString); end; Onde foi declarada ‚ÄúOutro‚Äù? Qual o tipo dela? O que ela come?\nPra descobrir, s√≥ debugando.\nE o coitado que abrir isso daqui seis meses vai querer pular da janela.\nExemplo da desgra√ßa suprema (mesmo nome, tipos diferentes) procedure Teste; begin var Valor: Integer := 10; ShowMessage(\u0026#39;Valor inteiro: \u0026#39; + Valor.ToString); begin var Valor: String := \u0026#39;dez\u0026#39;; ShowMessage(\u0026#39;Valor string: \u0026#39; + Valor); end; ShowMessage(\u0026#39;Valor ainda √© inteiro: \u0026#39; + Valor.ToString); end; Olha que maravilha: duas vari√°veis com o mesmo nome, tipos diferentes, vivas em blocos diferentes.\nCompila feliz, mas quem ler isso vai pensar que o compilador enlouqueceu.\nVoc√™ acha que √© um Integer, mas dentro de um bloco virou String.\nDepois volta a ser Integer.\nIsso n√£o √© clareza ‚Äî isso √© transtorno de identidade de vari√°vel.\nConclus√£o Coice do Bruto: Vari√°veis inline √© igual makita na m√£o de crian√ßa: pode at√© funcionar, mas voc√™ sabe que vai dar merda e alguem vai sair chorando (e quem sabe com um dedo a menos).\nUse no for, use em bloco pequeno, mas n√£o espalha var pelo c√≥digo que nem confete no carnaval.\nO padr√£o do Delphi √© simples, bonito e testado h√° d√©cadas:\nvar tudo antes do begin.\nFoge disso e o c√≥digo vira um bingo de escopo.\nE se eu abrir seu c√≥digo e encontrar vari√°vel inline espalhada, j√° aviso:\neu vou arrancar tudo e botar o var l√° em cima, onde sempre deveria estar.\nNa marra, se for preciso.\n","permalink":"http://localhost:1313/pt/posts/variaveis-inline-no-delphi/","summary":"\u003cp\u003eL√° por 2018, no \u003cstrong\u003eDelphi 10.3 Rio\u003c/strong\u003e, os engenheiros da Embarcadero resolveram ‚Äúmodernizar‚Äù o neg√≥cio e inventaram as \u003cstrong\u003evari√°veis inline\u003c/strong\u003e.\u003cbr\u003e\nA ideia parece genial: declarar a vari√°vel ali, no exato ponto onde vai usar.\u003cbr\u003e\nNo papel √© bonito. Na pr√°tica, √© tipo botar farol de LED num fusca ‚Äî chama aten√ß√£o, mas n√£o resolve o problema.\u003c/p\u003e\n\u003cp\u003eNeste post, eu te explico o que s√£o essas benditas vari√°veis inline, quando elas at√© fazem sentido, e por que, na minha opini√£o, \u003cstrong\u003equalquer coisa fora de um \u003ccode\u003efor\u003c/code\u003e √© receita de bagun√ßa.\u003c/strong\u003e\u003c/p\u003e","title":"Vari√°veis inline ‚Äì para√≠so ou zona?"},{"content":" WITH √© coisa de programador pregui√ßoso Coice do Bruto: ‚ö†Ô∏è Aviso de utilidade p√∫blica:\nEste texto √© opinativo, mal humorado e cheio de verdade.\nSe voc√™ ama o with e acha que ele √© lindo, j√° pode apertar Ctrl+W e fechar essa aba.\nEu n√£o vou dormir menos, n√£o vou comer menos e n√£o vou te mandar flores.\nAgora, se voc√™ quer entender de verdade por que esse treco √© uma desgra√ßa no Delphi ‚Äî senta a√≠ e presta aten√ß√£o.\nOu ent√£o, veja esse artigo em v√≠deo O que √© esse tal de with e por que o povo usa O with √© aquele ‚Äúatalho m√°gico‚Äù que promete te poupar meia d√∫zia de teclas.\nO sujeito olha praquilo e pensa:\n‚ÄúNossa, que lindo! N√£o preciso digitar Memo1.Lines toda hora!‚Äù\nPois √©‚Ä¶ e depois n√£o entende por que o c√≥digo dele parece uma merda.\nO with serve pra:\n‚ÄúEncurtar‚Äù chamadas (tipo Memo1.Lines.Add). Preencher cole√ß√µes (tipo ACBrNFe1.NotasFiscais.Add). E serve tamb√©m pra bagun√ßar seu c√≥digo, confundir o depurador e te fazer parecer um pregui√ßoso.\nBonito, n√©?\nProblema #1 ‚Äî O with fode a leitura do seu c√≥digo Sabe aquele c√≥digo bonito que voc√™ l√™ e entende de primeira?\nPois √©, o with pega esse c√≥digo, limpa a bunda com ele e joga no lixo.\nExemplo cl√°ssico de pregui√ßa: with Memo1.Lines do begin Clear; Add(\u0026#39;Cap√≠tulo 1: ...\u0026#39;); Add(\u0026#39;Par√°grafo 2: ...\u0026#39;); Add(\u0026#39;Par√°grafo 3: ...\u0026#39;); end; O sujeito que escreveu isso acha que economizou tempo.\nEconomizou nada, s√≥ fodeu quem vai dar manuten√ß√£o.\nCoice do Bruto: Aqui cada linha grita quem √© o dono da a√ß√£o.\nN√£o tem charada, n√£o tem adivinha√ß√£o.\nO c√≥digo √© honesto ‚Äî coisa rara hoje em dia. Memo1.Lines.Clear; Memo1.Lines.Add(\u0026#39;Cap√≠tulo 1: ...\u0026#39;); Memo1.Lines.Add(\u0026#39;Par√°grafo 2: ...\u0026#39;); Memo1.Lines.Add(\u0026#39;Par√°grafo 3: ...\u0026#39;); Problema #2 ‚Äî Debug com with √© a mesma coisa que tentar achar agulha num palheiro\u0026hellip; s√≥ que o palheiro t√° pegando fogo Quer depurar um trecho que usa with?\nBoa sorte, babaca. O depurador olha pro seu c√≥digo e pensa:\n‚ÄúAmigo, eu n√£o fa√ßo ideia de quem √© esse objeto a√≠.‚Äù\nOlha essa desgra√ßa: with ACBrNFe1.NotasFiscais.Add.NFe do begin ide.cNF := \u0026#39;12345678\u0026#39;; end; Na hora de inspecionar ide.cNF, o compilador olha pra voc√™ e diz:\n‚ÄúN√£o sei quem √© ide, e sinceramente, tamb√©m n√£o quero saber.‚Äù\nA√≠ o cara tem que reconstruir toda a cadeia s√≥ pra ver um valorzinho.\nTudo isso porque quis ‚Äúdigitar menos‚Äù.\nParab√©ns, guerreiro do Ctrl+C Ctrl+V.\nProblema #3 ‚Äî Voc√™ nem sabe mais o que est√° alterando No with, voc√™ acha que est√° mexendo em um objeto, mas na verdade est√° atacando outro completamente diferente.\n√â o inferno em forma de sintaxe.\nO caos em pessoa: with Nota do begin with Det.Add do begin with Imposto do begin with ICMS do begin // Aqui ningu√©m sabe mais quem √© quem nesse caralho end; end; end; end; Quem l√™ um c√≥digo desses merece um aumento‚Ä¶ ou uma interna√ß√£o.\nCoice do Bruto: Aqui cada linha sabe quem √© o dono da bronca.\nE se der pau, o depurador sabe tamb√©m. var Nota: TNFe; Det: TDetCollectionItem; begin Nota := ACBrNFe1.NotasFiscais.Add.NFe; Det := Nota.Det.Add; Det.Imposto.ICMS.CST := cst00; Det.Imposto.ICMS.orig := oeNacional; end; Como largar o v√≠cio do with (passo a passo de desintoxica√ß√£o) Descubra o tipo de retorno (Ctrl+Clique, pregui√ßoso).\nExemplo: NotasFiscais.Add.NFe : TNFe. Crie uma vari√°vel decente: var Nota: TNFe; Nota := ACBrNFe1.NotasFiscais.Add.NFe; Fez um .Add? Guarda o item: var Det: TDetCollectionItem; Det := Nota.Det.Add; D√™ nomes de gente pras vari√°veis.\nNada de a, b, obj, aux. Nomeie direito. Quebre o c√≥digo. C√≥digo bom √© aquele que at√© o estagi√°rio de marketing entende. Exemplo completo (sem pregui√ßa) uses ACBrNFe, ACBrNFeNotasFiscais; procedure TForm1.GerarNFeClara; var Nota: TNFe; Det: TDetCollectionItem; begin Nota := ACBrNFe1.NotasFiscais.Add.NFe; Nota.Ide.cNF := \u0026#39;12345678\u0026#39;; Nota.Ide.nNF := 2; Nota.Ide.tpAmb := taHomologacao; Nota.Ide.finNFe := fnNormal; Det := Nota.Det.Add; Det.nItem := 1; Det.Prod.cProd := \u0026#39;ABC123\u0026#39;; Det.Prod.xProd := \u0026#39;Produto Exemplo\u0026#39;; Det.Prod.qCom := 1.0000; Det.Prod.vUnCom := 100.00; Det.Imposto.ICMS.CST := cst00; Det.Imposto.ICMS.orig := oeNacional; end; Coice do Bruto: D√° mais trabalho? D√°.\nMas pelo menos voc√™ entende o que escreveu ‚Äî e n√£o parece que um estagi√°rio b√™bado codou isso. Checklist do Bruto para banir o with Declare vari√°veis decentes. Quebre cadeias longas. Nomeie as coisas direito. Fa√ßa o debug funcionar sem reza brava. E se algu√©m usar with no seu projeto\u0026hellip; refatora sem d√≥ e demita o respons√°vel. ‚ÄúMas Bruto, eu digito menos com with\u0026hellip;‚Äù E eu digito menos ainda se eu deletar seu c√≥digo inteiro.\nDigitar menos n√£o √© meta de programador.\nEntender o que escreveu √©.\nConclus√£o O with √© a muleta dos pregui√ßosos.\n√â o ‚Äújeitinho brasileiro‚Äù aplicado √† programa√ß√£o.\nQuer ser bom? Escreve direito. Quer ser r√°pido? Usa snippet.\nCoice do Bruto: Mas se continuar defendendo with, n√£o me chama pra dar manuten√ß√£o no seu c√≥digo, porque eu vou arrancar esse neg√≥cio de l√° nem que seja na marra.\nSe voc√™ √© do time with, √≥timo ‚Äî s√≥ n√£o me chame pra manuten√ß√£o. Se me chamar, eu vou l√° e arranco esse v√≠cio do seu c√≥digo sem d√≥. E se achou tudo isso uma besteira\u0026hellip;\nT√° bom tamb√©m.\nEu continuo dormindo bem e o with continua sendo uma bosta. üòé\n","permalink":"http://localhost:1313/pt/posts/pare-de-usar-with-no-delphi/","summary":"Um manifesto do Bruto do Delphi: por que o \u003ccode\u003ewith\u003c/code\u003e √© o capeta disfar√ßado de atalho.","title":"Pare de Usar With no Delphi"},{"content":"Rodando Delphi no WSL2 ‚Äî quando o Linux entra na sua m√°quina e o Windows s√≥ assiste L√° por 2025 eu resolvi encarar a ideia maluca de rodar Delphi no Linux sem sair do Windows.\n√â isso mesmo: um tal de WSL2 ‚Äî o ‚Äúsubsystem for linux‚Äù ‚Äî que deixa o pinguim morar dentro do Windows e ainda comer na mesma mesa. E pra minha surpresa, funciona. Ent√£o se prepara, porque eu vou te mostrar como eu fiz isso funcionar com o Ubuntu 22.04 (era o est√°vel quando escrevi este post). Se quando voc√™ estiver lendo isso o n√∫mero for outro (24.04, 26.04‚Ä¶), troca o nome na instala√ß√£o e segue o baile. 1. O que √© o tal do WSL O WSL √© basicamente um Linux domesticado, rodando dentro do Windows. N√£o √© VM, n√£o √© Docker ‚Äî √© r√°pido e pr√°tico. Voc√™ roda um comando e pronto: tem um Ubuntu te olhando feio.\n2. Instalando o Ubuntu (ou o que tiver no lugar dele) Abra o Prompt de Comando como administrador e rode:\n1 wsl --list --online Vai aparecer uma lista de distribui√ß√µes. Na √©poca eu usei Ubuntu 22.04, mas se j√° saiu 24.04, use ele. O nome muda, o processo √© o mesmo.\nPara instalar:\n1 wsl --install Ubuntu-22.04 O Windows baixa, instala e pede usu√°rio e senha. Escolha algo que voc√™ lembre, porque o Linux vai cobrar.\n3. Atualizando o sistema e instalando o que presta No Ubuntu, rode o b√°sico para atualizar os pacotes:\n1 sudo apt update \u0026amp;\u0026amp; sudo apt upgrade \u0026amp;\u0026amp; sudo apt dist-upgrade Depois instale as ferramentas de desenvolvimento que o Delphi precisa:\n1 sudo apt install joe wget p7zip-full curl openssh-server build-essential zlib1g-dev libcurl4-gnutls-dev libncurses5 zlib1g-dev libgtk-3-dev 4. Instalando o PAServer no WSL Copie o PAServer do Windows para dentro do WSL. No Delphi 12, o arquivo fica em algo como:\n1 C:\\\\Program Files (x86)\\\\Embarcadero\\\\Studio\\\\23.0\\\\PAServer\\\\LinuxPAServer23.0.tar.gz No Ubuntu, execute:\n1 2 cp /mnt/c/Program\\ Files\\ \\(x86\\)/Embarcadero/Studio/23.0/PAServer/LinuxPAServer23.0.tar.gz ~/ tar -xvf ./LinuxPAServer23.0.tar.gz Inicie o servidor:\n1 ./PAServer-23.0/paserver Ele pedir√° uma senha ‚Äî defina uma senha de verdade. Aqui n√£o tem ‚Äòdeixar tudo aberto‚Äô (laele). Seguran√ßa √© coisa s√©ria.\nDigite i e pressione Enter para ver o IP do PAServer. Anote.\n5. Configurando o Delphi para conversar com o WSL No Delphi do Windows, instale o FMXLinux via GetIt (se necess√°rio). Depois v√° em:\nTools \u0026gt; Options \u0026gt; Deployment \u0026gt; Connection Profile Manager Clique em Add e crie um perfil para Linux 64-bit. Informe o IP do PAServer, usu√°rio e senha definidos no Ubuntu, e Test Connection. 6. Adicionando o SDK Ainda no Delphi:\nTools \u0026gt; Options \u0026gt; Deployment \u0026gt; SDK Manager Clique em Add, escolha Linux 64-bit e selecione o perfil criado. O Delphi vai copiar um monte de arquivo para o WSL. Demora ‚Äî quando o bot√£o Cancel virar Close, terminou. 7. Compilando direto para Linux Crie um projeto Multi-Device Application e, no Project Manager, selecione Linux 64-bit. Se n√£o aparecer, adicione em Target Platforms.\nPressione F9. Se tudo estiver certo, o app sobe dentro do WSL.\n8. Conclus√£o Coice do Bruto: Pronto. Delphi no Windows, compilando para Linux no WSL.\n√â bonito? N√£o. √â pr√°tico? Depende. √â curioso? Bastante.\nSe der erro: confira IP, PAServer, SDK e firewall. Persistindo, reinicie ‚Äî √†s vezes o Windows s√≥ quer aten√ß√£o.\n‚ÄúSe t√° rodando, n√£o mexe. Se parou, o Windows estragou.‚Äù ‚Äî Bruto do Delphi\nCr√©dito: Este artigo foi escrito durante o Vivid Day da GDK,\rum dia em que os desenvolvedores recebem tempo dedicado para estudar, pesquisar\re produzir conte√∫do t√©cnico. Agrade√ßo √† empresa por apoiar iniciativas que fortalecem\ra comunidade t√©cnica.\r","permalink":"http://localhost:1313/posts/wsl-delphi/","summary":"Rodando Delphi no WSL2 ‚Äî quando o Linux entra na sua m√°quina e o Windows s√≥ assiste.","title":"Rodando Delphi no Linux"},{"content":"L√° por 2018, no Delphi 10.3 Rio, os engenheiros da Embarcadero resolveram ‚Äúmodernizar‚Äù o neg√≥cio e inventaram as vari√°veis inline.\nA ideia parece genial: declarar a vari√°vel ali, no exato ponto onde vai usar.\nNo papel √© bonito. Na pr√°tica, √© tipo botar farol de LED num fusca ‚Äî chama aten√ß√£o, mas n√£o resolve o problema.\nNeste post, eu te explico o que s√£o essas benditas vari√°veis inline, quando elas at√© fazem sentido, e por que, na minha opini√£o, qualquer coisa fora de um for √© receita de bagun√ßa.\nO que √© vari√°vel inline Desde os prim√≥rdios do Pascal, l√° da √©poca que a gente ainda usava disquete e o compilador cabia num disquete e meio, toda vari√°vel local era declarada no topo do m√©todo, antes do begin.\nEsse era o padr√£o: bonito, previs√≠vel e l√≥gico.\nA√≠ veio o Delphi 10.3 Rio e resolveu permitir isso aqui:\nprocedure Test; begin var i: Integer := 10; ShowMessage(i.ToString); end; Parece pr√°tico, n√©? E √© mesmo‚Ä¶ at√© o momento em que o c√≥digo come√ßa a crescer.\nA√≠ voc√™ vai ca√ßar onde est√° a vari√°vel, e descobre que algu√©m teve a brilhante ideia de declarar um var no meio de um if, outro dentro de um try, e outro l√° no fim do begin.\nPronto, virou merda.\nOs pr√≥s (pra n√£o dizer que eu s√≥ reclamo) O escopo fica mais curto: terminou o bloco, a vari√°vel morre. D√° pra declarar no ponto de uso, beleza. O compilador infere o tipo, ent√£o o c√≥digo fica menor. Evita vari√°veis zumbis que seguem vivas sem necessidade. Ok, tem sua utilidade. Mas a turma come√ßou a achar que isso √© desculpa pra jogar var em qualquer canto do c√≥digo. Os contras (e aqui come√ßa a bronca) Coice do Bruto: Fora do for, vira bagun√ßa generalizada.\nVoc√™ abre um m√©todo e tem var em cada esquina.\nO padr√£o do Delphi sempre foi simples: quer saber as vari√°veis? sobe l√° pro topo, antes do begin.\nAgora tem que sair ca√ßando var no meio do inferno. √Äs vezes nem tipo tem: var x := AlgumaFuncao(); ‚Äî a√≠ voc√™ precisa abrir a fun√ß√£o pra saber o que √© x. Manuten√ß√£o? Virou ca√ßa ao tesouro. C√≥digo grande com inline √© tipo novela ruim: parece que vai melhorar, mas s√≥ piora. Resumo: quem quer economizar tr√™s teclas acaba gastando meia hora pra entender o que o pr√≥prio c√≥digo faz.\nOpini√£o do Bruto Vari√°vel inline s√≥ faz sentido em dois lugares:\nDentro de um for, tipo for var i := 0 to 10 do. Em blocos pequenos, de prefer√™ncia com menos de meia tela. Fora disso, √© firula.\nQuer declarar no meio do m√©todo? Faz um favor pra humanidade e vai vender pamonha.\nQuem for dar manuten√ß√£o vai te xingar em tr√™s l√≠nguas diferentes, e com raz√£o.\nCoice do Bruto: No meu c√≥digo, vari√°vel √© tudo antes do begin.\nSe voc√™ precisar achar uma, vai l√° e t√° tudo ali, arrumadinho.\nIsso √© padr√£o, √© clareza, √© paz de esp√≠rito. Exemplo bom (aceit√°vel) for var Item in Lista do begin var Dobrado := Item * 2; ShowMessage(Dobrado.ToString); end; Curto, direto, limpo. Morreu dentro do loop, n√£o incomoda ningu√©m.\nExemplo ruim (zona total) procedure Calcula; begin var Total := 0; if Condicao then begin var Aux := SomaFuncao(); Total := Total + Aux; end; var Outro := OutraFuncao(); ShowMessage(Total.ToString + Outro.ToString); end; Onde foi declarada ‚ÄúOutro‚Äù? Qual o tipo dela? O que ela come?\nPra descobrir, s√≥ debugando.\nE o coitado que abrir isso daqui seis meses vai querer pular da janela.\nExemplo da desgra√ßa suprema (mesmo nome, tipos diferentes) procedure Teste; begin var Valor: Integer := 10; ShowMessage(\u0026#39;Valor inteiro: \u0026#39; + Valor.ToString); begin var Valor: String := \u0026#39;dez\u0026#39;; ShowMessage(\u0026#39;Valor string: \u0026#39; + Valor); end; ShowMessage(\u0026#39;Valor ainda √© inteiro: \u0026#39; + Valor.ToString); end; Olha que maravilha: duas vari√°veis com o mesmo nome, tipos diferentes, vivas em blocos diferentes.\nCompila feliz, mas quem ler isso vai pensar que o compilador enlouqueceu.\nVoc√™ acha que √© um Integer, mas dentro de um bloco virou String.\nDepois volta a ser Integer.\nIsso n√£o √© clareza ‚Äî isso √© transtorno de identidade de vari√°vel.\nConclus√£o Coice do Bruto: Vari√°veis inline √© igual makita na m√£o de crian√ßa: pode at√© funcionar, mas voc√™ sabe que vai dar merda e alguem vai sair chorando (e quem sabe com um dedo a menos).\nUse no for, use em bloco pequeno, mas n√£o espalha var pelo c√≥digo que nem confete no carnaval.\nO padr√£o do Delphi √© simples, bonito e testado h√° d√©cadas:\nvar tudo antes do begin.\nFoge disso e o c√≥digo vira um bingo de escopo.\nE se eu abrir seu c√≥digo e encontrar vari√°vel inline espalhada, j√° aviso:\neu vou arrancar tudo e botar o var l√° em cima, onde sempre deveria estar.\nNa marra, se for preciso.\n","permalink":"http://localhost:1313/pt/posts/variaveis-inline-no-delphi/","summary":"\u003cp\u003eL√° por 2018, no \u003cstrong\u003eDelphi 10.3 Rio\u003c/strong\u003e, os engenheiros da Embarcadero resolveram ‚Äúmodernizar‚Äù o neg√≥cio e inventaram as \u003cstrong\u003evari√°veis inline\u003c/strong\u003e.\u003cbr\u003e\nA ideia parece genial: declarar a vari√°vel ali, no exato ponto onde vai usar.\u003cbr\u003e\nNo papel √© bonito. Na pr√°tica, √© tipo botar farol de LED num fusca ‚Äî chama aten√ß√£o, mas n√£o resolve o problema.\u003c/p\u003e\n\u003cp\u003eNeste post, eu te explico o que s√£o essas benditas vari√°veis inline, quando elas at√© fazem sentido, e por que, na minha opini√£o, \u003cstrong\u003equalquer coisa fora de um \u003ccode\u003efor\u003c/code\u003e √© receita de bagun√ßa.\u003c/strong\u003e\u003c/p\u003e","title":"Vari√°veis inline ‚Äì para√≠so ou zona?"},{"content":" WITH √© coisa de programador pregui√ßoso Coice do Bruto: ‚ö†Ô∏è Aviso de utilidade p√∫blica:\nEste texto √© opinativo, mal humorado e cheio de verdade.\nSe voc√™ ama o with e acha que ele √© lindo, j√° pode apertar Ctrl+W e fechar essa aba.\nEu n√£o vou dormir menos, n√£o vou comer menos e n√£o vou te mandar flores.\nAgora, se voc√™ quer entender de verdade por que esse treco √© uma desgra√ßa no Delphi ‚Äî senta a√≠ e presta aten√ß√£o.\nOu ent√£o, veja esse artigo em v√≠deo O que √© esse tal de with e por que o povo usa O with √© aquele ‚Äúatalho m√°gico‚Äù que promete te poupar meia d√∫zia de teclas.\nO sujeito olha praquilo e pensa:\n‚ÄúNossa, que lindo! N√£o preciso digitar Memo1.Lines toda hora!‚Äù\nPois √©‚Ä¶ e depois n√£o entende por que o c√≥digo dele parece uma merda.\nO with serve pra:\n‚ÄúEncurtar‚Äù chamadas (tipo Memo1.Lines.Add). Preencher cole√ß√µes (tipo ACBrNFe1.NotasFiscais.Add). E serve tamb√©m pra bagun√ßar seu c√≥digo, confundir o depurador e te fazer parecer um pregui√ßoso.\nBonito, n√©?\nProblema #1 ‚Äî O with fode a leitura do seu c√≥digo Sabe aquele c√≥digo bonito que voc√™ l√™ e entende de primeira?\nPois √©, o with pega esse c√≥digo, limpa a bunda com ele e joga no lixo.\nExemplo cl√°ssico de pregui√ßa: with Memo1.Lines do begin Clear; Add(\u0026#39;Cap√≠tulo 1: ...\u0026#39;); Add(\u0026#39;Par√°grafo 2: ...\u0026#39;); Add(\u0026#39;Par√°grafo 3: ...\u0026#39;); end; O sujeito que escreveu isso acha que economizou tempo.\nEconomizou nada, s√≥ fodeu quem vai dar manuten√ß√£o.\nCoice do Bruto: Aqui cada linha grita quem √© o dono da a√ß√£o.\nN√£o tem charada, n√£o tem adivinha√ß√£o.\nO c√≥digo √© honesto ‚Äî coisa rara hoje em dia. Memo1.Lines.Clear; Memo1.Lines.Add(\u0026#39;Cap√≠tulo 1: ...\u0026#39;); Memo1.Lines.Add(\u0026#39;Par√°grafo 2: ...\u0026#39;); Memo1.Lines.Add(\u0026#39;Par√°grafo 3: ...\u0026#39;); Problema #2 ‚Äî Debug com with √© a mesma coisa que tentar achar agulha num palheiro\u0026hellip; s√≥ que o palheiro t√° pegando fogo Quer depurar um trecho que usa with?\nBoa sorte, babaca. O depurador olha pro seu c√≥digo e pensa:\n‚ÄúAmigo, eu n√£o fa√ßo ideia de quem √© esse objeto a√≠.‚Äù\nOlha essa desgra√ßa: with ACBrNFe1.NotasFiscais.Add.NFe do begin ide.cNF := \u0026#39;12345678\u0026#39;; end; Na hora de inspecionar ide.cNF, o compilador olha pra voc√™ e diz:\n‚ÄúN√£o sei quem √© ide, e sinceramente, tamb√©m n√£o quero saber.‚Äù\nA√≠ o cara tem que reconstruir toda a cadeia s√≥ pra ver um valorzinho.\nTudo isso porque quis ‚Äúdigitar menos‚Äù.\nParab√©ns, guerreiro do Ctrl+C Ctrl+V.\nProblema #3 ‚Äî Voc√™ nem sabe mais o que est√° alterando No with, voc√™ acha que est√° mexendo em um objeto, mas na verdade est√° atacando outro completamente diferente.\n√â o inferno em forma de sintaxe.\nO caos em pessoa: with Nota do begin with Det.Add do begin with Imposto do begin with ICMS do begin // Aqui ningu√©m sabe mais quem √© quem nesse caralho end; end; end; end; Quem l√™ um c√≥digo desses merece um aumento‚Ä¶ ou uma interna√ß√£o.\nCoice do Bruto: Aqui cada linha sabe quem √© o dono da bronca.\nE se der pau, o depurador sabe tamb√©m. var Nota: TNFe; Det: TDetCollectionItem; begin Nota := ACBrNFe1.NotasFiscais.Add.NFe; Det := Nota.Det.Add; Det.Imposto.ICMS.CST := cst00; Det.Imposto.ICMS.orig := oeNacional; end; Como largar o v√≠cio do with (passo a passo de desintoxica√ß√£o) Descubra o tipo de retorno (Ctrl+Clique, pregui√ßoso).\nExemplo: NotasFiscais.Add.NFe : TNFe. Crie uma vari√°vel decente: var Nota: TNFe; Nota := ACBrNFe1.NotasFiscais.Add.NFe; Fez um .Add? Guarda o item: var Det: TDetCollectionItem; Det := Nota.Det.Add; D√™ nomes de gente pras vari√°veis.\nNada de a, b, obj, aux. Nomeie direito. Quebre o c√≥digo. C√≥digo bom √© aquele que at√© o estagi√°rio de marketing entende. Exemplo completo (sem pregui√ßa) uses ACBrNFe, ACBrNFeNotasFiscais; procedure TForm1.GerarNFeClara; var Nota: TNFe; Det: TDetCollectionItem; begin Nota := ACBrNFe1.NotasFiscais.Add.NFe; Nota.Ide.cNF := \u0026#39;12345678\u0026#39;; Nota.Ide.nNF := 2; Nota.Ide.tpAmb := taHomologacao; Nota.Ide.finNFe := fnNormal; Det := Nota.Det.Add; Det.nItem := 1; Det.Prod.cProd := \u0026#39;ABC123\u0026#39;; Det.Prod.xProd := \u0026#39;Produto Exemplo\u0026#39;; Det.Prod.qCom := 1.0000; Det.Prod.vUnCom := 100.00; Det.Imposto.ICMS.CST := cst00; Det.Imposto.ICMS.orig := oeNacional; end; Coice do Bruto: D√° mais trabalho? D√°.\nMas pelo menos voc√™ entende o que escreveu ‚Äî e n√£o parece que um estagi√°rio b√™bado codou isso. Checklist do Bruto para banir o with Declare vari√°veis decentes. Quebre cadeias longas. Nomeie as coisas direito. Fa√ßa o debug funcionar sem reza brava. E se algu√©m usar with no seu projeto\u0026hellip; refatora sem d√≥ e demita o respons√°vel. ‚ÄúMas Bruto, eu digito menos com with\u0026hellip;‚Äù E eu digito menos ainda se eu deletar seu c√≥digo inteiro.\nDigitar menos n√£o √© meta de programador.\nEntender o que escreveu √©.\nConclus√£o O with √© a muleta dos pregui√ßosos.\n√â o ‚Äújeitinho brasileiro‚Äù aplicado √† programa√ß√£o.\nQuer ser bom? Escreve direito. Quer ser r√°pido? Usa snippet.\nCoice do Bruto: Mas se continuar defendendo with, n√£o me chama pra dar manuten√ß√£o no seu c√≥digo, porque eu vou arrancar esse neg√≥cio de l√° nem que seja na marra.\nSe voc√™ √© do time with, √≥timo ‚Äî s√≥ n√£o me chame pra manuten√ß√£o. Se me chamar, eu vou l√° e arranco esse v√≠cio do seu c√≥digo sem d√≥. E se achou tudo isso uma besteira\u0026hellip;\nT√° bom tamb√©m.\nEu continuo dormindo bem e o with continua sendo uma bosta. üòé\n","permalink":"http://localhost:1313/pt/posts/pare-de-usar-with-no-delphi/","summary":"Um manifesto do Bruto do Delphi: por que o \u003ccode\u003ewith\u003c/code\u003e √© o capeta disfar√ßado de atalho.","title":"Pare de Usar With no Delphi"},{"content":"Rodando Delphi no WSL2 ‚Äî quando o Linux entra na sua m√°quina e o Windows s√≥ assiste L√° por 2025 eu resolvi encarar a ideia maluca de rodar Delphi no Linux sem sair do Windows.\n√â isso mesmo: um tal de WSL2 ‚Äî o ‚Äúsubsystem for linux‚Äù ‚Äî que deixa o pinguim morar dentro do Windows e ainda comer na mesma mesa. E pra minha surpresa, funciona. Ent√£o se prepara, porque eu vou te mostrar como eu fiz isso funcionar com o Ubuntu 22.04 (era o est√°vel quando escrevi este post). Se quando voc√™ estiver lendo isso o n√∫mero for outro (24.04, 26.04‚Ä¶), troca o nome na instala√ß√£o e segue o baile. 1. O que √© o tal do WSL O WSL √© basicamente um Linux domesticado, rodando dentro do Windows. N√£o √© VM, n√£o √© Docker ‚Äî √© r√°pido e pr√°tico. Voc√™ roda um comando e pronto: tem um Ubuntu te olhando feio.\n2. Instalando o Ubuntu (ou o que tiver no lugar dele) Abra o Prompt de Comando como administrador e rode:\n1 wsl --list --online Vai aparecer uma lista de distribui√ß√µes. Na √©poca eu usei Ubuntu 22.04, mas se j√° saiu 24.04, use ele. O nome muda, o processo √© o mesmo.\nPara instalar:\n1 wsl --install Ubuntu-22.04 O Windows baixa, instala e pede usu√°rio e senha. Escolha algo que voc√™ lembre, porque o Linux vai cobrar.\n3. Atualizando o sistema e instalando o que presta No Ubuntu, rode o b√°sico para atualizar os pacotes:\n1 sudo apt update \u0026amp;\u0026amp; sudo apt upgrade \u0026amp;\u0026amp; sudo apt dist-upgrade Depois instale as ferramentas de desenvolvimento que o Delphi precisa:\n1 sudo apt install joe wget p7zip-full curl openssh-server build-essential zlib1g-dev libcurl4-gnutls-dev libncurses5 zlib1g-dev libgtk-3-dev 4. Instalando o PAServer no WSL Copie o PAServer do Windows para dentro do WSL. No Delphi 12, o arquivo fica em algo como:\n1 C:\\\\Program Files (x86)\\\\Embarcadero\\\\Studio\\\\23.0\\\\PAServer\\\\LinuxPAServer23.0.tar.gz No Ubuntu, execute:\n1 2 cp /mnt/c/Program\\ Files\\ \\(x86\\)/Embarcadero/Studio/23.0/PAServer/LinuxPAServer23.0.tar.gz ~/ tar -xvf ./LinuxPAServer23.0.tar.gz Inicie o servidor:\n1 ./PAServer-23.0/paserver Ele pedir√° uma senha ‚Äî defina uma senha de verdade. Aqui n√£o tem ‚Äòdeixar tudo aberto‚Äô (laele). Seguran√ßa √© coisa s√©ria.\nDigite i e pressione Enter para ver o IP do PAServer. Anote.\n5. Configurando o Delphi para conversar com o WSL No Delphi do Windows, instale o FMXLinux via GetIt (se necess√°rio). Depois v√° em:\nTools \u0026gt; Options \u0026gt; Deployment \u0026gt; Connection Profile Manager Clique em Add e crie um perfil para Linux 64-bit. Informe o IP do PAServer, usu√°rio e senha definidos no Ubuntu, e Test Connection. 6. Adicionando o SDK Ainda no Delphi:\nTools \u0026gt; Options \u0026gt; Deployment \u0026gt; SDK Manager Clique em Add, escolha Linux 64-bit e selecione o perfil criado. O Delphi vai copiar um monte de arquivo para o WSL. Demora ‚Äî quando o bot√£o Cancel virar Close, terminou. 7. Compilando direto para Linux Crie um projeto Multi-Device Application e, no Project Manager, selecione Linux 64-bit. Se n√£o aparecer, adicione em Target Platforms.\nPressione F9. Se tudo estiver certo, o app sobe dentro do WSL.\n8. Conclus√£o Coice do Bruto: Pronto. Delphi no Windows, compilando para Linux no WSL.\n√â bonito? N√£o. √â pr√°tico? Depende. √â curioso? Bastante.\nSe der erro: confira IP, PAServer, SDK e firewall. Persistindo, reinicie ‚Äî √†s vezes o Windows s√≥ quer aten√ß√£o.\n‚ÄúSe t√° rodando, n√£o mexe. Se parou, o Windows estragou.‚Äù ‚Äî Bruto do Delphi\nCr√©dito: Este artigo foi escrito durante o Vivid Day da GDK,\rum dia em que os desenvolvedores recebem tempo dedicado para estudar, pesquisar\re produzir conte√∫do t√©cnico. Agrade√ßo √† empresa por apoiar iniciativas que fortalecem\ra comunidade t√©cnica.\r","permalink":"http://localhost:1313/posts/wsl-delphi/","summary":"Rodando Delphi no WSL2 ‚Äî quando o Linux entra na sua m√°quina e o Windows s√≥ assiste.","title":"Rodando Delphi no Linux"},{"content":"L√° por 2018, no Delphi 10.3 Rio, os engenheiros da Embarcadero resolveram ‚Äúmodernizar‚Äù o neg√≥cio e inventaram as vari√°veis inline.\nA ideia parece genial: declarar a vari√°vel ali, no exato ponto onde vai usar.\nNo papel √© bonito. Na pr√°tica, √© tipo botar farol de LED num fusca ‚Äî chama aten√ß√£o, mas n√£o resolve o problema.\nNeste post, eu te explico o que s√£o essas benditas vari√°veis inline, quando elas at√© fazem sentido, e por que, na minha opini√£o, qualquer coisa fora de um for √© receita de bagun√ßa.\nO que √© vari√°vel inline Desde os prim√≥rdios do Pascal, l√° da √©poca que a gente ainda usava disquete e o compilador cabia num disquete e meio, toda vari√°vel local era declarada no topo do m√©todo, antes do begin.\nEsse era o padr√£o: bonito, previs√≠vel e l√≥gico.\nA√≠ veio o Delphi 10.3 Rio e resolveu permitir isso aqui:\nprocedure Test; begin var i: Integer := 10; ShowMessage(i.ToString); end; Parece pr√°tico, n√©? E √© mesmo‚Ä¶ at√© o momento em que o c√≥digo come√ßa a crescer.\nA√≠ voc√™ vai ca√ßar onde est√° a vari√°vel, e descobre que algu√©m teve a brilhante ideia de declarar um var no meio de um if, outro dentro de um try, e outro l√° no fim do begin.\nPronto, virou merda.\nOs pr√≥s (pra n√£o dizer que eu s√≥ reclamo) O escopo fica mais curto: terminou o bloco, a vari√°vel morre. D√° pra declarar no ponto de uso, beleza. O compilador infere o tipo, ent√£o o c√≥digo fica menor. Evita vari√°veis zumbis que seguem vivas sem necessidade. Ok, tem sua utilidade. Mas a turma come√ßou a achar que isso √© desculpa pra jogar var em qualquer canto do c√≥digo. Os contras (e aqui come√ßa a bronca) Coice do Bruto: Fora do for, vira bagun√ßa generalizada.\nVoc√™ abre um m√©todo e tem var em cada esquina.\nO padr√£o do Delphi sempre foi simples: quer saber as vari√°veis? sobe l√° pro topo, antes do begin.\nAgora tem que sair ca√ßando var no meio do inferno. √Äs vezes nem tipo tem: var x := AlgumaFuncao(); ‚Äî a√≠ voc√™ precisa abrir a fun√ß√£o pra saber o que √© x. Manuten√ß√£o? Virou ca√ßa ao tesouro. C√≥digo grande com inline √© tipo novela ruim: parece que vai melhorar, mas s√≥ piora. Resumo: quem quer economizar tr√™s teclas acaba gastando meia hora pra entender o que o pr√≥prio c√≥digo faz.\nOpini√£o do Bruto Vari√°vel inline s√≥ faz sentido em dois lugares:\nDentro de um for, tipo for var i := 0 to 10 do. Em blocos pequenos, de prefer√™ncia com menos de meia tela. Fora disso, √© firula.\nQuer declarar no meio do m√©todo? Faz um favor pra humanidade e vai vender pamonha.\nQuem for dar manuten√ß√£o vai te xingar em tr√™s l√≠nguas diferentes, e com raz√£o.\nCoice do Bruto: No meu c√≥digo, vari√°vel √© tudo antes do begin.\nSe voc√™ precisar achar uma, vai l√° e t√° tudo ali, arrumadinho.\nIsso √© padr√£o, √© clareza, √© paz de esp√≠rito. Exemplo bom (aceit√°vel) for var Item in Lista do begin var Dobrado := Item * 2; ShowMessage(Dobrado.ToString); end; Curto, direto, limpo. Morreu dentro do loop, n√£o incomoda ningu√©m.\nExemplo ruim (zona total) procedure Calcula; begin var Total := 0; if Condicao then begin var Aux := SomaFuncao(); Total := Total + Aux; end; var Outro := OutraFuncao(); ShowMessage(Total.ToString + Outro.ToString); end; Onde foi declarada ‚ÄúOutro‚Äù? Qual o tipo dela? O que ela come?\nPra descobrir, s√≥ debugando.\nE o coitado que abrir isso daqui seis meses vai querer pular da janela.\nExemplo da desgra√ßa suprema (mesmo nome, tipos diferentes) procedure Teste; begin var Valor: Integer := 10; ShowMessage(\u0026#39;Valor inteiro: \u0026#39; + Valor.ToString); begin var Valor: String := \u0026#39;dez\u0026#39;; ShowMessage(\u0026#39;Valor string: \u0026#39; + Valor); end; ShowMessage(\u0026#39;Valor ainda √© inteiro: \u0026#39; + Valor.ToString); end; Olha que maravilha: duas vari√°veis com o mesmo nome, tipos diferentes, vivas em blocos diferentes.\nCompila feliz, mas quem ler isso vai pensar que o compilador enlouqueceu.\nVoc√™ acha que √© um Integer, mas dentro de um bloco virou String.\nDepois volta a ser Integer.\nIsso n√£o √© clareza ‚Äî isso √© transtorno de identidade de vari√°vel.\nConclus√£o Coice do Bruto: Vari√°veis inline √© igual makita na m√£o de crian√ßa: pode at√© funcionar, mas voc√™ sabe que vai dar merda e alguem vai sair chorando (e quem sabe com um dedo a menos).\nUse no for, use em bloco pequeno, mas n√£o espalha var pelo c√≥digo que nem confete no carnaval.\nO padr√£o do Delphi √© simples, bonito e testado h√° d√©cadas:\nvar tudo antes do begin.\nFoge disso e o c√≥digo vira um bingo de escopo.\nE se eu abrir seu c√≥digo e encontrar vari√°vel inline espalhada, j√° aviso:\neu vou arrancar tudo e botar o var l√° em cima, onde sempre deveria estar.\nNa marra, se for preciso.\n","permalink":"http://localhost:1313/pt/posts/variaveis-inline-no-delphi/","summary":"\u003cp\u003eL√° por 2018, no \u003cstrong\u003eDelphi 10.3 Rio\u003c/strong\u003e, os engenheiros da Embarcadero resolveram ‚Äúmodernizar‚Äù o neg√≥cio e inventaram as \u003cstrong\u003evari√°veis inline\u003c/strong\u003e.\u003cbr\u003e\nA ideia parece genial: declarar a vari√°vel ali, no exato ponto onde vai usar.\u003cbr\u003e\nNo papel √© bonito. Na pr√°tica, √© tipo botar farol de LED num fusca ‚Äî chama aten√ß√£o, mas n√£o resolve o problema.\u003c/p\u003e\n\u003cp\u003eNeste post, eu te explico o que s√£o essas benditas vari√°veis inline, quando elas at√© fazem sentido, e por que, na minha opini√£o, \u003cstrong\u003equalquer coisa fora de um \u003ccode\u003efor\u003c/code\u003e √© receita de bagun√ßa.\u003c/strong\u003e\u003c/p\u003e","title":"Vari√°veis inline ‚Äì para√≠so ou zona?"},{"content":" WITH √© coisa de programador pregui√ßoso Coice do Bruto: ‚ö†Ô∏è Aviso de utilidade p√∫blica:\nEste texto √© opinativo, mal humorado e cheio de verdade.\nSe voc√™ ama o with e acha que ele √© lindo, j√° pode apertar Ctrl+W e fechar essa aba.\nEu n√£o vou dormir menos, n√£o vou comer menos e n√£o vou te mandar flores.\nAgora, se voc√™ quer entender de verdade por que esse treco √© uma desgra√ßa no Delphi ‚Äî senta a√≠ e presta aten√ß√£o.\nOu ent√£o, veja esse artigo em v√≠deo O que √© esse tal de with e por que o povo usa O with √© aquele ‚Äúatalho m√°gico‚Äù que promete te poupar meia d√∫zia de teclas.\nO sujeito olha praquilo e pensa:\n‚ÄúNossa, que lindo! N√£o preciso digitar Memo1.Lines toda hora!‚Äù\nPois √©‚Ä¶ e depois n√£o entende por que o c√≥digo dele parece uma merda.\nO with serve pra:\n‚ÄúEncurtar‚Äù chamadas (tipo Memo1.Lines.Add). Preencher cole√ß√µes (tipo ACBrNFe1.NotasFiscais.Add). E serve tamb√©m pra bagun√ßar seu c√≥digo, confundir o depurador e te fazer parecer um pregui√ßoso.\nBonito, n√©?\nProblema #1 ‚Äî O with fode a leitura do seu c√≥digo Sabe aquele c√≥digo bonito que voc√™ l√™ e entende de primeira?\nPois √©, o with pega esse c√≥digo, limpa a bunda com ele e joga no lixo.\nExemplo cl√°ssico de pregui√ßa: with Memo1.Lines do begin Clear; Add(\u0026#39;Cap√≠tulo 1: ...\u0026#39;); Add(\u0026#39;Par√°grafo 2: ...\u0026#39;); Add(\u0026#39;Par√°grafo 3: ...\u0026#39;); end; O sujeito que escreveu isso acha que economizou tempo.\nEconomizou nada, s√≥ fodeu quem vai dar manuten√ß√£o.\nCoice do Bruto: Aqui cada linha grita quem √© o dono da a√ß√£o.\nN√£o tem charada, n√£o tem adivinha√ß√£o.\nO c√≥digo √© honesto ‚Äî coisa rara hoje em dia. Memo1.Lines.Clear; Memo1.Lines.Add(\u0026#39;Cap√≠tulo 1: ...\u0026#39;); Memo1.Lines.Add(\u0026#39;Par√°grafo 2: ...\u0026#39;); Memo1.Lines.Add(\u0026#39;Par√°grafo 3: ...\u0026#39;); Problema #2 ‚Äî Debug com with √© a mesma coisa que tentar achar agulha num palheiro\u0026hellip; s√≥ que o palheiro t√° pegando fogo Quer depurar um trecho que usa with?\nBoa sorte, babaca. O depurador olha pro seu c√≥digo e pensa:\n‚ÄúAmigo, eu n√£o fa√ßo ideia de quem √© esse objeto a√≠.‚Äù\nOlha essa desgra√ßa: with ACBrNFe1.NotasFiscais.Add.NFe do begin ide.cNF := \u0026#39;12345678\u0026#39;; end; Na hora de inspecionar ide.cNF, o compilador olha pra voc√™ e diz:\n‚ÄúN√£o sei quem √© ide, e sinceramente, tamb√©m n√£o quero saber.‚Äù\nA√≠ o cara tem que reconstruir toda a cadeia s√≥ pra ver um valorzinho.\nTudo isso porque quis ‚Äúdigitar menos‚Äù.\nParab√©ns, guerreiro do Ctrl+C Ctrl+V.\nProblema #3 ‚Äî Voc√™ nem sabe mais o que est√° alterando No with, voc√™ acha que est√° mexendo em um objeto, mas na verdade est√° atacando outro completamente diferente.\n√â o inferno em forma de sintaxe.\nO caos em pessoa: with Nota do begin with Det.Add do begin with Imposto do begin with ICMS do begin // Aqui ningu√©m sabe mais quem √© quem nesse caralho end; end; end; end; Quem l√™ um c√≥digo desses merece um aumento‚Ä¶ ou uma interna√ß√£o.\nCoice do Bruto: Aqui cada linha sabe quem √© o dono da bronca.\nE se der pau, o depurador sabe tamb√©m. var Nota: TNFe; Det: TDetCollectionItem; begin Nota := ACBrNFe1.NotasFiscais.Add.NFe; Det := Nota.Det.Add; Det.Imposto.ICMS.CST := cst00; Det.Imposto.ICMS.orig := oeNacional; end; Como largar o v√≠cio do with (passo a passo de desintoxica√ß√£o) Descubra o tipo de retorno (Ctrl+Clique, pregui√ßoso).\nExemplo: NotasFiscais.Add.NFe : TNFe. Crie uma vari√°vel decente: var Nota: TNFe; Nota := ACBrNFe1.NotasFiscais.Add.NFe; Fez um .Add? Guarda o item: var Det: TDetCollectionItem; Det := Nota.Det.Add; D√™ nomes de gente pras vari√°veis.\nNada de a, b, obj, aux. Nomeie direito. Quebre o c√≥digo. C√≥digo bom √© aquele que at√© o estagi√°rio de marketing entende. Exemplo completo (sem pregui√ßa) uses ACBrNFe, ACBrNFeNotasFiscais; procedure TForm1.GerarNFeClara; var Nota: TNFe; Det: TDetCollectionItem; begin Nota := ACBrNFe1.NotasFiscais.Add.NFe; Nota.Ide.cNF := \u0026#39;12345678\u0026#39;; Nota.Ide.nNF := 2; Nota.Ide.tpAmb := taHomologacao; Nota.Ide.finNFe := fnNormal; Det := Nota.Det.Add; Det.nItem := 1; Det.Prod.cProd := \u0026#39;ABC123\u0026#39;; Det.Prod.xProd := \u0026#39;Produto Exemplo\u0026#39;; Det.Prod.qCom := 1.0000; Det.Prod.vUnCom := 100.00; Det.Imposto.ICMS.CST := cst00; Det.Imposto.ICMS.orig := oeNacional; end; Coice do Bruto: D√° mais trabalho? D√°.\nMas pelo menos voc√™ entende o que escreveu ‚Äî e n√£o parece que um estagi√°rio b√™bado codou isso. Checklist do Bruto para banir o with Declare vari√°veis decentes. Quebre cadeias longas. Nomeie as coisas direito. Fa√ßa o debug funcionar sem reza brava. E se algu√©m usar with no seu projeto\u0026hellip; refatora sem d√≥ e demita o respons√°vel. ‚ÄúMas Bruto, eu digito menos com with\u0026hellip;‚Äù E eu digito menos ainda se eu deletar seu c√≥digo inteiro.\nDigitar menos n√£o √© meta de programador.\nEntender o que escreveu √©.\nConclus√£o O with √© a muleta dos pregui√ßosos.\n√â o ‚Äújeitinho brasileiro‚Äù aplicado √† programa√ß√£o.\nQuer ser bom? Escreve direito. Quer ser r√°pido? Usa snippet.\nCoice do Bruto: Mas se continuar defendendo with, n√£o me chama pra dar manuten√ß√£o no seu c√≥digo, porque eu vou arrancar esse neg√≥cio de l√° nem que seja na marra.\nSe voc√™ √© do time with, √≥timo ‚Äî s√≥ n√£o me chame pra manuten√ß√£o. Se me chamar, eu vou l√° e arranco esse v√≠cio do seu c√≥digo sem d√≥. E se achou tudo isso uma besteira\u0026hellip;\nT√° bom tamb√©m.\nEu continuo dormindo bem e o with continua sendo uma bosta. üòé\n","permalink":"http://localhost:1313/pt/posts/pare-de-usar-with-no-delphi/","summary":"Um manifesto do Bruto do Delphi: por que o \u003ccode\u003ewith\u003c/code\u003e √© o capeta disfar√ßado de atalho.","title":"Pare de Usar With no Delphi"},{"content":"Rodando Delphi no WSL2 ‚Äî quando o Linux entra na sua m√°quina e o Windows s√≥ assiste L√° por 2025 eu resolvi encarar a ideia maluca de rodar Delphi no Linux sem sair do Windows.\n√â isso mesmo: um tal de WSL2 ‚Äî o ‚Äúsubsystem for linux‚Äù ‚Äî que deixa o pinguim morar dentro do Windows e ainda comer na mesma mesa. E pra minha surpresa, funciona. Ent√£o se prepara, porque eu vou te mostrar como eu fiz isso funcionar com o Ubuntu 22.04 (era o est√°vel quando escrevi este post). Se quando voc√™ estiver lendo isso o n√∫mero for outro (24.04, 26.04‚Ä¶), troca o nome na instala√ß√£o e segue o baile. 1. O que √© o tal do WSL O WSL √© basicamente um Linux domesticado, rodando dentro do Windows. N√£o √© VM, n√£o √© Docker ‚Äî √© r√°pido e pr√°tico. Voc√™ roda um comando e pronto: tem um Ubuntu te olhando feio.\n2. Instalando o Ubuntu (ou o que tiver no lugar dele) Abra o Prompt de Comando como administrador e rode:\n1 wsl --list --online Vai aparecer uma lista de distribui√ß√µes. Na √©poca eu usei Ubuntu 22.04, mas se j√° saiu 24.04, use ele. O nome muda, o processo √© o mesmo.\nPara instalar:\n1 wsl --install Ubuntu-22.04 O Windows baixa, instala e pede usu√°rio e senha. Escolha algo que voc√™ lembre, porque o Linux vai cobrar.\n3. Atualizando o sistema e instalando o que presta No Ubuntu, rode o b√°sico para atualizar os pacotes:\n1 sudo apt update \u0026amp;\u0026amp; sudo apt upgrade \u0026amp;\u0026amp; sudo apt dist-upgrade Depois instale as ferramentas de desenvolvimento que o Delphi precisa:\n1 sudo apt install joe wget p7zip-full curl openssh-server build-essential zlib1g-dev libcurl4-gnutls-dev libncurses5 zlib1g-dev libgtk-3-dev 4. Instalando o PAServer no WSL Copie o PAServer do Windows para dentro do WSL. No Delphi 12, o arquivo fica em algo como:\n1 C:\\\\Program Files (x86)\\\\Embarcadero\\\\Studio\\\\23.0\\\\PAServer\\\\LinuxPAServer23.0.tar.gz No Ubuntu, execute:\n1 2 cp /mnt/c/Program\\ Files\\ \\(x86\\)/Embarcadero/Studio/23.0/PAServer/LinuxPAServer23.0.tar.gz ~/ tar -xvf ./LinuxPAServer23.0.tar.gz Inicie o servidor:\n1 ./PAServer-23.0/paserver Ele pedir√° uma senha ‚Äî defina uma senha de verdade. Aqui n√£o tem ‚Äòdeixar tudo aberto‚Äô (laele). Seguran√ßa √© coisa s√©ria.\nDigite i e pressione Enter para ver o IP do PAServer. Anote.\n5. Configurando o Delphi para conversar com o WSL No Delphi do Windows, instale o FMXLinux via GetIt (se necess√°rio). Depois v√° em:\nTools \u0026gt; Options \u0026gt; Deployment \u0026gt; Connection Profile Manager Clique em Add e crie um perfil para Linux 64-bit. Informe o IP do PAServer, usu√°rio e senha definidos no Ubuntu, e Test Connection. 6. Adicionando o SDK Ainda no Delphi:\nTools \u0026gt; Options \u0026gt; Deployment \u0026gt; SDK Manager Clique em Add, escolha Linux 64-bit e selecione o perfil criado. O Delphi vai copiar um monte de arquivo para o WSL. Demora ‚Äî quando o bot√£o Cancel virar Close, terminou. 7. Compilando direto para Linux Crie um projeto Multi-Device Application e, no Project Manager, selecione Linux 64-bit. Se n√£o aparecer, adicione em Target Platforms.\nPressione F9. Se tudo estiver certo, o app sobe dentro do WSL.\n8. Conclus√£o Coice do Bruto: Pronto. Delphi no Windows, compilando para Linux no WSL.\n√â bonito? N√£o. √â pr√°tico? Depende. √â curioso? Bastante.\nSe der erro: confira IP, PAServer, SDK e firewall. Persistindo, reinicie ‚Äî √†s vezes o Windows s√≥ quer aten√ß√£o.\n‚ÄúSe t√° rodando, n√£o mexe. Se parou, o Windows estragou.‚Äù ‚Äî Bruto do Delphi\nCr√©dito: Este artigo foi escrito durante o Vivid Day da GDK,\rum dia em que os desenvolvedores recebem tempo dedicado para estudar, pesquisar\re produzir conte√∫do t√©cnico. Agrade√ßo √† empresa por apoiar iniciativas que fortalecem\ra comunidade t√©cnica.\r","permalink":"http://localhost:1313/pt/posts/wsl-delphi/","summary":"Rodando Delphi no WSL2 ‚Äî quando o Linux entra na sua m√°quina e o Windows s√≥ assiste.","title":"Rodando Delphi no Linux"},{"content":"L√° por 2018, no Delphi 10.3 Rio, os engenheiros da Embarcadero resolveram ‚Äúmodernizar‚Äù o neg√≥cio e inventaram as vari√°veis inline.\nA ideia parece genial: declarar a vari√°vel ali, no exato ponto onde vai usar.\nNo papel √© bonito. Na pr√°tica, √© tipo botar farol de LED num fusca ‚Äî chama aten√ß√£o, mas n√£o resolve o problema.\nNeste post, eu te explico o que s√£o essas benditas vari√°veis inline, quando elas at√© fazem sentido, e por que, na minha opini√£o, qualquer coisa fora de um for √© receita de bagun√ßa.\nO que √© vari√°vel inline Desde os prim√≥rdios do Pascal, l√° da √©poca que a gente ainda usava disquete e o compilador cabia num disquete e meio, toda vari√°vel local era declarada no topo do m√©todo, antes do begin.\nEsse era o padr√£o: bonito, previs√≠vel e l√≥gico.\nA√≠ veio o Delphi 10.3 Rio e resolveu permitir isso aqui:\nprocedure Test; begin var i: Integer := 10; ShowMessage(i.ToString); end; Parece pr√°tico, n√©? E √© mesmo‚Ä¶ at√© o momento em que o c√≥digo come√ßa a crescer.\nA√≠ voc√™ vai ca√ßar onde est√° a vari√°vel, e descobre que algu√©m teve a brilhante ideia de declarar um var no meio de um if, outro dentro de um try, e outro l√° no fim do begin.\nPronto, virou merda.\nOs pr√≥s (pra n√£o dizer que eu s√≥ reclamo) O escopo fica mais curto: terminou o bloco, a vari√°vel morre. D√° pra declarar no ponto de uso, beleza. O compilador infere o tipo, ent√£o o c√≥digo fica menor. Evita vari√°veis zumbis que seguem vivas sem necessidade. Ok, tem sua utilidade. Mas a turma come√ßou a achar que isso √© desculpa pra jogar var em qualquer canto do c√≥digo. Os contras (e aqui come√ßa a bronca) Coice do Bruto: Fora do for, vira bagun√ßa generalizada.\nVoc√™ abre um m√©todo e tem var em cada esquina.\nO padr√£o do Delphi sempre foi simples: quer saber as vari√°veis? sobe l√° pro topo, antes do begin.\nAgora tem que sair ca√ßando var no meio do inferno. √Äs vezes nem tipo tem: var x := AlgumaFuncao(); ‚Äî a√≠ voc√™ precisa abrir a fun√ß√£o pra saber o que √© x. Manuten√ß√£o? Virou ca√ßa ao tesouro. C√≥digo grande com inline √© tipo novela ruim: parece que vai melhorar, mas s√≥ piora. Resumo: quem quer economizar tr√™s teclas acaba gastando meia hora pra entender o que o pr√≥prio c√≥digo faz.\nOpini√£o do Bruto Vari√°vel inline s√≥ faz sentido em dois lugares:\nDentro de um for, tipo for var i := 0 to 10 do. Em blocos pequenos, de prefer√™ncia com menos de meia tela. Fora disso, √© firula.\nQuer declarar no meio do m√©todo? Faz um favor pra humanidade e vai vender pamonha.\nQuem for dar manuten√ß√£o vai te xingar em tr√™s l√≠nguas diferentes, e com raz√£o.\nCoice do Bruto: No meu c√≥digo, vari√°vel √© tudo antes do begin.\nSe voc√™ precisar achar uma, vai l√° e t√° tudo ali, arrumadinho.\nIsso √© padr√£o, √© clareza, √© paz de esp√≠rito. Exemplo bom (aceit√°vel) for var Item in Lista do begin var Dobrado := Item * 2; ShowMessage(Dobrado.ToString); end; Curto, direto, limpo. Morreu dentro do loop, n√£o incomoda ningu√©m.\nExemplo ruim (zona total) procedure Calcula; begin var Total := 0; if Condicao then begin var Aux := SomaFuncao(); Total := Total + Aux; end; var Outro := OutraFuncao(); ShowMessage(Total.ToString + Outro.ToString); end; Onde foi declarada ‚ÄúOutro‚Äù? Qual o tipo dela? O que ela come?\nPra descobrir, s√≥ debugando.\nE o coitado que abrir isso daqui seis meses vai querer pular da janela.\nExemplo da desgra√ßa suprema (mesmo nome, tipos diferentes) procedure Teste; begin var Valor: Integer := 10; ShowMessage(\u0026#39;Valor inteiro: \u0026#39; + Valor.ToString); begin var Valor: String := \u0026#39;dez\u0026#39;; ShowMessage(\u0026#39;Valor string: \u0026#39; + Valor); end; ShowMessage(\u0026#39;Valor ainda √© inteiro: \u0026#39; + Valor.ToString); end; Olha que maravilha: duas vari√°veis com o mesmo nome, tipos diferentes, vivas em blocos diferentes.\nCompila feliz, mas quem ler isso vai pensar que o compilador enlouqueceu.\nVoc√™ acha que √© um Integer, mas dentro de um bloco virou String.\nDepois volta a ser Integer.\nIsso n√£o √© clareza ‚Äî isso √© transtorno de identidade de vari√°vel.\nConclus√£o Coice do Bruto: Vari√°veis inline √© igual makita na m√£o de crian√ßa: pode at√© funcionar, mas voc√™ sabe que vai dar merda e alguem vai sair chorando (e quem sabe com um dedo a menos).\nUse no for, use em bloco pequeno, mas n√£o espalha var pelo c√≥digo que nem confete no carnaval.\nO padr√£o do Delphi √© simples, bonito e testado h√° d√©cadas:\nvar tudo antes do begin.\nFoge disso e o c√≥digo vira um bingo de escopo.\nE se eu abrir seu c√≥digo e encontrar vari√°vel inline espalhada, j√° aviso:\neu vou arrancar tudo e botar o var l√° em cima, onde sempre deveria estar.\nNa marra, se for preciso.\n","permalink":"http://localhost:1313/pt/posts/variaveis-inline-no-delphi/","summary":"\u003cp\u003eL√° por 2018, no \u003cstrong\u003eDelphi 10.3 Rio\u003c/strong\u003e, os engenheiros da Embarcadero resolveram ‚Äúmodernizar‚Äù o neg√≥cio e inventaram as \u003cstrong\u003evari√°veis inline\u003c/strong\u003e.\u003cbr\u003e\nA ideia parece genial: declarar a vari√°vel ali, no exato ponto onde vai usar.\u003cbr\u003e\nNo papel √© bonito. Na pr√°tica, √© tipo botar farol de LED num fusca ‚Äî chama aten√ß√£o, mas n√£o resolve o problema.\u003c/p\u003e\n\u003cp\u003eNeste post, eu te explico o que s√£o essas benditas vari√°veis inline, quando elas at√© fazem sentido, e por que, na minha opini√£o, \u003cstrong\u003equalquer coisa fora de um \u003ccode\u003efor\u003c/code\u003e √© receita de bagun√ßa.\u003c/strong\u003e\u003c/p\u003e","title":"Vari√°veis inline ‚Äì para√≠so ou zona?"},{"content":" WITH √© coisa de programador pregui√ßoso Coice do Bruto: ‚ö†Ô∏è Aviso de utilidade p√∫blica:\nEste texto √© opinativo, mal humorado e cheio de verdade.\nSe voc√™ ama o with e acha que ele √© lindo, j√° pode apertar Ctrl+W e fechar essa aba.\nEu n√£o vou dormir menos, n√£o vou comer menos e n√£o vou te mandar flores.\nAgora, se voc√™ quer entender de verdade por que esse treco √© uma desgra√ßa no Delphi ‚Äî senta a√≠ e presta aten√ß√£o.\nOu ent√£o, veja esse artigo em v√≠deo O que √© esse tal de with e por que o povo usa O with √© aquele ‚Äúatalho m√°gico‚Äù que promete te poupar meia d√∫zia de teclas.\nO sujeito olha praquilo e pensa:\n‚ÄúNossa, que lindo! N√£o preciso digitar Memo1.Lines toda hora!‚Äù\nPois √©‚Ä¶ e depois n√£o entende por que o c√≥digo dele parece uma merda.\nO with serve pra:\n‚ÄúEncurtar‚Äù chamadas (tipo Memo1.Lines.Add). Preencher cole√ß√µes (tipo ACBrNFe1.NotasFiscais.Add). E serve tamb√©m pra bagun√ßar seu c√≥digo, confundir o depurador e te fazer parecer um pregui√ßoso.\nBonito, n√©?\nProblema #1 ‚Äî O with fode a leitura do seu c√≥digo Sabe aquele c√≥digo bonito que voc√™ l√™ e entende de primeira?\nPois √©, o with pega esse c√≥digo, limpa a bunda com ele e joga no lixo.\nExemplo cl√°ssico de pregui√ßa: with Memo1.Lines do begin Clear; Add(\u0026#39;Cap√≠tulo 1: ...\u0026#39;); Add(\u0026#39;Par√°grafo 2: ...\u0026#39;); Add(\u0026#39;Par√°grafo 3: ...\u0026#39;); end; O sujeito que escreveu isso acha que economizou tempo.\nEconomizou nada, s√≥ fodeu quem vai dar manuten√ß√£o.\nCoice do Bruto: Aqui cada linha grita quem √© o dono da a√ß√£o.\nN√£o tem charada, n√£o tem adivinha√ß√£o.\nO c√≥digo √© honesto ‚Äî coisa rara hoje em dia. Memo1.Lines.Clear; Memo1.Lines.Add(\u0026#39;Cap√≠tulo 1: ...\u0026#39;); Memo1.Lines.Add(\u0026#39;Par√°grafo 2: ...\u0026#39;); Memo1.Lines.Add(\u0026#39;Par√°grafo 3: ...\u0026#39;); Problema #2 ‚Äî Debug com with √© a mesma coisa que tentar achar agulha num palheiro\u0026hellip; s√≥ que o palheiro t√° pegando fogo Quer depurar um trecho que usa with?\nBoa sorte, babaca. O depurador olha pro seu c√≥digo e pensa:\n‚ÄúAmigo, eu n√£o fa√ßo ideia de quem √© esse objeto a√≠.‚Äù\nOlha essa desgra√ßa: with ACBrNFe1.NotasFiscais.Add.NFe do begin ide.cNF := \u0026#39;12345678\u0026#39;; end; Na hora de inspecionar ide.cNF, o compilador olha pra voc√™ e diz:\n‚ÄúN√£o sei quem √© ide, e sinceramente, tamb√©m n√£o quero saber.‚Äù\nA√≠ o cara tem que reconstruir toda a cadeia s√≥ pra ver um valorzinho.\nTudo isso porque quis ‚Äúdigitar menos‚Äù.\nParab√©ns, guerreiro do Ctrl+C Ctrl+V.\nProblema #3 ‚Äî Voc√™ nem sabe mais o que est√° alterando No with, voc√™ acha que est√° mexendo em um objeto, mas na verdade est√° atacando outro completamente diferente.\n√â o inferno em forma de sintaxe.\nO caos em pessoa: with Nota do begin with Det.Add do begin with Imposto do begin with ICMS do begin // Aqui ningu√©m sabe mais quem √© quem nesse caralho end; end; end; end; Quem l√™ um c√≥digo desses merece um aumento‚Ä¶ ou uma interna√ß√£o.\nCoice do Bruto: Aqui cada linha sabe quem √© o dono da bronca.\nE se der pau, o depurador sabe tamb√©m. var Nota: TNFe; Det: TDetCollectionItem; begin Nota := ACBrNFe1.NotasFiscais.Add.NFe; Det := Nota.Det.Add; Det.Imposto.ICMS.CST := cst00; Det.Imposto.ICMS.orig := oeNacional; end; Como largar o v√≠cio do with (passo a passo de desintoxica√ß√£o) Descubra o tipo de retorno (Ctrl+Clique, pregui√ßoso).\nExemplo: NotasFiscais.Add.NFe : TNFe. Crie uma vari√°vel decente: var Nota: TNFe; Nota := ACBrNFe1.NotasFiscais.Add.NFe; Fez um .Add? Guarda o item: var Det: TDetCollectionItem; Det := Nota.Det.Add; D√™ nomes de gente pras vari√°veis.\nNada de a, b, obj, aux. Nomeie direito. Quebre o c√≥digo. C√≥digo bom √© aquele que at√© o estagi√°rio de marketing entende. Exemplo completo (sem pregui√ßa) uses ACBrNFe, ACBrNFeNotasFiscais; procedure TForm1.GerarNFeClara; var Nota: TNFe; Det: TDetCollectionItem; begin Nota := ACBrNFe1.NotasFiscais.Add.NFe; Nota.Ide.cNF := \u0026#39;12345678\u0026#39;; Nota.Ide.nNF := 2; Nota.Ide.tpAmb := taHomologacao; Nota.Ide.finNFe := fnNormal; Det := Nota.Det.Add; Det.nItem := 1; Det.Prod.cProd := \u0026#39;ABC123\u0026#39;; Det.Prod.xProd := \u0026#39;Produto Exemplo\u0026#39;; Det.Prod.qCom := 1.0000; Det.Prod.vUnCom := 100.00; Det.Imposto.ICMS.CST := cst00; Det.Imposto.ICMS.orig := oeNacional; end; Coice do Bruto: D√° mais trabalho? D√°.\nMas pelo menos voc√™ entende o que escreveu ‚Äî e n√£o parece que um estagi√°rio b√™bado codou isso. Checklist do Bruto para banir o with Declare vari√°veis decentes. Quebre cadeias longas. Nomeie as coisas direito. Fa√ßa o debug funcionar sem reza brava. E se algu√©m usar with no seu projeto\u0026hellip; refatora sem d√≥ e demita o respons√°vel. ‚ÄúMas Bruto, eu digito menos com with\u0026hellip;‚Äù E eu digito menos ainda se eu deletar seu c√≥digo inteiro.\nDigitar menos n√£o √© meta de programador.\nEntender o que escreveu √©.\nConclus√£o O with √© a muleta dos pregui√ßosos.\n√â o ‚Äújeitinho brasileiro‚Äù aplicado √† programa√ß√£o.\nQuer ser bom? Escreve direito. Quer ser r√°pido? Usa snippet.\nCoice do Bruto: Mas se continuar defendendo with, n√£o me chama pra dar manuten√ß√£o no seu c√≥digo, porque eu vou arrancar esse neg√≥cio de l√° nem que seja na marra.\nSe voc√™ √© do time with, √≥timo ‚Äî s√≥ n√£o me chame pra manuten√ß√£o. Se me chamar, eu vou l√° e arranco esse v√≠cio do seu c√≥digo sem d√≥. E se achou tudo isso uma besteira\u0026hellip;\nT√° bom tamb√©m.\nEu continuo dormindo bem e o with continua sendo uma bosta. üòé\n","permalink":"http://localhost:1313/pt/posts/pare-de-usar-with-no-delphi/","summary":"Um manifesto do Bruto do Delphi: por que o \u003ccode\u003ewith\u003c/code\u003e √© o capeta disfar√ßado de atalho.","title":"Pare de Usar With no Delphi"},{"content":"Rodando Delphi no WSL2 ‚Äî quando o Linux entra na sua m√°quina e o Windows s√≥ assiste L√° por 2025 eu resolvi encarar a ideia maluca de rodar Delphi no Linux sem sair do Windows.\n√â isso mesmo: um tal de WSL2 ‚Äî o ‚Äúsubsystem for linux‚Äù ‚Äî que deixa o pinguim morar dentro do Windows e ainda comer na mesma mesa. E pra minha surpresa, funciona. Ent√£o se prepara, porque eu vou te mostrar como eu fiz isso funcionar com o Ubuntu 22.04 (era o est√°vel quando escrevi este post). Se quando voc√™ estiver lendo isso o n√∫mero for outro (24.04, 26.04‚Ä¶), troca o nome na instala√ß√£o e segue o baile. 1. O que √© o tal do WSL O WSL √© basicamente um Linux domesticado, rodando dentro do Windows. N√£o √© VM, n√£o √© Docker ‚Äî √© r√°pido e pr√°tico. Voc√™ roda um comando e pronto: tem um Ubuntu te olhando feio.\n2. Instalando o Ubuntu (ou o que tiver no lugar dele) Abra o Prompt de Comando como administrador e rode:\n1 wsl --list --online Vai aparecer uma lista de distribui√ß√µes. Na √©poca eu usei Ubuntu 22.04, mas se j√° saiu 24.04, use ele. O nome muda, o processo √© o mesmo.\nPara instalar:\n1 wsl --install Ubuntu-22.04 O Windows baixa, instala e pede usu√°rio e senha. Escolha algo que voc√™ lembre, porque o Linux vai cobrar.\n3. Atualizando o sistema e instalando o que presta No Ubuntu, rode o b√°sico para atualizar os pacotes:\n1 sudo apt update \u0026amp;\u0026amp; sudo apt upgrade \u0026amp;\u0026amp; sudo apt dist-upgrade Depois instale as ferramentas de desenvolvimento que o Delphi precisa:\n1 sudo apt install joe wget p7zip-full curl openssh-server build-essential zlib1g-dev libcurl4-gnutls-dev libncurses5 zlib1g-dev libgtk-3-dev 4. Instalando o PAServer no WSL Copie o PAServer do Windows para dentro do WSL. No Delphi 12, o arquivo fica em algo como:\n1 C:\\\\Program Files (x86)\\\\Embarcadero\\\\Studio\\\\23.0\\\\PAServer\\\\LinuxPAServer23.0.tar.gz No Ubuntu, execute:\n1 2 cp /mnt/c/Program\\ Files\\ \\(x86\\)/Embarcadero/Studio/23.0/PAServer/LinuxPAServer23.0.tar.gz ~/ tar -xvf ./LinuxPAServer23.0.tar.gz Inicie o servidor:\n1 ./PAServer-23.0/paserver Ele pedir√° uma senha ‚Äî defina uma senha de verdade. Aqui n√£o tem ‚Äòdeixar tudo aberto‚Äô (laele). Seguran√ßa √© coisa s√©ria.\nDigite i e pressione Enter para ver o IP do PAServer. Anote.\n5. Configurando o Delphi para conversar com o WSL No Delphi do Windows, instale o FMXLinux via GetIt (se necess√°rio). Depois v√° em:\nTools \u0026gt; Options \u0026gt; Deployment \u0026gt; Connection Profile Manager Clique em Add e crie um perfil para Linux 64-bit. Informe o IP do PAServer, usu√°rio e senha definidos no Ubuntu, e Test Connection. 6. Adicionando o SDK Ainda no Delphi:\nTools \u0026gt; Options \u0026gt; Deployment \u0026gt; SDK Manager Clique em Add, escolha Linux 64-bit e selecione o perfil criado. O Delphi vai copiar um monte de arquivo para o WSL. Demora ‚Äî quando o bot√£o Cancel virar Close, terminou. 7. Compilando direto para Linux Crie um projeto Multi-Device Application e, no Project Manager, selecione Linux 64-bit. Se n√£o aparecer, adicione em Target Platforms.\nPressione F9. Se tudo estiver certo, o app sobe dentro do WSL.\n8. Conclus√£o Coice do Bruto: Pronto. Delphi no Windows, compilando para Linux no WSL.\n√â bonito? N√£o. √â pr√°tico? Depende. √â curioso? Bastante.\nSe der erro: confira IP, PAServer, SDK e firewall. Persistindo, reinicie ‚Äî √†s vezes o Windows s√≥ quer aten√ß√£o.\n‚ÄúSe t√° rodando, n√£o mexe. Se parou, o Windows estragou.‚Äù ‚Äî Bruto do Delphi\nCr√©dito: Este artigo foi escrito durante o Vivid Day da GDK,\rum dia em que os desenvolvedores recebem tempo dedicado para estudar, pesquisar\re produzir conte√∫do t√©cnico. Agrade√ßo √† empresa por apoiar iniciativas que fortalecem\ra comunidade t√©cnica.\r","permalink":"http://localhost:1313/pt/posts/wsl-delphi/","summary":"Rodando Delphi no WSL2 ‚Äî quando o Linux entra na sua m√°quina e o Windows s√≥ assiste.","title":"Rodando Delphi no Linux"},{"content":"L√° por 2018, no Delphi 10.3 Rio, os engenheiros da Embarcadero resolveram ‚Äúmodernizar‚Äù o neg√≥cio e inventaram as vari√°veis inline.\nA ideia parece genial: declarar a vari√°vel ali, no exato ponto onde vai usar.\nNo papel √© bonito. Na pr√°tica, √© tipo botar farol de LED num fusca ‚Äî chama aten√ß√£o, mas n√£o resolve o problema.\nNeste post, eu te explico o que s√£o essas benditas vari√°veis inline, quando elas at√© fazem sentido, e por que, na minha opini√£o, qualquer coisa fora de um for √© receita de bagun√ßa.\nO que √© vari√°vel inline Desde os prim√≥rdios do Pascal, l√° da √©poca que a gente ainda usava disquete e o compilador cabia num disquete e meio, toda vari√°vel local era declarada no topo do m√©todo, antes do begin.\nEsse era o padr√£o: bonito, previs√≠vel e l√≥gico.\nA√≠ veio o Delphi 10.3 Rio e resolveu permitir isso aqui:\nprocedure Test; begin var i: Integer := 10; ShowMessage(i.ToString); end; Parece pr√°tico, n√©? E √© mesmo‚Ä¶ at√© o momento em que o c√≥digo come√ßa a crescer.\nA√≠ voc√™ vai ca√ßar onde est√° a vari√°vel, e descobre que algu√©m teve a brilhante ideia de declarar um var no meio de um if, outro dentro de um try, e outro l√° no fim do begin.\nPronto, virou merda.\nOs pr√≥s (pra n√£o dizer que eu s√≥ reclamo) O escopo fica mais curto: terminou o bloco, a vari√°vel morre. D√° pra declarar no ponto de uso, beleza. O compilador infere o tipo, ent√£o o c√≥digo fica menor. Evita vari√°veis zumbis que seguem vivas sem necessidade. Ok, tem sua utilidade. Mas a turma come√ßou a achar que isso √© desculpa pra jogar var em qualquer canto do c√≥digo. Os contras (e aqui come√ßa a bronca) Coice do Bruto: Fora do for, vira bagun√ßa generalizada.\nVoc√™ abre um m√©todo e tem var em cada esquina.\nO padr√£o do Delphi sempre foi simples: quer saber as vari√°veis? sobe l√° pro topo, antes do begin.\nAgora tem que sair ca√ßando var no meio do inferno. √Äs vezes nem tipo tem: var x := AlgumaFuncao(); ‚Äî a√≠ voc√™ precisa abrir a fun√ß√£o pra saber o que √© x. Manuten√ß√£o? Virou ca√ßa ao tesouro. C√≥digo grande com inline √© tipo novela ruim: parece que vai melhorar, mas s√≥ piora. Resumo: quem quer economizar tr√™s teclas acaba gastando meia hora pra entender o que o pr√≥prio c√≥digo faz.\nOpini√£o do Bruto Vari√°vel inline s√≥ faz sentido em dois lugares:\nDentro de um for, tipo for var i := 0 to 10 do. Em blocos pequenos, de prefer√™ncia com menos de meia tela. Fora disso, √© firula.\nQuer declarar no meio do m√©todo? Faz um favor pra humanidade e vai vender pamonha.\nQuem for dar manuten√ß√£o vai te xingar em tr√™s l√≠nguas diferentes, e com raz√£o.\nCoice do Bruto: No meu c√≥digo, vari√°vel √© tudo antes do begin.\nSe voc√™ precisar achar uma, vai l√° e t√° tudo ali, arrumadinho.\nIsso √© padr√£o, √© clareza, √© paz de esp√≠rito. Exemplo bom (aceit√°vel) for var Item in Lista do begin var Dobrado := Item * 2; ShowMessage(Dobrado.ToString); end; Curto, direto, limpo. Morreu dentro do loop, n√£o incomoda ningu√©m.\nExemplo ruim (zona total) procedure Calcula; begin var Total := 0; if Condicao then begin var Aux := SomaFuncao(); Total := Total + Aux; end; var Outro := OutraFuncao(); ShowMessage(Total.ToString + Outro.ToString); end; Onde foi declarada ‚ÄúOutro‚Äù? Qual o tipo dela? O que ela come?\nPra descobrir, s√≥ debugando.\nE o coitado que abrir isso daqui seis meses vai querer pular da janela.\nExemplo da desgra√ßa suprema (mesmo nome, tipos diferentes) procedure Teste; begin var Valor: Integer := 10; ShowMessage(\u0026#39;Valor inteiro: \u0026#39; + Valor.ToString); begin var Valor: String := \u0026#39;dez\u0026#39;; ShowMessage(\u0026#39;Valor string: \u0026#39; + Valor); end; ShowMessage(\u0026#39;Valor ainda √© inteiro: \u0026#39; + Valor.ToString); end; Olha que maravilha: duas vari√°veis com o mesmo nome, tipos diferentes, vivas em blocos diferentes.\nCompila feliz, mas quem ler isso vai pensar que o compilador enlouqueceu.\nVoc√™ acha que √© um Integer, mas dentro de um bloco virou String.\nDepois volta a ser Integer.\nIsso n√£o √© clareza ‚Äî isso √© transtorno de identidade de vari√°vel.\nConclus√£o Coice do Bruto: Vari√°veis inline √© igual makita na m√£o de crian√ßa: pode at√© funcionar, mas voc√™ sabe que vai dar merda e alguem vai sair chorando (e quem sabe com um dedo a menos).\nUse no for, use em bloco pequeno, mas n√£o espalha var pelo c√≥digo que nem confete no carnaval.\nO padr√£o do Delphi √© simples, bonito e testado h√° d√©cadas:\nvar tudo antes do begin.\nFoge disso e o c√≥digo vira um bingo de escopo.\nE se eu abrir seu c√≥digo e encontrar vari√°vel inline espalhada, j√° aviso:\neu vou arrancar tudo e botar o var l√° em cima, onde sempre deveria estar.\nNa marra, se for preciso.\n","permalink":"http://localhost:1313/pt/posts/variaveis-inline-no-delphi/","summary":"\u003cp\u003eL√° por 2018, no \u003cstrong\u003eDelphi 10.3 Rio\u003c/strong\u003e, os engenheiros da Embarcadero resolveram ‚Äúmodernizar‚Äù o neg√≥cio e inventaram as \u003cstrong\u003evari√°veis inline\u003c/strong\u003e.\u003cbr\u003e\nA ideia parece genial: declarar a vari√°vel ali, no exato ponto onde vai usar.\u003cbr\u003e\nNo papel √© bonito. Na pr√°tica, √© tipo botar farol de LED num fusca ‚Äî chama aten√ß√£o, mas n√£o resolve o problema.\u003c/p\u003e\n\u003cp\u003eNeste post, eu te explico o que s√£o essas benditas vari√°veis inline, quando elas at√© fazem sentido, e por que, na minha opini√£o, \u003cstrong\u003equalquer coisa fora de um \u003ccode\u003efor\u003c/code\u003e √© receita de bagun√ßa.\u003c/strong\u003e\u003c/p\u003e","title":"Vari√°veis inline ‚Äì para√≠so ou zona?"},{"content":" WITH √© coisa de programador pregui√ßoso Coice do Bruto: ‚ö†Ô∏è Aviso de utilidade p√∫blica:\nEste texto √© opinativo, mal humorado e cheio de verdade.\nSe voc√™ ama o with e acha que ele √© lindo, j√° pode apertar Ctrl+W e fechar essa aba.\nEu n√£o vou dormir menos, n√£o vou comer menos e n√£o vou te mandar flores.\nAgora, se voc√™ quer entender de verdade por que esse treco √© uma desgra√ßa no Delphi ‚Äî senta a√≠ e presta aten√ß√£o.\nOu ent√£o, veja esse artigo em v√≠deo O que √© esse tal de with e por que o povo usa O with √© aquele ‚Äúatalho m√°gico‚Äù que promete te poupar meia d√∫zia de teclas.\nO sujeito olha praquilo e pensa:\n‚ÄúNossa, que lindo! N√£o preciso digitar Memo1.Lines toda hora!‚Äù\nPois √©‚Ä¶ e depois n√£o entende por que o c√≥digo dele parece uma merda.\nO with serve pra:\n‚ÄúEncurtar‚Äù chamadas (tipo Memo1.Lines.Add). Preencher cole√ß√µes (tipo ACBrNFe1.NotasFiscais.Add). E serve tamb√©m pra bagun√ßar seu c√≥digo, confundir o depurador e te fazer parecer um pregui√ßoso.\nBonito, n√©?\nProblema #1 ‚Äî O with fode a leitura do seu c√≥digo Sabe aquele c√≥digo bonito que voc√™ l√™ e entende de primeira?\nPois √©, o with pega esse c√≥digo, limpa a bunda com ele e joga no lixo.\nExemplo cl√°ssico de pregui√ßa: with Memo1.Lines do begin Clear; Add(\u0026#39;Cap√≠tulo 1: ...\u0026#39;); Add(\u0026#39;Par√°grafo 2: ...\u0026#39;); Add(\u0026#39;Par√°grafo 3: ...\u0026#39;); end; O sujeito que escreveu isso acha que economizou tempo.\nEconomizou nada, s√≥ fodeu quem vai dar manuten√ß√£o.\nCoice do Bruto: Aqui cada linha grita quem √© o dono da a√ß√£o.\nN√£o tem charada, n√£o tem adivinha√ß√£o.\nO c√≥digo √© honesto ‚Äî coisa rara hoje em dia. Memo1.Lines.Clear; Memo1.Lines.Add(\u0026#39;Cap√≠tulo 1: ...\u0026#39;); Memo1.Lines.Add(\u0026#39;Par√°grafo 2: ...\u0026#39;); Memo1.Lines.Add(\u0026#39;Par√°grafo 3: ...\u0026#39;); Problema #2 ‚Äî Debug com with √© a mesma coisa que tentar achar agulha num palheiro\u0026hellip; s√≥ que o palheiro t√° pegando fogo Quer depurar um trecho que usa with?\nBoa sorte, babaca. O depurador olha pro seu c√≥digo e pensa:\n‚ÄúAmigo, eu n√£o fa√ßo ideia de quem √© esse objeto a√≠.‚Äù\nOlha essa desgra√ßa: with ACBrNFe1.NotasFiscais.Add.NFe do begin ide.cNF := \u0026#39;12345678\u0026#39;; end; Na hora de inspecionar ide.cNF, o compilador olha pra voc√™ e diz:\n‚ÄúN√£o sei quem √© ide, e sinceramente, tamb√©m n√£o quero saber.‚Äù\nA√≠ o cara tem que reconstruir toda a cadeia s√≥ pra ver um valorzinho.\nTudo isso porque quis ‚Äúdigitar menos‚Äù.\nParab√©ns, guerreiro do Ctrl+C Ctrl+V.\nProblema #3 ‚Äî Voc√™ nem sabe mais o que est√° alterando No with, voc√™ acha que est√° mexendo em um objeto, mas na verdade est√° atacando outro completamente diferente.\n√â o inferno em forma de sintaxe.\nO caos em pessoa: with Nota do begin with Det.Add do begin with Imposto do begin with ICMS do begin // Aqui ningu√©m sabe mais quem √© quem nesse caralho end; end; end; end; Quem l√™ um c√≥digo desses merece um aumento‚Ä¶ ou uma interna√ß√£o.\nCoice do Bruto: Aqui cada linha sabe quem √© o dono da bronca.\nE se der pau, o depurador sabe tamb√©m. var Nota: TNFe; Det: TDetCollectionItem; begin Nota := ACBrNFe1.NotasFiscais.Add.NFe; Det := Nota.Det.Add; Det.Imposto.ICMS.CST := cst00; Det.Imposto.ICMS.orig := oeNacional; end; Como largar o v√≠cio do with (passo a passo de desintoxica√ß√£o) Descubra o tipo de retorno (Ctrl+Clique, pregui√ßoso).\nExemplo: NotasFiscais.Add.NFe : TNFe. Crie uma vari√°vel decente: var Nota: TNFe; Nota := ACBrNFe1.NotasFiscais.Add.NFe; Fez um .Add? Guarda o item: var Det: TDetCollectionItem; Det := Nota.Det.Add; D√™ nomes de gente pras vari√°veis.\nNada de a, b, obj, aux. Nomeie direito. Quebre o c√≥digo. C√≥digo bom √© aquele que at√© o estagi√°rio de marketing entende. Exemplo completo (sem pregui√ßa) uses ACBrNFe, ACBrNFeNotasFiscais; procedure TForm1.GerarNFeClara; var Nota: TNFe; Det: TDetCollectionItem; begin Nota := ACBrNFe1.NotasFiscais.Add.NFe; Nota.Ide.cNF := \u0026#39;12345678\u0026#39;; Nota.Ide.nNF := 2; Nota.Ide.tpAmb := taHomologacao; Nota.Ide.finNFe := fnNormal; Det := Nota.Det.Add; Det.nItem := 1; Det.Prod.cProd := \u0026#39;ABC123\u0026#39;; Det.Prod.xProd := \u0026#39;Produto Exemplo\u0026#39;; Det.Prod.qCom := 1.0000; Det.Prod.vUnCom := 100.00; Det.Imposto.ICMS.CST := cst00; Det.Imposto.ICMS.orig := oeNacional; end; Coice do Bruto: D√° mais trabalho? D√°.\nMas pelo menos voc√™ entende o que escreveu ‚Äî e n√£o parece que um estagi√°rio b√™bado codou isso. Checklist do Bruto para banir o with Declare vari√°veis decentes. Quebre cadeias longas. Nomeie as coisas direito. Fa√ßa o debug funcionar sem reza brava. E se algu√©m usar with no seu projeto\u0026hellip; refatora sem d√≥ e demita o respons√°vel. ‚ÄúMas Bruto, eu digito menos com with\u0026hellip;‚Äù E eu digito menos ainda se eu deletar seu c√≥digo inteiro.\nDigitar menos n√£o √© meta de programador.\nEntender o que escreveu √©.\nConclus√£o O with √© a muleta dos pregui√ßosos.\n√â o ‚Äújeitinho brasileiro‚Äù aplicado √† programa√ß√£o.\nQuer ser bom? Escreve direito. Quer ser r√°pido? Usa snippet.\nCoice do Bruto: Mas se continuar defendendo with, n√£o me chama pra dar manuten√ß√£o no seu c√≥digo, porque eu vou arrancar esse neg√≥cio de l√° nem que seja na marra.\nSe voc√™ √© do time with, √≥timo ‚Äî s√≥ n√£o me chame pra manuten√ß√£o. Se me chamar, eu vou l√° e arranco esse v√≠cio do seu c√≥digo sem d√≥. E se achou tudo isso uma besteira\u0026hellip;\nT√° bom tamb√©m.\nEu continuo dormindo bem e o with continua sendo uma bosta. üòé\n","permalink":"http://localhost:1313/pt/posts/pare-de-usar-with-no-delphi/","summary":"Um manifesto do Bruto do Delphi: por que o \u003ccode\u003ewith\u003c/code\u003e √© o capeta disfar√ßado de atalho.","title":"Pare de Usar With no Delphi"},{"content":"Rodando Delphi no WSL2 ‚Äî quando o Linux entra na sua m√°quina e o Windows s√≥ assiste L√° por 2025 eu resolvi encarar a ideia maluca de rodar Delphi no Linux sem sair do Windows.\n√â isso mesmo: um tal de WSL2 ‚Äî o ‚Äúsubsystem for linux‚Äù ‚Äî que deixa o pinguim morar dentro do Windows e ainda comer na mesma mesa. E pra minha surpresa, funciona. Ent√£o se prepara, porque eu vou te mostrar como eu fiz isso funcionar com o Ubuntu 22.04 (era o est√°vel quando escrevi este post). Se quando voc√™ estiver lendo isso o n√∫mero for outro (24.04, 26.04‚Ä¶), troca o nome na instala√ß√£o e segue o baile. 1. O que √© o tal do WSL O WSL √© basicamente um Linux domesticado, rodando dentro do Windows. N√£o √© VM, n√£o √© Docker ‚Äî √© r√°pido e pr√°tico. Voc√™ roda um comando e pronto: tem um Ubuntu te olhando feio.\n2. Instalando o Ubuntu (ou o que tiver no lugar dele) Abra o Prompt de Comando como administrador e rode:\n1 wsl --list --online Vai aparecer uma lista de distribui√ß√µes. Na √©poca eu usei Ubuntu 22.04, mas se j√° saiu 24.04, use ele. O nome muda, o processo √© o mesmo.\nPara instalar:\n1 wsl --install Ubuntu-22.04 O Windows baixa, instala e pede usu√°rio e senha. Escolha algo que voc√™ lembre, porque o Linux vai cobrar.\n3. Atualizando o sistema e instalando o que presta No Ubuntu, rode o b√°sico para atualizar os pacotes:\n1 sudo apt update \u0026amp;\u0026amp; sudo apt upgrade \u0026amp;\u0026amp; sudo apt dist-upgrade Depois instale as ferramentas de desenvolvimento que o Delphi precisa:\n1 sudo apt install joe wget p7zip-full curl openssh-server build-essential zlib1g-dev libcurl4-gnutls-dev libncurses5 zlib1g-dev libgtk-3-dev 4. Instalando o PAServer no WSL Copie o PAServer do Windows para dentro do WSL. No Delphi 12, o arquivo fica em algo como:\n1 C:\\\\Program Files (x86)\\\\Embarcadero\\\\Studio\\\\23.0\\\\PAServer\\\\LinuxPAServer23.0.tar.gz No Ubuntu, execute:\n1 2 cp /mnt/c/Program\\ Files\\ \\(x86\\)/Embarcadero/Studio/23.0/PAServer/LinuxPAServer23.0.tar.gz ~/ tar -xvf ./LinuxPAServer23.0.tar.gz Inicie o servidor:\n1 ./PAServer-23.0/paserver Ele pedir√° uma senha ‚Äî defina uma senha de verdade. Aqui n√£o tem ‚Äòdeixar tudo aberto‚Äô (laele). Seguran√ßa √© coisa s√©ria.\nDigite i e pressione Enter para ver o IP do PAServer. Anote.\n5. Configurando o Delphi para conversar com o WSL No Delphi do Windows, instale o FMXLinux via GetIt (se necess√°rio). Depois v√° em:\nTools \u0026gt; Options \u0026gt; Deployment \u0026gt; Connection Profile Manager Clique em Add e crie um perfil para Linux 64-bit. Informe o IP do PAServer, usu√°rio e senha definidos no Ubuntu, e Test Connection. 6. Adicionando o SDK Ainda no Delphi:\nTools \u0026gt; Options \u0026gt; Deployment \u0026gt; SDK Manager Clique em Add, escolha Linux 64-bit e selecione o perfil criado. O Delphi vai copiar um monte de arquivo para o WSL. Demora ‚Äî quando o bot√£o Cancel virar Close, terminou. 7. Compilando direto para Linux Crie um projeto Multi-Device Application e, no Project Manager, selecione Linux 64-bit. Se n√£o aparecer, adicione em Target Platforms.\nPressione F9. Se tudo estiver certo, o app sobe dentro do WSL.\n8. Conclus√£o Coice do Bruto: Pronto. Delphi no Windows, compilando para Linux no WSL.\n√â bonito? N√£o. √â pr√°tico? Depende. √â curioso? Bastante.\nSe der erro: confira IP, PAServer, SDK e firewall. Persistindo, reinicie ‚Äî √†s vezes o Windows s√≥ quer aten√ß√£o.\n‚ÄúSe t√° rodando, n√£o mexe. Se parou, o Windows estragou.‚Äù ‚Äî Bruto do Delphi\nCr√©dito: Este artigo foi escrito durante o Vivid Day da GDK,\rum dia em que os desenvolvedores recebem tempo dedicado para estudar, pesquisar\re produzir conte√∫do t√©cnico. Agrade√ßo √† empresa por apoiar iniciativas que fortalecem\ra comunidade t√©cnica.\r","permalink":"http://localhost:1313/pt/posts/wsl-delphi/","summary":"Rodando Delphi no WSL2 ‚Äî quando o Linux entra na sua m√°quina e o Windows s√≥ assiste.","title":"Rodando Delphi no Linux"},{"content":"L√° por 2018, no Delphi 10.3 Rio, os engenheiros da Embarcadero resolveram ‚Äúmodernizar‚Äù o neg√≥cio e inventaram as vari√°veis inline.\nA ideia parece genial: declarar a vari√°vel ali, no exato ponto onde vai usar.\nNo papel √© bonito. Na pr√°tica, √© tipo botar farol de LED num fusca ‚Äî chama aten√ß√£o, mas n√£o resolve o problema.\nNeste post, eu te explico o que s√£o essas benditas vari√°veis inline, quando elas at√© fazem sentido, e por que, na minha opini√£o, qualquer coisa fora de um for √© receita de bagun√ßa.\nO que √© vari√°vel inline Desde os prim√≥rdios do Pascal, l√° da √©poca que a gente ainda usava disquete e o compilador cabia num disquete e meio, toda vari√°vel local era declarada no topo do m√©todo, antes do begin.\nEsse era o padr√£o: bonito, previs√≠vel e l√≥gico.\nA√≠ veio o Delphi 10.3 Rio e resolveu permitir isso aqui:\nprocedure Test; begin var i: Integer := 10; ShowMessage(i.ToString); end; Parece pr√°tico, n√©? E √© mesmo‚Ä¶ at√© o momento em que o c√≥digo come√ßa a crescer.\nA√≠ voc√™ vai ca√ßar onde est√° a vari√°vel, e descobre que algu√©m teve a brilhante ideia de declarar um var no meio de um if, outro dentro de um try, e outro l√° no fim do begin.\nPronto, virou merda.\nOs pr√≥s (pra n√£o dizer que eu s√≥ reclamo) O escopo fica mais curto: terminou o bloco, a vari√°vel morre. D√° pra declarar no ponto de uso, beleza. O compilador infere o tipo, ent√£o o c√≥digo fica menor. Evita vari√°veis zumbis que seguem vivas sem necessidade. Ok, tem sua utilidade. Mas a turma come√ßou a achar que isso √© desculpa pra jogar var em qualquer canto do c√≥digo. Os contras (e aqui come√ßa a bronca) Coice do Bruto: Fora do for, vira bagun√ßa generalizada.\nVoc√™ abre um m√©todo e tem var em cada esquina.\nO padr√£o do Delphi sempre foi simples: quer saber as vari√°veis? sobe l√° pro topo, antes do begin.\nAgora tem que sair ca√ßando var no meio do inferno. √Äs vezes nem tipo tem: var x := AlgumaFuncao(); ‚Äî a√≠ voc√™ precisa abrir a fun√ß√£o pra saber o que √© x. Manuten√ß√£o? Virou ca√ßa ao tesouro. C√≥digo grande com inline √© tipo novela ruim: parece que vai melhorar, mas s√≥ piora. Resumo: quem quer economizar tr√™s teclas acaba gastando meia hora pra entender o que o pr√≥prio c√≥digo faz.\nOpini√£o do Bruto Vari√°vel inline s√≥ faz sentido em dois lugares:\nDentro de um for, tipo for var i := 0 to 10 do. Em blocos pequenos, de prefer√™ncia com menos de meia tela. Fora disso, √© firula.\nQuer declarar no meio do m√©todo? Faz um favor pra humanidade e vai vender pamonha.\nQuem for dar manuten√ß√£o vai te xingar em tr√™s l√≠nguas diferentes, e com raz√£o.\nCoice do Bruto: No meu c√≥digo, vari√°vel √© tudo antes do begin.\nSe voc√™ precisar achar uma, vai l√° e t√° tudo ali, arrumadinho.\nIsso √© padr√£o, √© clareza, √© paz de esp√≠rito. Exemplo bom (aceit√°vel) for var Item in Lista do begin var Dobrado := Item * 2; ShowMessage(Dobrado.ToString); end; Curto, direto, limpo. Morreu dentro do loop, n√£o incomoda ningu√©m.\nExemplo ruim (zona total) procedure Calcula; begin var Total := 0; if Condicao then begin var Aux := SomaFuncao(); Total := Total + Aux; end; var Outro := OutraFuncao(); ShowMessage(Total.ToString + Outro.ToString); end; Onde foi declarada ‚ÄúOutro‚Äù? Qual o tipo dela? O que ela come?\nPra descobrir, s√≥ debugando.\nE o coitado que abrir isso daqui seis meses vai querer pular da janela.\nExemplo da desgra√ßa suprema (mesmo nome, tipos diferentes) procedure Teste; begin var Valor: Integer := 10; ShowMessage(\u0026#39;Valor inteiro: \u0026#39; + Valor.ToString); begin var Valor: String := \u0026#39;dez\u0026#39;; ShowMessage(\u0026#39;Valor string: \u0026#39; + Valor); end; ShowMessage(\u0026#39;Valor ainda √© inteiro: \u0026#39; + Valor.ToString); end; Olha que maravilha: duas vari√°veis com o mesmo nome, tipos diferentes, vivas em blocos diferentes.\nCompila feliz, mas quem ler isso vai pensar que o compilador enlouqueceu.\nVoc√™ acha que √© um Integer, mas dentro de um bloco virou String.\nDepois volta a ser Integer.\nIsso n√£o √© clareza ‚Äî isso √© transtorno de identidade de vari√°vel.\nConclus√£o Coice do Bruto: Vari√°veis inline √© igual makita na m√£o de crian√ßa: pode at√© funcionar, mas voc√™ sabe que vai dar merda e alguem vai sair chorando (e quem sabe com um dedo a menos).\nUse no for, use em bloco pequeno, mas n√£o espalha var pelo c√≥digo que nem confete no carnaval.\nO padr√£o do Delphi √© simples, bonito e testado h√° d√©cadas:\nvar tudo antes do begin.\nFoge disso e o c√≥digo vira um bingo de escopo.\nE se eu abrir seu c√≥digo e encontrar vari√°vel inline espalhada, j√° aviso:\neu vou arrancar tudo e botar o var l√° em cima, onde sempre deveria estar.\nNa marra, se for preciso.\n","permalink":"http://localhost:1313/pt/posts/variaveis-inline-no-delphi/","summary":"\u003cp\u003eL√° por 2018, no \u003cstrong\u003eDelphi 10.3 Rio\u003c/strong\u003e, os engenheiros da Embarcadero resolveram ‚Äúmodernizar‚Äù o neg√≥cio e inventaram as \u003cstrong\u003evari√°veis inline\u003c/strong\u003e.\u003cbr\u003e\nA ideia parece genial: declarar a vari√°vel ali, no exato ponto onde vai usar.\u003cbr\u003e\nNo papel √© bonito. Na pr√°tica, √© tipo botar farol de LED num fusca ‚Äî chama aten√ß√£o, mas n√£o resolve o problema.\u003c/p\u003e\n\u003cp\u003eNeste post, eu te explico o que s√£o essas benditas vari√°veis inline, quando elas at√© fazem sentido, e por que, na minha opini√£o, \u003cstrong\u003equalquer coisa fora de um \u003ccode\u003efor\u003c/code\u003e √© receita de bagun√ßa.\u003c/strong\u003e\u003c/p\u003e","title":"Vari√°veis inline ‚Äì para√≠so ou zona?"},{"content":" WITH √© coisa de programador pregui√ßoso Coice do Bruto: ‚ö†Ô∏è Aviso de utilidade p√∫blica:\nEste texto √© opinativo, mal humorado e cheio de verdade.\nSe voc√™ ama o with e acha que ele √© lindo, j√° pode apertar Ctrl+W e fechar essa aba.\nEu n√£o vou dormir menos, n√£o vou comer menos e n√£o vou te mandar flores.\nAgora, se voc√™ quer entender de verdade por que esse treco √© uma desgra√ßa no Delphi ‚Äî senta a√≠ e presta aten√ß√£o.\nOu ent√£o, veja esse artigo em v√≠deo O que √© esse tal de with e por que o povo usa O with √© aquele ‚Äúatalho m√°gico‚Äù que promete te poupar meia d√∫zia de teclas.\nO sujeito olha praquilo e pensa:\n‚ÄúNossa, que lindo! N√£o preciso digitar Memo1.Lines toda hora!‚Äù\nPois √©‚Ä¶ e depois n√£o entende por que o c√≥digo dele parece uma merda.\nO with serve pra:\n‚ÄúEncurtar‚Äù chamadas (tipo Memo1.Lines.Add). Preencher cole√ß√µes (tipo ACBrNFe1.NotasFiscais.Add). E serve tamb√©m pra bagun√ßar seu c√≥digo, confundir o depurador e te fazer parecer um pregui√ßoso.\nBonito, n√©?\nProblema #1 ‚Äî O with fode a leitura do seu c√≥digo Sabe aquele c√≥digo bonito que voc√™ l√™ e entende de primeira?\nPois √©, o with pega esse c√≥digo, limpa a bunda com ele e joga no lixo.\nExemplo cl√°ssico de pregui√ßa: with Memo1.Lines do begin Clear; Add(\u0026#39;Cap√≠tulo 1: ...\u0026#39;); Add(\u0026#39;Par√°grafo 2: ...\u0026#39;); Add(\u0026#39;Par√°grafo 3: ...\u0026#39;); end; O sujeito que escreveu isso acha que economizou tempo.\nEconomizou nada, s√≥ fodeu quem vai dar manuten√ß√£o.\nCoice do Bruto: Aqui cada linha grita quem √© o dono da a√ß√£o.\nN√£o tem charada, n√£o tem adivinha√ß√£o.\nO c√≥digo √© honesto ‚Äî coisa rara hoje em dia. Memo1.Lines.Clear; Memo1.Lines.Add(\u0026#39;Cap√≠tulo 1: ...\u0026#39;); Memo1.Lines.Add(\u0026#39;Par√°grafo 2: ...\u0026#39;); Memo1.Lines.Add(\u0026#39;Par√°grafo 3: ...\u0026#39;); Problema #2 ‚Äî Debug com with √© a mesma coisa que tentar achar agulha num palheiro\u0026hellip; s√≥ que o palheiro t√° pegando fogo Quer depurar um trecho que usa with?\nBoa sorte, babaca. O depurador olha pro seu c√≥digo e pensa:\n‚ÄúAmigo, eu n√£o fa√ßo ideia de quem √© esse objeto a√≠.‚Äù\nOlha essa desgra√ßa: with ACBrNFe1.NotasFiscais.Add.NFe do begin ide.cNF := \u0026#39;12345678\u0026#39;; end; Na hora de inspecionar ide.cNF, o compilador olha pra voc√™ e diz:\n‚ÄúN√£o sei quem √© ide, e sinceramente, tamb√©m n√£o quero saber.‚Äù\nA√≠ o cara tem que reconstruir toda a cadeia s√≥ pra ver um valorzinho.\nTudo isso porque quis ‚Äúdigitar menos‚Äù.\nParab√©ns, guerreiro do Ctrl+C Ctrl+V.\nProblema #3 ‚Äî Voc√™ nem sabe mais o que est√° alterando No with, voc√™ acha que est√° mexendo em um objeto, mas na verdade est√° atacando outro completamente diferente.\n√â o inferno em forma de sintaxe.\nO caos em pessoa: with Nota do begin with Det.Add do begin with Imposto do begin with ICMS do begin // Aqui ningu√©m sabe mais quem √© quem nesse caralho end; end; end; end; Quem l√™ um c√≥digo desses merece um aumento‚Ä¶ ou uma interna√ß√£o.\nCoice do Bruto: Aqui cada linha sabe quem √© o dono da bronca.\nE se der pau, o depurador sabe tamb√©m. var Nota: TNFe; Det: TDetCollectionItem; begin Nota := ACBrNFe1.NotasFiscais.Add.NFe; Det := Nota.Det.Add; Det.Imposto.ICMS.CST := cst00; Det.Imposto.ICMS.orig := oeNacional; end; Como largar o v√≠cio do with (passo a passo de desintoxica√ß√£o) Descubra o tipo de retorno (Ctrl+Clique, pregui√ßoso).\nExemplo: NotasFiscais.Add.NFe : TNFe. Crie uma vari√°vel decente: var Nota: TNFe; Nota := ACBrNFe1.NotasFiscais.Add.NFe; Fez um .Add? Guarda o item: var Det: TDetCollectionItem; Det := Nota.Det.Add; D√™ nomes de gente pras vari√°veis.\nNada de a, b, obj, aux. Nomeie direito. Quebre o c√≥digo. C√≥digo bom √© aquele que at√© o estagi√°rio de marketing entende. Exemplo completo (sem pregui√ßa) uses ACBrNFe, ACBrNFeNotasFiscais; procedure TForm1.GerarNFeClara; var Nota: TNFe; Det: TDetCollectionItem; begin Nota := ACBrNFe1.NotasFiscais.Add.NFe; Nota.Ide.cNF := \u0026#39;12345678\u0026#39;; Nota.Ide.nNF := 2; Nota.Ide.tpAmb := taHomologacao; Nota.Ide.finNFe := fnNormal; Det := Nota.Det.Add; Det.nItem := 1; Det.Prod.cProd := \u0026#39;ABC123\u0026#39;; Det.Prod.xProd := \u0026#39;Produto Exemplo\u0026#39;; Det.Prod.qCom := 1.0000; Det.Prod.vUnCom := 100.00; Det.Imposto.ICMS.CST := cst00; Det.Imposto.ICMS.orig := oeNacional; end; Coice do Bruto: D√° mais trabalho? D√°.\nMas pelo menos voc√™ entende o que escreveu ‚Äî e n√£o parece que um estagi√°rio b√™bado codou isso. Checklist do Bruto para banir o with Declare vari√°veis decentes. Quebre cadeias longas. Nomeie as coisas direito. Fa√ßa o debug funcionar sem reza brava. E se algu√©m usar with no seu projeto\u0026hellip; refatora sem d√≥ e demita o respons√°vel. ‚ÄúMas Bruto, eu digito menos com with\u0026hellip;‚Äù E eu digito menos ainda se eu deletar seu c√≥digo inteiro.\nDigitar menos n√£o √© meta de programador.\nEntender o que escreveu √©.\nConclus√£o O with √© a muleta dos pregui√ßosos.\n√â o ‚Äújeitinho brasileiro‚Äù aplicado √† programa√ß√£o.\nQuer ser bom? Escreve direito. Quer ser r√°pido? Usa snippet.\nCoice do Bruto: Mas se continuar defendendo with, n√£o me chama pra dar manuten√ß√£o no seu c√≥digo, porque eu vou arrancar esse neg√≥cio de l√° nem que seja na marra.\nSe voc√™ √© do time with, √≥timo ‚Äî s√≥ n√£o me chame pra manuten√ß√£o. Se me chamar, eu vou l√° e arranco esse v√≠cio do seu c√≥digo sem d√≥. E se achou tudo isso uma besteira\u0026hellip;\nT√° bom tamb√©m.\nEu continuo dormindo bem e o with continua sendo uma bosta. üòé\n","permalink":"http://localhost:1313/pt/posts/pare-de-usar-with-no-delphi/","summary":"Um manifesto do Bruto do Delphi: por que o \u003ccode\u003ewith\u003c/code\u003e √© o capeta disfar√ßado de atalho.","title":"Pare de Usar With no Delphi"},{"content":"Rodando Delphi no WSL2 ‚Äî quando o Linux entra na sua m√°quina e o Windows s√≥ assiste L√° por 2025 eu resolvi encarar a ideia maluca de rodar Delphi no Linux sem sair do Windows.\n√â isso mesmo: um tal de WSL2 ‚Äî o ‚Äúsubsystem for linux‚Äù ‚Äî que deixa o pinguim morar dentro do Windows e ainda comer na mesma mesa. E pra minha surpresa, funciona. Ent√£o se prepara, porque eu vou te mostrar como eu fiz isso funcionar com o Ubuntu 22.04 (era o est√°vel quando escrevi este post). Se quando voc√™ estiver lendo isso o n√∫mero for outro (24.04, 26.04‚Ä¶), troca o nome na instala√ß√£o e segue o baile. 1. O que √© o tal do WSL O WSL √© basicamente um Linux domesticado, rodando dentro do Windows. N√£o √© VM, n√£o √© Docker ‚Äî √© r√°pido e pr√°tico. Voc√™ roda um comando e pronto: tem um Ubuntu te olhando feio.\n2. Instalando o Ubuntu (ou o que tiver no lugar dele) Abra o Prompt de Comando como administrador e rode:\n1 wsl --list --online Vai aparecer uma lista de distribui√ß√µes. Na √©poca eu usei Ubuntu 22.04, mas se j√° saiu 24.04, use ele. O nome muda, o processo √© o mesmo.\nPara instalar:\n1 wsl --install Ubuntu-22.04 O Windows baixa, instala e pede usu√°rio e senha. Escolha algo que voc√™ lembre, porque o Linux vai cobrar.\n3. Atualizando o sistema e instalando o que presta No Ubuntu, rode o b√°sico para atualizar os pacotes:\n1 sudo apt update \u0026amp;\u0026amp; sudo apt upgrade \u0026amp;\u0026amp; sudo apt dist-upgrade Depois instale as ferramentas de desenvolvimento que o Delphi precisa:\n1 sudo apt install joe wget p7zip-full curl openssh-server build-essential zlib1g-dev libcurl4-gnutls-dev libncurses5 zlib1g-dev libgtk-3-dev 4. Instalando o PAServer no WSL Copie o PAServer do Windows para dentro do WSL. No Delphi 12, o arquivo fica em algo como:\n1 C:\\\\Program Files (x86)\\\\Embarcadero\\\\Studio\\\\23.0\\\\PAServer\\\\LinuxPAServer23.0.tar.gz No Ubuntu, execute:\n1 2 cp /mnt/c/Program\\ Files\\ \\(x86\\)/Embarcadero/Studio/23.0/PAServer/LinuxPAServer23.0.tar.gz ~/ tar -xvf ./LinuxPAServer23.0.tar.gz Inicie o servidor:\n1 ./PAServer-23.0/paserver Ele pedir√° uma senha ‚Äî defina uma senha de verdade. Aqui n√£o tem ‚Äòdeixar tudo aberto‚Äô (laele). Seguran√ßa √© coisa s√©ria.\nDigite i e pressione Enter para ver o IP do PAServer. Anote.\n5. Configurando o Delphi para conversar com o WSL No Delphi do Windows, instale o FMXLinux via GetIt (se necess√°rio). Depois v√° em:\nTools \u0026gt; Options \u0026gt; Deployment \u0026gt; Connection Profile Manager Clique em Add e crie um perfil para Linux 64-bit. Informe o IP do PAServer, usu√°rio e senha definidos no Ubuntu, e Test Connection. 6. Adicionando o SDK Ainda no Delphi:\nTools \u0026gt; Options \u0026gt; Deployment \u0026gt; SDK Manager Clique em Add, escolha Linux 64-bit e selecione o perfil criado. O Delphi vai copiar um monte de arquivo para o WSL. Demora ‚Äî quando o bot√£o Cancel virar Close, terminou. 7. Compilando direto para Linux Crie um projeto Multi-Device Application e, no Project Manager, selecione Linux 64-bit. Se n√£o aparecer, adicione em Target Platforms.\nPressione F9. Se tudo estiver certo, o app sobe dentro do WSL.\n8. Conclus√£o Coice do Bruto: Pronto. Delphi no Windows, compilando para Linux no WSL.\n√â bonito? N√£o. √â pr√°tico? Depende. √â curioso? Bastante.\nSe der erro: confira IP, PAServer, SDK e firewall. Persistindo, reinicie ‚Äî √†s vezes o Windows s√≥ quer aten√ß√£o.\n‚ÄúSe t√° rodando, n√£o mexe. Se parou, o Windows estragou.‚Äù ‚Äî Bruto do Delphi\nCr√©dito: Este artigo foi escrito durante o Vivid Day da GDK,\rum dia em que os desenvolvedores recebem tempo dedicado para estudar, pesquisar\re produzir conte√∫do t√©cnico. Agrade√ßo √† empresa por apoiar iniciativas que fortalecem\ra comunidade t√©cnica.\r","permalink":"http://localhost:1313/pt/posts/wsl-delphi/","summary":"Rodando Delphi no WSL2 ‚Äî quando o Linux entra na sua m√°quina e o Windows s√≥ assiste.","title":"Rodando Delphi no Linux"},{"content":"L√° por 2018, no Delphi 10.3 Rio, os engenheiros da Embarcadero resolveram ‚Äúmodernizar‚Äù o neg√≥cio e inventaram as vari√°veis inline.\nA ideia parece genial: declarar a vari√°vel ali, no exato ponto onde vai usar.\nNo papel √© bonito. Na pr√°tica, √© tipo botar farol de LED num fusca ‚Äî chama aten√ß√£o, mas n√£o resolve o problema.\nNeste post, eu te explico o que s√£o essas benditas vari√°veis inline, quando elas at√© fazem sentido, e por que, na minha opini√£o, qualquer coisa fora de um for √© receita de bagun√ßa.\nO que √© vari√°vel inline Desde os prim√≥rdios do Pascal, l√° da √©poca que a gente ainda usava disquete e o compilador cabia num disquete e meio, toda vari√°vel local era declarada no topo do m√©todo, antes do begin.\nEsse era o padr√£o: bonito, previs√≠vel e l√≥gico.\nA√≠ veio o Delphi 10.3 Rio e resolveu permitir isso aqui:\nprocedure Test; begin var i: Integer := 10; ShowMessage(i.ToString); end; Parece pr√°tico, n√©? E √© mesmo‚Ä¶ at√© o momento em que o c√≥digo come√ßa a crescer.\nA√≠ voc√™ vai ca√ßar onde est√° a vari√°vel, e descobre que algu√©m teve a brilhante ideia de declarar um var no meio de um if, outro dentro de um try, e outro l√° no fim do begin.\nPronto, virou merda.\nOs pr√≥s (pra n√£o dizer que eu s√≥ reclamo) O escopo fica mais curto: terminou o bloco, a vari√°vel morre. D√° pra declarar no ponto de uso, beleza. O compilador infere o tipo, ent√£o o c√≥digo fica menor. Evita vari√°veis zumbis que seguem vivas sem necessidade. Ok, tem sua utilidade. Mas a turma come√ßou a achar que isso √© desculpa pra jogar var em qualquer canto do c√≥digo. Os contras (e aqui come√ßa a bronca) Coice do Bruto: Fora do for, vira bagun√ßa generalizada.\nVoc√™ abre um m√©todo e tem var em cada esquina.\nO padr√£o do Delphi sempre foi simples: quer saber as vari√°veis? sobe l√° pro topo, antes do begin.\nAgora tem que sair ca√ßando var no meio do inferno. √Äs vezes nem tipo tem: var x := AlgumaFuncao(); ‚Äî a√≠ voc√™ precisa abrir a fun√ß√£o pra saber o que √© x. Manuten√ß√£o? Virou ca√ßa ao tesouro. C√≥digo grande com inline √© tipo novela ruim: parece que vai melhorar, mas s√≥ piora. Resumo: quem quer economizar tr√™s teclas acaba gastando meia hora pra entender o que o pr√≥prio c√≥digo faz.\nOpini√£o do Bruto Vari√°vel inline s√≥ faz sentido em dois lugares:\nDentro de um for, tipo for var i := 0 to 10 do. Em blocos pequenos, de prefer√™ncia com menos de meia tela. Fora disso, √© firula.\nQuer declarar no meio do m√©todo? Faz um favor pra humanidade e vai vender pamonha.\nQuem for dar manuten√ß√£o vai te xingar em tr√™s l√≠nguas diferentes, e com raz√£o.\nCoice do Bruto: No meu c√≥digo, vari√°vel √© tudo antes do begin.\nSe voc√™ precisar achar uma, vai l√° e t√° tudo ali, arrumadinho.\nIsso √© padr√£o, √© clareza, √© paz de esp√≠rito. Exemplo bom (aceit√°vel) for var Item in Lista do begin var Dobrado := Item * 2; ShowMessage(Dobrado.ToString); end; Curto, direto, limpo. Morreu dentro do loop, n√£o incomoda ningu√©m.\nExemplo ruim (zona total) procedure Calcula; begin var Total := 0; if Condicao then begin var Aux := SomaFuncao(); Total := Total + Aux; end; var Outro := OutraFuncao(); ShowMessage(Total.ToString + Outro.ToString); end; Onde foi declarada ‚ÄúOutro‚Äù? Qual o tipo dela? O que ela come?\nPra descobrir, s√≥ debugando.\nE o coitado que abrir isso daqui seis meses vai querer pular da janela.\nExemplo da desgra√ßa suprema (mesmo nome, tipos diferentes) procedure Teste; begin var Valor: Integer := 10; ShowMessage(\u0026#39;Valor inteiro: \u0026#39; + Valor.ToString); begin var Valor: String := \u0026#39;dez\u0026#39;; ShowMessage(\u0026#39;Valor string: \u0026#39; + Valor); end; ShowMessage(\u0026#39;Valor ainda √© inteiro: \u0026#39; + Valor.ToString); end; Olha que maravilha: duas vari√°veis com o mesmo nome, tipos diferentes, vivas em blocos diferentes.\nCompila feliz, mas quem ler isso vai pensar que o compilador enlouqueceu.\nVoc√™ acha que √© um Integer, mas dentro de um bloco virou String.\nDepois volta a ser Integer.\nIsso n√£o √© clareza ‚Äî isso √© transtorno de identidade de vari√°vel.\nConclus√£o Coice do Bruto: Vari√°veis inline √© igual makita na m√£o de crian√ßa: pode at√© funcionar, mas voc√™ sabe que vai dar merda e alguem vai sair chorando (e quem sabe com um dedo a menos).\nUse no for, use em bloco pequeno, mas n√£o espalha var pelo c√≥digo que nem confete no carnaval.\nO padr√£o do Delphi √© simples, bonito e testado h√° d√©cadas:\nvar tudo antes do begin.\nFoge disso e o c√≥digo vira um bingo de escopo.\nE se eu abrir seu c√≥digo e encontrar vari√°vel inline espalhada, j√° aviso:\neu vou arrancar tudo e botar o var l√° em cima, onde sempre deveria estar.\nNa marra, se for preciso.\n","permalink":"http://localhost:1313/pt/posts/variaveis-inline-no-delphi/","summary":"\u003cp\u003eL√° por 2018, no \u003cstrong\u003eDelphi 10.3 Rio\u003c/strong\u003e, os engenheiros da Embarcadero resolveram ‚Äúmodernizar‚Äù o neg√≥cio e inventaram as \u003cstrong\u003evari√°veis inline\u003c/strong\u003e.\u003cbr\u003e\nA ideia parece genial: declarar a vari√°vel ali, no exato ponto onde vai usar.\u003cbr\u003e\nNo papel √© bonito. Na pr√°tica, √© tipo botar farol de LED num fusca ‚Äî chama aten√ß√£o, mas n√£o resolve o problema.\u003c/p\u003e\n\u003cp\u003eNeste post, eu te explico o que s√£o essas benditas vari√°veis inline, quando elas at√© fazem sentido, e por que, na minha opini√£o, \u003cstrong\u003equalquer coisa fora de um \u003ccode\u003efor\u003c/code\u003e √© receita de bagun√ßa.\u003c/strong\u003e\u003c/p\u003e","title":"Vari√°veis inline ‚Äì para√≠so ou zona?"},{"content":" WITH √© coisa de programador pregui√ßoso Coice do Bruto: ‚ö†Ô∏è Aviso de utilidade p√∫blica:\nEste texto √© opinativo, mal humorado e cheio de verdade.\nSe voc√™ ama o with e acha que ele √© lindo, j√° pode apertar Ctrl+W e fechar essa aba.\nEu n√£o vou dormir menos, n√£o vou comer menos e n√£o vou te mandar flores.\nAgora, se voc√™ quer entender de verdade por que esse treco √© uma desgra√ßa no Delphi ‚Äî senta a√≠ e presta aten√ß√£o.\nOu ent√£o, veja esse artigo em v√≠deo O que √© esse tal de with e por que o povo usa O with √© aquele ‚Äúatalho m√°gico‚Äù que promete te poupar meia d√∫zia de teclas.\nO sujeito olha praquilo e pensa:\n‚ÄúNossa, que lindo! N√£o preciso digitar Memo1.Lines toda hora!‚Äù\nPois √©‚Ä¶ e depois n√£o entende por que o c√≥digo dele parece uma merda.\nO with serve pra:\n‚ÄúEncurtar‚Äù chamadas (tipo Memo1.Lines.Add). Preencher cole√ß√µes (tipo ACBrNFe1.NotasFiscais.Add). E serve tamb√©m pra bagun√ßar seu c√≥digo, confundir o depurador e te fazer parecer um pregui√ßoso.\nBonito, n√©?\nProblema #1 ‚Äî O with fode a leitura do seu c√≥digo Sabe aquele c√≥digo bonito que voc√™ l√™ e entende de primeira?\nPois √©, o with pega esse c√≥digo, limpa a bunda com ele e joga no lixo.\nExemplo cl√°ssico de pregui√ßa: with Memo1.Lines do begin Clear; Add(\u0026#39;Cap√≠tulo 1: ...\u0026#39;); Add(\u0026#39;Par√°grafo 2: ...\u0026#39;); Add(\u0026#39;Par√°grafo 3: ...\u0026#39;); end; O sujeito que escreveu isso acha que economizou tempo.\nEconomizou nada, s√≥ fodeu quem vai dar manuten√ß√£o.\nCoice do Bruto: Aqui cada linha grita quem √© o dono da a√ß√£o.\nN√£o tem charada, n√£o tem adivinha√ß√£o.\nO c√≥digo √© honesto ‚Äî coisa rara hoje em dia. Memo1.Lines.Clear; Memo1.Lines.Add(\u0026#39;Cap√≠tulo 1: ...\u0026#39;); Memo1.Lines.Add(\u0026#39;Par√°grafo 2: ...\u0026#39;); Memo1.Lines.Add(\u0026#39;Par√°grafo 3: ...\u0026#39;); Problema #2 ‚Äî Debug com with √© a mesma coisa que tentar achar agulha num palheiro\u0026hellip; s√≥ que o palheiro t√° pegando fogo Quer depurar um trecho que usa with?\nBoa sorte, babaca. O depurador olha pro seu c√≥digo e pensa:\n‚ÄúAmigo, eu n√£o fa√ßo ideia de quem √© esse objeto a√≠.‚Äù\nOlha essa desgra√ßa: with ACBrNFe1.NotasFiscais.Add.NFe do begin ide.cNF := \u0026#39;12345678\u0026#39;; end; Na hora de inspecionar ide.cNF, o compilador olha pra voc√™ e diz:\n‚ÄúN√£o sei quem √© ide, e sinceramente, tamb√©m n√£o quero saber.‚Äù\nA√≠ o cara tem que reconstruir toda a cadeia s√≥ pra ver um valorzinho.\nTudo isso porque quis ‚Äúdigitar menos‚Äù.\nParab√©ns, guerreiro do Ctrl+C Ctrl+V.\nProblema #3 ‚Äî Voc√™ nem sabe mais o que est√° alterando No with, voc√™ acha que est√° mexendo em um objeto, mas na verdade est√° atacando outro completamente diferente.\n√â o inferno em forma de sintaxe.\nO caos em pessoa: with Nota do begin with Det.Add do begin with Imposto do begin with ICMS do begin // Aqui ningu√©m sabe mais quem √© quem nesse caralho end; end; end; end; Quem l√™ um c√≥digo desses merece um aumento‚Ä¶ ou uma interna√ß√£o.\nCoice do Bruto: Aqui cada linha sabe quem √© o dono da bronca.\nE se der pau, o depurador sabe tamb√©m. var Nota: TNFe; Det: TDetCollectionItem; begin Nota := ACBrNFe1.NotasFiscais.Add.NFe; Det := Nota.Det.Add; Det.Imposto.ICMS.CST := cst00; Det.Imposto.ICMS.orig := oeNacional; end; Como largar o v√≠cio do with (passo a passo de desintoxica√ß√£o) Descubra o tipo de retorno (Ctrl+Clique, pregui√ßoso).\nExemplo: NotasFiscais.Add.NFe : TNFe. Crie uma vari√°vel decente: var Nota: TNFe; Nota := ACBrNFe1.NotasFiscais.Add.NFe; Fez um .Add? Guarda o item: var Det: TDetCollectionItem; Det := Nota.Det.Add; D√™ nomes de gente pras vari√°veis.\nNada de a, b, obj, aux. Nomeie direito. Quebre o c√≥digo. C√≥digo bom √© aquele que at√© o estagi√°rio de marketing entende. Exemplo completo (sem pregui√ßa) uses ACBrNFe, ACBrNFeNotasFiscais; procedure TForm1.GerarNFeClara; var Nota: TNFe; Det: TDetCollectionItem; begin Nota := ACBrNFe1.NotasFiscais.Add.NFe; Nota.Ide.cNF := \u0026#39;12345678\u0026#39;; Nota.Ide.nNF := 2; Nota.Ide.tpAmb := taHomologacao; Nota.Ide.finNFe := fnNormal; Det := Nota.Det.Add; Det.nItem := 1; Det.Prod.cProd := \u0026#39;ABC123\u0026#39;; Det.Prod.xProd := \u0026#39;Produto Exemplo\u0026#39;; Det.Prod.qCom := 1.0000; Det.Prod.vUnCom := 100.00; Det.Imposto.ICMS.CST := cst00; Det.Imposto.ICMS.orig := oeNacional; end; Coice do Bruto: D√° mais trabalho? D√°.\nMas pelo menos voc√™ entende o que escreveu ‚Äî e n√£o parece que um estagi√°rio b√™bado codou isso. Checklist do Bruto para banir o with Declare vari√°veis decentes. Quebre cadeias longas. Nomeie as coisas direito. Fa√ßa o debug funcionar sem reza brava. E se algu√©m usar with no seu projeto\u0026hellip; refatora sem d√≥ e demita o respons√°vel. ‚ÄúMas Bruto, eu digito menos com with\u0026hellip;‚Äù E eu digito menos ainda se eu deletar seu c√≥digo inteiro.\nDigitar menos n√£o √© meta de programador.\nEntender o que escreveu √©.\nConclus√£o O with √© a muleta dos pregui√ßosos.\n√â o ‚Äújeitinho brasileiro‚Äù aplicado √† programa√ß√£o.\nQuer ser bom? Escreve direito. Quer ser r√°pido? Usa snippet.\nCoice do Bruto: Mas se continuar defendendo with, n√£o me chama pra dar manuten√ß√£o no seu c√≥digo, porque eu vou arrancar esse neg√≥cio de l√° nem que seja na marra.\nSe voc√™ √© do time with, √≥timo ‚Äî s√≥ n√£o me chame pra manuten√ß√£o. Se me chamar, eu vou l√° e arranco esse v√≠cio do seu c√≥digo sem d√≥. E se achou tudo isso uma besteira\u0026hellip;\nT√° bom tamb√©m.\nEu continuo dormindo bem e o with continua sendo uma bosta. üòé\n","permalink":"http://localhost:1313/pt/posts/pare-de-usar-with-no-delphi/","summary":"Um manifesto do Bruto do Delphi: por que o \u003ccode\u003ewith\u003c/code\u003e √© o capeta disfar√ßado de atalho.","title":"Pare de Usar With no Delphi"}]